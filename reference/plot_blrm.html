<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot a fitted model — plot_blrm • OncoBayes2</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot a fitted model — plot_blrm"><meta name="description" content="Warning: these methods are at an experimental stage of development, and
may change with future releases.
Plotting methods for blrmfit and blrm_trial objects."><meta property="og:description" content="Warning: these methods are at an experimental stage of development, and
may change with future releases.
Plotting methods for blrmfit and blrm_trial objects."><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">OncoBayes2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9-4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">Guiding Oncology Dose-Escalation Trials</a></li>
    <li><a class="dropdown-item" href="../articles/map_approach.html">Meta-Analytic-Predictive (MAP) approach for dose-toxicity modelling</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Novartis/OncoBayes2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot a fitted model</h1>
      <small class="dont-index">Source: <a href="https://github.com/Novartis/OncoBayes2/blob/main/R/plot_blrm.R" class="external-link"><code>R/plot_blrm.R</code></a></small>
      <div class="d-none name"><code>plot_blrm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><strong>Warning</strong>: these methods are at an experimental stage of development, and
may change with future releases.</p>
<p>Plotting methods for <code>blrmfit</code> and <code>blrm_trial</code> objects.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_toxicity_curve</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot_toxicity_intervals</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">plot_toxicity_intervals_stacked</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'blrmfit'</span></span>
<span><span class="fu">plot_toxicity_curve</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">newdata</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">group</span>,</span>
<span>  <span class="va">xlim</span>,</span>
<span>  <span class="va">ylim</span>,</span>
<span>  transform <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  prob <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  prob_outer <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  size <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  facet_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  hline_at <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.16</span>, <span class="fl">0.33</span><span class="op">)</span>,</span>
<span>  grid_length <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'blrm_trial'</span></span>
<span><span class="fu">plot_toxicity_curve</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">newdata</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">group</span>,</span>
<span>  <span class="va">xlim</span>,</span>
<span>  <span class="va">ylim</span>,</span>
<span>  transform <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  prob <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  prob_outer <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  size <span class="op">=</span> <span class="fl">0.75</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  facet_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">hline_at</span>,</span>
<span>  grid_length <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  ewoc_shading <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'blrmfit'</span></span>
<span><span class="fu">plot_toxicity_intervals</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">newdata</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">group</span>,</span>
<span>  interval_prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.16</span>, <span class="fl">0.33</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  interval_max_mass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">0.25</span><span class="op">)</span>,</span>
<span>  ewoc_colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"red"</span><span class="op">)</span>,</span>
<span>  facet_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'blrm_trial'</span></span>
<span><span class="fu">plot_toxicity_intervals</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">newdata</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">group</span>,</span>
<span>  <span class="va">interval_prob</span>,</span>
<span>  <span class="va">interval_max_mass</span>,</span>
<span>  ewoc_colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"red"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'blrmfit'</span></span>
<span><span class="fu">plot_toxicity_intervals_stacked</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">newdata</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">group</span>,</span>
<span>  <span class="va">xlim</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  predictive <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  transform <span class="op">=</span> <span class="op">!</span><span class="va">predictive</span>,</span>
<span>  <span class="va">interval_prob</span>,</span>
<span>  grid_length <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  facet_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'blrm_trial'</span></span>
<span><span class="fu">plot_toxicity_intervals_stacked</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  <span class="va">newdata</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">group</span>,</span>
<span>  <span class="va">xlim</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  predictive <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  transform <span class="op">=</span> <span class="op">!</span><span class="va">predictive</span>,</span>
<span>  <span class="va">interval_prob</span>,</span>
<span>  grid_length <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  ewoc_shading <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  facet_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>fitted model object</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>currently unused</p></dd>


<dt id="arg-newdata">newdata<a class="anchor" aria-label="anchor" href="#arg-newdata"></a></dt>
<dd><p>optional data frame specifying for what to predict;
if missing, then the data of the input model <code>object</code> is
used. If <code>object</code> is a <code>blrmfit</code> object, <code>newdata</code> defaults to
the <code>data</code> argument. If <code>object</code> is a <code>blrm_trial</code>, it defaults
to <code>summary(object, "dose_info")</code>.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Character giving the parameter name to be mapped to the
x-axis.  This also supports 'tidy' parameter selection by
specifying <code>x = vars(...)</code>, where <code>...</code> is specified
the same way as in <code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">dplyr::select()</a></code>
and similar functions. Examples of using <code>x</code> in this way
can be found in the examples. For <code>blrm_trial</code> methods, it
defaults to the first entry in <code>summary(blrm_trial,
    "drug_info")$drug_name</code>.</p></dd>


<dt id="arg-group">group<a class="anchor" aria-label="anchor" href="#arg-group"></a></dt>
<dd><p>Grouping variable(s) whose levels will be mapped to
different facets of the plot. <code>group</code> can be a character
vector, tidy parameter(s) of the form <code>group = vars(...)</code>,
or a formula to be passed directly to
<code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">ggplot2::facet_wrap()</a></code>. For
<code>blrm_trial</code> methods, it defaults to <code>group_id</code>, plus
all entries of <code>summary(blrm_trial,
    "drug_info")$drug_name</code> except the first, which is mapped to
<code>x</code>.</p></dd>


<dt id="arg-xlim">xlim<a class="anchor" aria-label="anchor" href="#arg-xlim"></a></dt>
<dd><p>x-axis limits</p></dd>


<dt id="arg-ylim">ylim<a class="anchor" aria-label="anchor" href="#arg-ylim"></a></dt>
<dd><p>y-axis limits on the probability scale</p></dd>


<dt id="arg-transform">transform<a class="anchor" aria-label="anchor" href="#arg-transform"></a></dt>
<dd><p>logical (defaults to <code>FALSE</code>) indicating if
the linear predictor on the logit link scale is transformed
with <code>inv_logit</code> to the 0-1 response scale.</p></dd>


<dt id="arg-prob">prob<a class="anchor" aria-label="anchor" href="#arg-prob"></a></dt>
<dd><p>central probability mass to report for the inner ribbon, i.e.
the quantiles <code>0.5-prob/2</code> and <code>0.5+prob/2</code> are displayed.</p></dd>


<dt id="arg-prob-outer">prob_outer<a class="anchor" aria-label="anchor" href="#arg-prob-outer"></a></dt>
<dd><p>central probability mass to report for the outer ribbon, i.e.
the quantiles <code>0.5-prob/2</code> and <code>0.5+prob/2</code> are displayed.</p></dd>


<dt id="arg-alpha-size">alpha, size<a class="anchor" aria-label="anchor" href="#arg-alpha-size"></a></dt>
<dd><p>Arguments passed to geoms. For this plot, <code>alpha</code> is
passed to <code><a href="https://ggplot2.tidyverse.org/reference/geom_ribbon.html" class="external-link">ggplot2::geom_ribbon()</a></code>, and <code>size</code> is passed to
<code><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">ggplot2::geom_line()</a></code>.</p></dd>


<dt id="arg-facet-args">facet_args<a class="anchor" aria-label="anchor" href="#arg-facet-args"></a></dt>
<dd><p>A named list of arguments (other than <code>facets</code>) passed
to <code><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">ggplot2::facet_wrap()</a></code>.</p></dd>


<dt id="arg-hline-at">hline_at<a class="anchor" aria-label="anchor" href="#arg-hline-at"></a></dt>
<dd><p>Location(s) of horizontal guide lines (passed to
<code><a href="https://mc-stan.org/bayesplot/reference/bayesplot-helpers.html" class="external-link">bayesplot::hline_at()</a></code>).</p></dd>


<dt id="arg-grid-length">grid_length<a class="anchor" aria-label="anchor" href="#arg-grid-length"></a></dt>
<dd><p>Number of grid points within <code>xlim</code> for plotting.</p></dd>


<dt id="arg-ewoc-shading">ewoc_shading<a class="anchor" aria-label="anchor" href="#arg-ewoc-shading"></a></dt>
<dd><p>logical indicates if doses violating EWOC should be
shaded in gray. Applies only to <code>blrm_trial</code> methods. Defaults to <code>TRUE</code>.</p></dd>


<dt id="arg-interval-prob">interval_prob<a class="anchor" aria-label="anchor" href="#arg-interval-prob"></a></dt>
<dd><p>defines the interval probabilities reported in
the standard outputs. Defaults to <code>c(0, 0.16, 0.33, 1)</code>,
when <code>predictive = FALSE</code> and/or <code>transform = TRUE</code>, or to intervals
giving 0, 1, or 2+ DLTs when <code>predictive = TRUE</code> and <code>transform = FALSE</code>.
For <code>blrm_trial</code> methods, this is taken from
<code>summary(blrm_trial, "interval_prob")</code> by default.</p></dd>


<dt id="arg-interval-max-mass">interval_max_mass<a class="anchor" aria-label="anchor" href="#arg-interval-max-mass"></a></dt>
<dd><p>vector defining for each interval of
the <code>interval_prob</code> vector a maximal admissible
probability mass for a given dose level. Whenever the posterior
probability mass in a given interval exceeds the threshold,
then the Escalation With Overdose Control (EWOC) criterion is
considered to be not fulfilled. Dose levels not fulfilling
EWOC are ineligible for the next cohort of patients. The
default restricts the overdose probability to less than 0.25. For
<code>blrm_trial</code> methods, this is taken from
<code>summary(blrm_trial, "interval_max_mass")</code> by default.</p></dd>


<dt id="arg-ewoc-colors">ewoc_colors<a class="anchor" aria-label="anchor" href="#arg-ewoc-colors"></a></dt>
<dd><p>Fill colors used for bars indicating EWOC OK or not.
Vector of two characters, each of which must correspond to
<code><a href="https://mc-stan.org/bayesplot/reference/bayesplot-package.html" class="external-link">bayesplot::bayesplot-package()</a></code> color schemes
(see <code>?[bayesplot::color_scheme_get()][bayesplot::color_scheme_get]</code>)</p></dd>


<dt id="arg-predictive">predictive<a class="anchor" aria-label="anchor" href="#arg-predictive"></a></dt>
<dd><p>logical indicates if the posterior predictive is
being summarized. Defaults to <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A ggplot object that can be further
customized using the <code><a href="https://ggplot2.tidyverse.org/reference/ggplot2-package.html" class="external-link">ggplot2::ggplot2()</a></code> package.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><code>plot_toxicity_curve</code> plots continuous profiles of the dose-toxicity curve.</p>
<p><code>plot_toxicity_intervals</code> plots the posterior probability mass in
subintervals of \([0,1]\), at a discrete set of provisional doses.</p>
<p><code>plot_toxicity_intervals_stacked</code> is similar to
<code>plot_toxicity_intervals</code>, but over a continuous range of doses.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Setting up dummy sampling for fast execution of example</span></span></span>
<span class="r-in"><span><span class="co">## Please use 4 chains and 100x more warmup &amp; iter in practice</span></span></span>
<span class="r-in"><span><span class="va">.user_mc_options</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  OncoBayes2.MC.warmup <span class="op">=</span> <span class="fl">10</span>, OncoBayes2.MC.iter <span class="op">=</span> <span class="fl">20</span>, OncoBayes2.MC.chains <span class="op">=</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  OncoBayes2.MC.save_warmup <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="example_model.html">example_model</a></span><span class="op">(</span><span class="st">"combo2"</span>, silent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>The largest R-hat is NA, indicating chains have not mixed.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#r-hat</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#bulk-ess</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> Running the chains for more iterations may help. See</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> https://mc-stan.org/misc/warnings.html#tail-ess</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot the dose-toxicity curve</span></span></span>
<span class="r-in"><span><span class="fu">plot_toxicity_curve</span><span class="op">(</span><span class="va">blrmfit</span>,</span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="st">"drug_A"</span>,</span></span>
<span class="r-in"><span>  group <span class="op">=</span> <span class="op">~</span> <span class="va">group_id</span> <span class="op">*</span> <span class="va">drug_B</span>,</span></span>
<span class="r-in"><span>  newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dose_info_combo2</span>, <span class="va">group_id</span> <span class="op">==</span> <span class="st">"trial_AB"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  facet_args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ncol <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Please use `linewidth` instead.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">OncoBayes2</span> package.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span>   Please report the issue at <span style="color: #0000BB; font-style: italic;">&lt;https://github.com/Novartis/OncoBayes2/issues&gt;</span>.</span>
<span class="r-plt img"><img src="plot_blrm-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot posterior DLT-rate-interval probabilities at discrete dose levels</span></span></span>
<span class="r-in"><span><span class="fu">plot_toxicity_intervals</span><span class="op">(</span><span class="va">blrmfit</span>,</span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="st">"drug_A"</span>,</span></span>
<span class="r-in"><span>  group <span class="op">=</span> <span class="op">~</span> <span class="va">group_id</span> <span class="op">*</span> <span class="va">drug_B</span>,</span></span>
<span class="r-in"><span>  newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dose_info_combo2</span>, <span class="va">group_id</span> <span class="op">==</span> <span class="st">"trial_AB"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_blrm-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot posterior DLT-rate-interval probabilities over continuous dose</span></span></span>
<span class="r-in"><span><span class="fu">plot_toxicity_intervals_stacked</span><span class="op">(</span><span class="va">blrmfit</span>,</span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="st">"drug_A"</span>,</span></span>
<span class="r-in"><span>  group <span class="op">=</span> <span class="op">~</span> <span class="va">group_id</span> <span class="op">*</span> <span class="va">drug_B</span>,</span></span>
<span class="r-in"><span>  newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">dose_info_combo2</span>, <span class="va">group_id</span> <span class="op">==</span> <span class="st">"trial_AB"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_blrm-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot predictive distribution probabilities over continuous dose</span></span></span>
<span class="r-in"><span><span class="fu">plot_toxicity_intervals_stacked</span><span class="op">(</span><span class="va">blrmfit</span>,</span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="st">"drug_A"</span>,</span></span>
<span class="r-in"><span>  group <span class="op">=</span> <span class="op">~</span> <span class="va">group_id</span> <span class="op">*</span> <span class="va">drug_B</span>,</span></span>
<span class="r-in"><span>  predictive <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  interval_prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  newdata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/transform.html" class="external-link">transform</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      <span class="va">dose_info_combo2</span>,</span></span>
<span class="r-in"><span>      <span class="va">group_id</span> <span class="op">==</span> <span class="st">"trial_AB"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    num_patients <span class="op">=</span> <span class="fl">6</span>,</span></span>
<span class="r-in"><span>    num_toxicities <span class="op">=</span> <span class="fl">0</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_blrm-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co">## Recover user set sampling defaults</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span><span class="va">.user_mc_options</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Weber, Lukas A. Widmer, Andrew Bean.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

