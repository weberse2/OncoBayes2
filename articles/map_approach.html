<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Meta-Analytic-Predictive (MAP) approach for dose-toxicity modelling • OncoBayes2</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Meta-Analytic-Predictive (MAP) approach for dose-toxicity modelling">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">OncoBayes2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.9-4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/introduction.html">Guiding Oncology Dose-Escalation Trials</a></li>
    <li><a class="dropdown-item" href="../articles/map_approach.html">Meta-Analytic-Predictive (MAP) approach for dose-toxicity modelling</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Novartis/OncoBayes2/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Meta-Analytic-Predictive (MAP) approach for dose-toxicity modelling</h1>
                        <h4 data-toc-skip class="author">Andrew Bean,
Sebastian Weber, Lukas Widmer</h4>
            
            <h4 data-toc-skip class="date">2025-10-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/Novartis/OncoBayes2/blob/main/vignettes/map_approach.Rmd" class="external-link"><code>vignettes/map_approach.Rmd</code></a></small>
      <div class="d-none name"><code>map_approach.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>A common characteristic of modern applications of the Bayesian
Logistic Regression Model (BLRM) for model-based dose escalation is the
availability of relevant historical data on the study treatment(s). For
example, studies testing novel combination therapies may wish to
incorporate available dose-toxicity data on the individual agents from
single-agent dose escalation trials.</p>
<p>There are two broad categories for statistical approaches to
this:</p>
<ul>
<li>Meta-Analytic Combined (MAC) approaches use a hierarchical model to
jointly analyze both the historical data and data from the current
study. External data from concurrently running trials may also be
incorporated in such an approach. The <a href="introduction.html">introductory vignette</a> illustrates this
approach.</li>
<li>Meta-Analytic Predictive (MAP) approaches involve two stages. In the
first, an initial hierarchical model is estimated from the historical
data, and from this model one extracts a posterior prediction for the
trial-level parameters in a future trial. The posterior prediction is
then approximated in parametric form which is used as MAP prior in the
future trial.</li>
</ul>
<p>These two approaches are statistically equivalent to each other
(provided the parametric representation of the MAP prior is exact), but
differ in the “modelling workflow.” While the MAC approach is a
prospective approach enabling to include even concurrent data to borrow
from, the MAP approach is retrospective in that the historical data is
summarized once and usually taken as immutable and static. The MAP
approach has the advantage when designing prospectively a future study
that we can pre-specify (and hence document in a statistical analysis
plan) the information borrowed from the historical data and the model
used for the future study becomes structurally simpler, since there is
often no more a need for a hierarchical model structure at that
stage.</p>
<p>The recommended reference for more details on these approaches, how
they relate to each other, and how they are applied in the dose-toxicity
setting is explained in Neuenschwander et al (2016).</p>
<p>In this vignette, we illustrate the implementation of the MAP
approach, and describe its usage for safety monitoring in a realistic
application.</p>
<p>Initial R session setup:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://opensource.nibr.com/OncoBayes2/" class="external-link">OncoBayes2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://opensource.nibr.com/RBesT/" class="external-link">RBesT</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mc-stan.org/posterior/" class="external-link">posterior</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="application-background">Application background<a class="anchor" aria-label="anchor" href="#application-background"></a>
</h2>
<p>We consider a case study involving a Phase-I dose-escalation study of
a combination therapy of two compounds, drug A and drug B, in a
population of adult patients with solid-tumor cancers. The primary
objective of the study was to identify the Maximum Tolerated Dose (MTD)
or Recommended Phase-2 Dose (RP2D) of the combination.</p>
<div class="section level3">
<h3 id="historical-data">Historical data<a class="anchor" aria-label="anchor" href="#historical-data"></a>
</h3>
<p>In this application, each of the two compounds had previously been
tested in single-agent Phase-I dose escalation studies. MTDs had been
declared for each drug:</p>
<table class="table">
<thead><tr class="header">
<th align="left">Drug</th>
<th align="left">Declared MTD</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Drug A</td>
<td align="left">100mg</td>
</tr>
<tr class="even">
<td align="left">Drug B</td>
<td align="left">3mg</td>
</tr>
</tbody>
</table>
<p>These declarations had been made on the basis of the following
dose-toxicity data from the two single-agent studies.</p>
<table class="table">
<caption>Historical data from single-agent study of Drug A</caption>
<thead><tr class="header">
<th align="right">Drug A</th>
<th align="right">Evaluable patients</th>
<th align="right">DLTs</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">12.5</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">25.0</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">50.0</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">80.0</td>
<td align="right">9</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="right">100.0</td>
<td align="right">23</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="right">150.0</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
</tbody>
</table>
<table class="table">
<caption>Historical data from single-agent study of Drug B</caption>
<thead><tr class="header">
<th align="right">Drug B dose</th>
<th align="right">Evaluable patients</th>
<th align="right">DLTs</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">0.125</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">0.250</td>
<td align="right">1</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">0.500</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">1.000</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">2.000</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="right">2.500</td>
<td align="right">7</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="right">3.000</td>
<td align="right">12</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="right">4.000</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
</tbody>
</table>
<p>These data were understood to be highly relevant for informing prior
beliefs about the single-agent contributions to the combination toxicity
in the planned study. Therefore a MAP approach was taken to develop
priors for the respective parameters -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mi>A</mi></msub><annotation encoding="application/x-tex">\alpha_A</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>A</mi></msub><annotation encoding="application/x-tex">\beta_A</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>α</mi><mi>B</mi></msub><annotation encoding="application/x-tex">\alpha_B</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>B</mi></msub><annotation encoding="application/x-tex">\beta_B</annotation></semantics></math>
which are obtained by a meta-analysis of the historical data.</p>
</div>
</div>
<div class="section level2">
<h2 id="derivation-of-map-priors">Derivation of MAP priors<a class="anchor" aria-label="anchor" href="#derivation-of-map-priors"></a>
</h2>
<p>In the MAP approach, we begin with meta-analytic hierarchical
modelling of the historical data, accounting for the possibility of
between-trial heterogeneity. It is important to note that this is done
even for the case of a single historical study being available. The
information on the between-trial heterogeneity relies in this case on
the priors used for the heterogeneity. In practice log normal priors for
the heterogeneity parameters based on the following table have worked
well in many situations. The approach is to categorize the degree of
heterogeneity between trials in terms of anticipated differences in the
population and further factors which depend on a specific case:</p>
<table class="table">
<caption>Heterogeneity categorization for intercept
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>
and slope
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
</caption>
<thead><tr class="header">
<th align="left">Heterogeneity degree</th>
<th align="right"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>τ</mi><mi>α</mi></msub><annotation encoding="application/x-tex">\tau_\alpha</annotation></semantics></math></th>
<th align="right"><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>τ</mi><mi>β</mi></msub><annotation encoding="application/x-tex">\tau_\beta</annotation></semantics></math></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">small</td>
<td align="right">0.125</td>
<td align="right">0.0625</td>
</tr>
<tr class="even">
<td align="left">moderate</td>
<td align="right">0.250</td>
<td align="right">0.1250</td>
</tr>
<tr class="odd">
<td align="left">substantial</td>
<td align="right">0.500</td>
<td align="right">0.2500</td>
</tr>
<tr class="even">
<td align="left">large</td>
<td align="right">1.000</td>
<td align="right">0.5000</td>
</tr>
<tr class="odd">
<td align="left">very large</td>
<td align="right">2.000</td>
<td align="right">1.0000</td>
</tr>
</tbody>
</table>
<p>Here we fit separate models to the historical drug-A and drug-B
single-agent data. Note, equivalently, a single hierarchical
double-combination model without any interaction could have been fit to
those data, and would have produced the same MAP priors for the
drug-level intercepts and slopes. A detailed specification of the models
being fit below is given in the appendix.</p>
<p>In this example we assume that the historical data for drug A comes
from a relatively different population (for example different line of
therapy) and the historical data for drug B stems from a very closely
related patient population. This translates into respective choices for
the between-trial heterogeneity priors according to the table above.</p>
<div class="section level3">
<h3 id="drug-a-model">Drug A model<a class="anchor" aria-label="anchor" href="#drug-a-model"></a>
</h3>
<p>Implementation of this meta-analysis of single-agent data is done
using <code><a href="../reference/blrm_exnex.html">blrm_exnex()</a></code>. In order to obtain directly a sample of
the MAP prior, we set the <code>sample_map</code> argument to
<code>TRUE</code>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># historical data for drug A</span></span>
<span><span class="va">hist_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  group_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="st">"trial_A"</span><span class="op">)</span>,</span>
<span>  drug_A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12.5</span>, <span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">80</span>, <span class="fl">100</span>, <span class="fl">150</span><span class="op">)</span>,</span>
<span>  num_patients <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">9</span>, <span class="fl">23</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  num_toxicities <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># reference dose for drug A</span></span>
<span><span class="va">dref_A</span> <span class="op">&lt;-</span> <span class="fl">80</span></span>
<span></span>
<span><span class="co"># bivariate normal prior for (intercept, log-slope) </span></span>
<span><span class="va">prior_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://opensource.nibr.com/RBesT/reference/mixmvnorm.html" class="external-link">mixmvnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>,</span>
<span>                       <span class="fu"><a href="../reference/lodds.html">logit</a></span><span class="op">(</span><span class="fl">0.2</span><span class="op">)</span>, <span class="fl">0</span>,</span>
<span>                       <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1.96</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># between-trial heterogeneity is centered on "substantial"</span></span>
<span><span class="va">tau_substantial_prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://opensource.nibr.com/RBesT/reference/mixmvnorm.html" class="external-link">mixmvnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>,</span>
<span>                                     <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.25</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                     <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1.96</span>, <span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fit the model to the historical data</span></span>
<span><span class="va">map_model_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blrm_exnex.html">blrm_exnex</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">num_toxicities</span>, <span class="va">num_patients</span> <span class="op">-</span> <span class="va">num_toxicities</span><span class="op">)</span> <span class="op">~</span> </span>
<span>    <span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">drug_A</span> <span class="op">/</span> <span class="va">dref_A</span><span class="op">)</span> <span class="op">|</span> </span>
<span>    <span class="fl">0</span> <span class="op">|</span> </span>
<span>    <span class="va">group_id</span>,</span>
<span>  data <span class="op">=</span> <span class="va">hist_A</span>,</span>
<span>  prior_EX_mu_comp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">prior_A</span><span class="op">)</span>,</span>
<span>  prior_EX_tau_comp <span class="op">=</span> <span class="va">tau_substantial_prior</span>,</span>
<span>  prior_EX_prob_comp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, nrow <span class="op">=</span> <span class="fl">1</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  prior_tau_dist <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sample_map <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="drug-b-model">Drug B model<a class="anchor" aria-label="anchor" href="#drug-b-model"></a>
</h3>
<p>Similarly, for drug B:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># historical data for drug B</span></span>
<span><span class="va">hist_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  group_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="st">"trial_B"</span><span class="op">)</span>,</span>
<span>  drug_B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.125</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2.5</span>, <span class="fl">3</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>  num_patients <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">7</span>, <span class="fl">12</span>, <span class="fl">3</span><span class="op">)</span>,</span>
<span>  num_toxicities <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># reference dose</span></span>
<span><span class="va">dref_B</span> <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co"># prior for (intercept, log-slope)</span></span>
<span><span class="va">prior_B</span> <span class="op">&lt;-</span> <span class="va">prior_A</span></span>
<span></span>
<span><span class="co"># between-trial heterogeneity is centered on "small", but with a</span></span>
<span><span class="co"># greater degree of uncertainty on this classification</span></span>
<span><span class="va">tau_small_prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://opensource.nibr.com/RBesT/reference/mixmvnorm.html" class="external-link">mixmvnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>,</span>
<span>                               <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.125</span>, <span class="fl">0.0625</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                               <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1.96</span>, <span class="fl">2</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fit model to historical data</span></span>
<span><span class="va">map_model_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blrm_exnex.html">blrm_exnex</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">num_toxicities</span>, <span class="va">num_patients</span> <span class="op">-</span> <span class="va">num_toxicities</span><span class="op">)</span> <span class="op">~</span> </span>
<span>    <span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">drug_B</span> <span class="op">/</span> <span class="va">dref_B</span><span class="op">)</span> <span class="op">|</span> </span>
<span>    <span class="fl">0</span> <span class="op">|</span> </span>
<span>    <span class="va">group_id</span>,</span>
<span>  data <span class="op">=</span> <span class="va">hist_B</span>,</span>
<span>  prior_EX_mu_comp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">prior_B</span><span class="op">)</span>,</span>
<span>  prior_EX_tau_comp <span class="op">=</span> <span class="va">tau_small_prior</span>,</span>
<span>  prior_EX_prob_comp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, nrow <span class="op">=</span> <span class="fl">1</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  prior_tau_dist <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sample_map <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="extraction-of-map-priors">Extraction of MAP priors<a class="anchor" aria-label="anchor" href="#extraction-of-map-priors"></a>
</h3>
<p>We now illustrate how these meta-analytic model fits can be used to
produce a parametric MAP prior for the new study intercepts and
slopes.</p>
<div class="section level4">
<h4 id="mcmc-samples">MCMC samples<a class="anchor" aria-label="anchor" href="#mcmc-samples"></a>
</h4>
<p>Since we called <code>blrm_exnex</code> with the
<code>sample_map=TRUE</code> argument, the posterior now contains the
respective MAP prior MCMC samples for <code>"map_log_beta"</code>
containing for each defined stratum (just one in our case) the MAP
priors in MCMC form for intercept and slope. Here we extract these as
<code>rvar</code> variables which simplifies working with the posterior
draws.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rvar_map_log_beta_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/draws-OncoBayes2.html">as_draws_rvars</a></span><span class="op">(</span><span class="va">map_model_A</span>, variable<span class="op">=</span><span class="st">"map_log_beta"</span><span class="op">)</span><span class="op">$</span><span class="va">map_log_beta</span></span>
<span><span class="va">rvar_map_log_beta_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/draws-OncoBayes2.html">as_draws_rvars</a></span><span class="op">(</span><span class="va">map_model_B</span>, variable<span class="op">=</span><span class="st">"map_log_beta"</span><span class="op">)</span><span class="op">$</span><span class="va">map_log_beta</span></span></code></pre></div>
<p>These are posteriors of 3-dimensional arrays with the dimensions
stratum, drug component and coefficient. In the discussed example only a
single stratum and single drug component (per fitted model) is present
such that we directly select the respective entries of the array here
(note that you may use names to access the respective entries in the
array):</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rvar_map_log_beta_A</span><span class="op">[</span><span class="fl">1</span>,<span class="st">"log(drug_A/dref_A)"</span>,,drop<span class="op">=</span><span class="cn">TRUE</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;500,4&gt;[2] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">##     intercept     log_slope </span></span>
<span><span class="co">## -1.73 ± 0.82   0.34 ± 0.72</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rvar_map_log_beta_B</span><span class="op">[</span><span class="fl">1</span>,<span class="st">"log(drug_B/dref_B)"</span>,,drop<span class="op">=</span><span class="cn">TRUE</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## rvar&lt;500,4&gt;[2] <span style="color: #949494;">mean ± sd:</span></span></span>
<span><span class="co">##     intercept     log_slope </span></span>
<span><span class="co">## -2.74 ± 0.62  -0.45 ± 0.53</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="mixture-approximation">Mixture approximation<a class="anchor" aria-label="anchor" href="#mixture-approximation"></a>
</h4>
<p>In order to leverage these MAP distributions in analyzing the new
combination study data, we need to operationalize them as parametric
prior distributions for the combination model. This is done by
approximating them with finite mixtures of multivariate normal
distributions, handled by the <code>RBesT</code> function
<code><a href="https://opensource.nibr.com/RBesT/reference/automixfit.html" class="external-link">automixfit()</a></code>. The <code><a href="https://opensource.nibr.com/RBesT/reference/automixfit.html" class="external-link">automixfit()</a></code> function
expects the posterior samples in matrix form such that we convert the
draws accordingly:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map_mix_A</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://opensource.nibr.com/RBesT/reference/automixfit.html" class="external-link">automixfit</a></span><span class="op">(</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/draws_of.html" class="external-link">draws_of</a></span><span class="op">(</span><span class="va">rvar_map_log_beta_A</span><span class="op">[</span><span class="fl">1</span>,<span class="st">"log(drug_A/dref_A)"</span>,,drop<span class="op">=</span><span class="cn">TRUE</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                        type <span class="op">=</span> <span class="st">"mvnorm"</span><span class="op">)</span></span>
<span><span class="va">map_mix_A</span></span></code></pre></div>
<pre><code><span><span class="co">## EM for Multivariate Normal Mixture Model</span></span>
<span><span class="co">## Log-Likelihood = -4557.01</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Multivariate normal mixture</span></span>
<span><span class="co">## Outcome dimension: 2</span></span>
<span><span class="co">## Mixture Components:</span></span>
<span><span class="co">##                          comp1       comp2      </span></span>
<span><span class="co">## w                         0.56206771  0.43793229</span></span>
<span><span class="co">## m[intercept]             -1.88227571 -1.52601780</span></span>
<span><span class="co">## m[log_slope]              0.59136954  0.01259954</span></span>
<span><span class="co">## s[intercept]              0.68030368  0.92524450</span></span>
<span><span class="co">## s[log_slope]              0.59829373  0.73241598</span></span>
<span><span class="co">## rho[log_slope,intercept] -0.29870546  0.12832698</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map_mix_B</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://opensource.nibr.com/RBesT/reference/automixfit.html" class="external-link">automixfit</a></span><span class="op">(</span><span class="fu"><a href="https://mc-stan.org/posterior/reference/draws_of.html" class="external-link">draws_of</a></span><span class="op">(</span><span class="va">rvar_map_log_beta_B</span><span class="op">[</span><span class="fl">1</span>,<span class="st">"log(drug_B/dref_B)"</span>,,drop<span class="op">=</span><span class="cn">TRUE</span><span class="op">]</span><span class="op">)</span>,</span>
<span>                        type <span class="op">=</span> <span class="st">"mvnorm"</span><span class="op">)</span></span>
<span><span class="va">map_mix_B</span></span></code></pre></div>
<pre><code><span><span class="co">## EM for Multivariate Normal Mixture Model</span></span>
<span><span class="co">## Log-Likelihood = -3252.692</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Multivariate normal mixture</span></span>
<span><span class="co">## Outcome dimension: 2</span></span>
<span><span class="co">## Mixture Components:</span></span>
<span><span class="co">##                          comp1       comp2       comp3      </span></span>
<span><span class="co">## w                         0.37748737  0.37130812  0.25120451</span></span>
<span><span class="co">## m[intercept]             -2.62052660 -2.62077157 -3.09269497</span></span>
<span><span class="co">## m[log_slope]             -0.36785969 -0.78173676 -0.08761646</span></span>
<span><span class="co">## s[intercept]              0.42385373  0.66468212  0.66682656</span></span>
<span><span class="co">## s[log_slope]              0.40861667  0.51156577  0.40148441</span></span>
<span><span class="co">## rho[log_slope,intercept] -0.39229212 -0.05739021 -0.50121005</span></span></code></pre>
<p>The appropriateness of the parametric approximation to the MCMC
sample can be visually inspected using the <code>plot</code> function
from <code>RBesT</code>:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">map_mix_A</span><span class="op">)</span><span class="op">$</span><span class="va">mixpairs</span></span></code></pre></div>
<pre><code><span><span class="co">## Diagnostic plots for mixture multivariate normal densities are experimental.</span></span>
<span><span class="co">## Please note that these are subject to changes in future releases.</span></span></code></pre>
<p><img src="map_approach_files/figure-html/mixfit_plot_A-1.png" width="700"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot(map_mix_B)$mixpairs  # respective plot for drug B</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="combination-model-with-map-priors-for-the-new-study">Combination model with MAP priors for the new study<a class="anchor" aria-label="anchor" href="#combination-model-with-map-priors-for-the-new-study"></a>
</h2>
<p>Finally, these mixtures become the prior distributions for the
combination dose-toxicity model in the new study. In this combination
model we now do not need any longer a hierarchical model structure such
we turn this part of the model off by setting
<code>tau_prior_dist=NULL</code>. Note that doing so merely setups the
model to use known heterogeneities
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
which are fixed to a zero mean, which is what subsequent output will
display. A detailed description of this model is found in appendix.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># one row of dummy data with number of patients set to zero in order</span></span>
<span><span class="co"># to allow the model to be fit</span></span>
<span><span class="va">dummy_data_AB</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  group_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="st">"trial_AB"</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"trial_AB"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  drug_A <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  drug_B <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  num_patients <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  num_toxicities <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">interaction_prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://opensource.nibr.com/RBesT/reference/mixmvnorm.html" class="external-link">mixmvnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">9</span><span class="op">)</span><span class="op">/</span><span class="fl">1.96</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fit a double-combination model using the MAP priors</span></span>
<span><span class="va">map_combo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blrm_exnex.html">blrm_exnex</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">num_toxicities</span>, <span class="va">num_patients</span> <span class="op">-</span> <span class="va">num_toxicities</span><span class="op">)</span> <span class="op">~</span></span>
<span>    <span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">drug_A</span> <span class="op">/</span> <span class="va">dref_A</span><span class="op">)</span><span class="op">)</span> <span class="op">|</span></span>
<span>    <span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">drug_B</span> <span class="op">/</span> <span class="va">dref_B</span><span class="op">)</span><span class="op">)</span> <span class="op">|</span></span>
<span>    <span class="fl">0</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">drug_A</span><span class="op">/</span><span class="va">dref_A</span> <span class="op">*</span> <span class="va">drug_B</span><span class="op">/</span><span class="va">dref_B</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">drug_A</span><span class="op">/</span><span class="va">dref_A</span> <span class="op">*</span> <span class="va">drug_B</span><span class="op">/</span><span class="va">dref_B</span><span class="op">)</span><span class="op">)</span> <span class="op">|</span></span>
<span>    <span class="va">group_id</span>,</span>
<span>  data <span class="op">=</span> <span class="va">dummy_data_AB</span>,</span>
<span>  prior_EX_mu_comp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">map_mix_A</span>, <span class="va">map_mix_B</span><span class="op">)</span>, <span class="co"># BVN mixtures for (log-alpha, log-beta) for drugs A and B</span></span>
<span>  prior_EX_mu_inter <span class="op">=</span> <span class="va">interaction_prior</span>,</span>
<span>  </span>
<span>  <span class="co"># shut off hierarchical part of model --</span></span>
<span>  prior_tau_dist <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>This defines the prior distribution for the dose-toxicity
relationship in the novel combination. We can visualize the prior
distributions for the DLT rates:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">doses</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidyr.tidyverse.org/reference/expand_grid.html" class="external-link">expand_grid</a></span><span class="op">(</span></span>
<span>  group_id <span class="op">=</span> <span class="st">"trial_AB"</span>,</span>
<span>  drug_A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">50</span>, <span class="fl">80</span>, <span class="fl">100</span><span class="op">)</span>,</span>
<span>  drug_B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">drug_B</span>, <span class="va">drug_A</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/plot_blrm.html">plot_toxicity_curve</a></span><span class="op">(</span><span class="va">map_combo</span>,</span>
<span>                    newdata <span class="op">=</span> <span class="va">doses</span>,</span>
<span>                    x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">drug_A</span><span class="op">)</span>,</span>
<span>                    group <span class="op">=</span> <span class="op">~</span> <span class="va">drug_B</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use `linewidth` instead.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> The deprecated feature was likely used in the <span style="color: #0000BB;">OncoBayes2</span> package.</span></span>
<span><span class="co">##   Please report the issue at <span style="color: #0000BB; font-style: italic;">&lt;https://github.com/Novartis/OncoBayes2/issues&gt;</span>.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<p><img src="map_approach_files/figure-html/plot_map-1.png" width="700"></p>
<p>We also now have an understanding of which combination doses may have
a high risk of DLTs in terms of the posterior mean,</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map_summ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">map_combo</span>, newdata <span class="op">=</span> <span class="va">doses</span>, interval_prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.16</span>, <span class="fl">0.33</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">doses</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drug_A"</span>, <span class="st">"drug_B"</span><span class="op">)</span><span class="op">]</span>, <span class="va">map_summ</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="st">"sd"</span>, <span class="st">"(0.33,1]"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Drug A"</span>, <span class="st">"Drug B"</span>, <span class="st">"mean"</span>, <span class="st">"sd"</span>, <span class="st">"P(DLT rate &gt; 0.33)"</span><span class="op">)</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"Posterior summary statistics for P(DLT) by dose"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Posterior summary statistics for P(DLT) by dose</caption>
<thead><tr class="header">
<th align="right">Drug A</th>
<th align="right">Drug B</th>
<th align="right">mean</th>
<th align="right">sd</th>
<th align="right">P(DLT rate &gt; 0.33)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">25</td>
<td align="right">0.5</td>
<td align="right">0.10</td>
<td align="right">0.08</td>
<td align="right">0.01</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">0.5</td>
<td align="right">0.16</td>
<td align="right">0.12</td>
<td align="right">0.08</td>
</tr>
<tr class="odd">
<td align="right">80</td>
<td align="right">0.5</td>
<td align="right">0.24</td>
<td align="right">0.17</td>
<td align="right">0.26</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="right">0.5</td>
<td align="right">0.30</td>
<td align="right">0.20</td>
<td align="right">0.37</td>
</tr>
<tr class="odd">
<td align="right">25</td>
<td align="right">1.0</td>
<td align="right">0.13</td>
<td align="right">0.10</td>
<td align="right">0.05</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">1.0</td>
<td align="right">0.19</td>
<td align="right">0.16</td>
<td align="right">0.19</td>
</tr>
<tr class="odd">
<td align="right">80</td>
<td align="right">1.0</td>
<td align="right">0.28</td>
<td align="right">0.22</td>
<td align="right">0.33</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="right">1.0</td>
<td align="right">0.33</td>
<td align="right">0.25</td>
<td align="right">0.43</td>
</tr>
<tr class="odd">
<td align="right">25</td>
<td align="right">3.0</td>
<td align="right">0.23</td>
<td align="right">0.19</td>
<td align="right">0.25</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">3.0</td>
<td align="right">0.29</td>
<td align="right">0.25</td>
<td align="right">0.36</td>
</tr>
<tr class="odd">
<td align="right">80</td>
<td align="right">3.0</td>
<td align="right">0.35</td>
<td align="right">0.29</td>
<td align="right">0.45</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="right">3.0</td>
<td align="right">0.39</td>
<td align="right">0.31</td>
<td align="right">0.49</td>
</tr>
</tbody>
</table>
<p>and the posterior predictive distribution when assuming a specific
cohort size (6 used as example here):</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map_pred_summ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">map_combo</span>,</span>
<span>                         newdata <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span><span class="va">doses</span>, num_toxicities<span class="op">=</span><span class="fl">0</span>, num_patients<span class="op">=</span><span class="fl">6</span><span class="op">)</span>,</span>
<span>                         predictive<span class="op">=</span><span class="cn">TRUE</span>, interval_prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">doses</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drug_A"</span>, <span class="st">"drug_B"</span><span class="op">)</span><span class="op">]</span>, <span class="va">map_pred_summ</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"(-1,0]"</span>, <span class="st">"(0,1]"</span>, <span class="st">"(1,6]"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Drug A"</span>, <span class="st">"Drug B"</span>, <span class="st">"Pr(0 of 6 DLT)"</span>, <span class="st">"Pr(1 of 6 DLT)"</span>, <span class="st">"Pr(&gt;=2 of 6 DLT)"</span><span class="op">)</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"Posterior predictive summary for Pr(DLT) by dose"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Posterior predictive summary for Pr(DLT) by dose</caption>
<thead><tr class="header">
<th align="right">Drug A</th>
<th align="right">Drug B</th>
<th align="right">Pr(0 of 6 DLT)</th>
<th align="right">Pr(1 of 6 DLT)</th>
<th align="right">Pr(&gt;=2 of 6 DLT)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">25</td>
<td align="right">0.5</td>
<td align="right">0.58</td>
<td align="right">0.29</td>
<td align="right">0.13</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">0.5</td>
<td align="right">0.45</td>
<td align="right">0.31</td>
<td align="right">0.24</td>
</tr>
<tr class="odd">
<td align="right">80</td>
<td align="right">0.5</td>
<td align="right">0.32</td>
<td align="right">0.29</td>
<td align="right">0.40</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="right">0.5</td>
<td align="right">0.26</td>
<td align="right">0.26</td>
<td align="right">0.49</td>
</tr>
<tr class="odd">
<td align="right">25</td>
<td align="right">1.0</td>
<td align="right">0.51</td>
<td align="right">0.30</td>
<td align="right">0.19</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">1.0</td>
<td align="right">0.40</td>
<td align="right">0.28</td>
<td align="right">0.31</td>
</tr>
<tr class="odd">
<td align="right">80</td>
<td align="right">1.0</td>
<td align="right">0.31</td>
<td align="right">0.24</td>
<td align="right">0.44</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="right">1.0</td>
<td align="right">0.27</td>
<td align="right">0.22</td>
<td align="right">0.51</td>
</tr>
<tr class="odd">
<td align="right">25</td>
<td align="right">3.0</td>
<td align="right">0.37</td>
<td align="right">0.26</td>
<td align="right">0.37</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">3.0</td>
<td align="right">0.34</td>
<td align="right">0.22</td>
<td align="right">0.45</td>
</tr>
<tr class="odd">
<td align="right">80</td>
<td align="right">3.0</td>
<td align="right">0.29</td>
<td align="right">0.19</td>
<td align="right">0.52</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="right">3.0</td>
<td align="right">0.26</td>
<td align="right">0.17</td>
<td align="right">0.56</td>
</tr>
</tbody>
</table>
<p>One can see that under the combination one has to decrease the
starting doses well below the declared MTDs for each drug. This is a
consequence of their combination in a new trial such that the
between-trial heterogeneity leads to an increased uncertainty in the
dose-toxicity. The uncertainty is additionally increased through the
introduction of a possible interaction between the two drugs. With the
increased uncertainty in the dose-toxicity curve, the escalation with
overdose criterion EWOC automatically penalizes this lack of knowledge
and requires a conservative starting dose for escalation.</p>
<div class="section level3">
<h3 id="robustification">Robustification<a class="anchor" aria-label="anchor" href="#robustification"></a>
</h3>
<p>Direct use of the MAP priors assumes ex-changeability of the
historical and the new trial data. However, this assumption can be
violated such that we may wish to robustify the analysis. This can be
achieved by complementing the MAP prior by a weakly informative mixture
component with some non-zero weight. While the hierarchical model itself
down-weights the historical data already, that is we admit through the
interchangeability differences between trials, adding in this way an
additional weakly informative mixture component leads to an even greater
robustness against a prior-data conflict. This process is sometimes
referred to as “robustification”, and the resulting prior known as a
robust MAP (rMAP) prior. The robustification step is conceptually
equivalent to the use of the EXNEX model under a MAC approach. However,
the two techniques - robustification and EXNEX - differ in that
robustification is a step done after derivation of the MAP prior while
the EXNEX model is a joint model fit.</p>
<p>The robust MAP approach is implemented as:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># weakly-informative mixture component is chosen here to be equal to</span></span>
<span><span class="co"># the priors used in the first place</span></span>
<span><span class="va">weak_A</span> <span class="op">&lt;-</span> <span class="va">prior_A</span></span>
<span><span class="va">weak_B</span> <span class="op">&lt;-</span> <span class="va">prior_B</span></span>
<span></span>
<span><span class="co"># adding this to the drug-A and drug-B MAP priors with weight 0.1</span></span>
<span><span class="va">mix_A_robust</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://opensource.nibr.com/RBesT/reference/mixcombine.html" class="external-link">mixcombine</a></span><span class="op">(</span><span class="va">map_mix_A</span>, <span class="va">weak_A</span>, weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mix_B_robust</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://opensource.nibr.com/RBesT/reference/mixcombine.html" class="external-link">mixcombine</a></span><span class="op">(</span><span class="va">map_mix_B</span>, <span class="va">weak_B</span>, weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.9</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># robust MAP priors</span></span>
<span><span class="va">mix_robust</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">mix_A_robust</span>, <span class="va">mix_B_robust</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># fit a double-combination model using the rMAP priors</span></span>
<span><span class="va">robust_map_combo</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/update.html" class="external-link">update</a></span><span class="op">(</span><span class="va">map_combo</span>, prior_EX_mu_comp <span class="op">=</span> <span class="va">mix_robust</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># disabled plot here</span></span>
<span><span class="fu"><a href="../reference/plot_blrm.html">plot_toxicity_curve</a></span><span class="op">(</span><span class="va">robust_map_combo</span>,</span>
<span>                    newdata <span class="op">=</span> <span class="va">doses</span>,</span>
<span>                    x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/vars.html" class="external-link">vars</a></span><span class="op">(</span><span class="va">drug_A</span><span class="op">)</span>,</span>
<span>                    group <span class="op">=</span> <span class="op">~</span> <span class="va">drug_B</span><span class="op">)</span>  <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position<span class="op">=</span><span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="equivalence-of-map-and-mac-advanced">Equivalence of MAP and MAC (advanced)<a class="anchor" aria-label="anchor" href="#equivalence-of-map-and-mac-advanced"></a>
</h2>
<p>To demonstrate the equivalence of MAP and MAC, we will illustrate
implementation of the latter approach.</p>
<p>First, we combine the data from all three sources.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"trial_A"</span>, <span class="st">"trial_B"</span>, <span class="st">"trial_AB"</span><span class="op">)</span></span>
<span><span class="va">mac_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bind_rows_0.html">bind_rows_0</a></span><span class="op">(</span><span class="va">hist_A</span>, <span class="va">hist_B</span><span class="op">)</span></span>
<span><span class="va">mac_data</span><span class="op">$</span><span class="va">group_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">mac_data</span><span class="op">$</span><span class="va">group_id</span><span class="op">)</span>, levels <span class="op">=</span> <span class="va">groups</span><span class="op">)</span></span></code></pre></div>
<p>Next, we jointly model all available data using a hierarchical
double-combination BLRM, whose detailed specification can be found in
the appendix. Note that the hierarchical model on the interaction
parameter is not present in the combination model. This cannot be turned
off here such that we assign a negligibly small mean value for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
interaction heterogeneity.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dummy_tau_inter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://opensource.nibr.com/RBesT/reference/mixmvnorm.html" class="external-link">mixmvnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">1E-4</span><span class="op">)</span>, <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">1.96</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">num_comp</span>   <span class="op">&lt;-</span> <span class="fl">2</span> <span class="co"># number of treatment components</span></span>
<span><span class="va">num_inter</span>  <span class="op">&lt;-</span> <span class="fl">1</span></span>
<span><span class="va">num_groups</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">groups</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mac_combo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/blrm_exnex.html">blrm_exnex</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">num_toxicities</span>, <span class="va">num_patients</span> <span class="op">-</span> <span class="va">num_toxicities</span><span class="op">)</span> <span class="op">~</span></span>
<span>    <span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">drug_A</span> <span class="op">/</span> <span class="va">dref_A</span><span class="op">)</span><span class="op">)</span> <span class="op">|</span></span>
<span>    <span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">drug_B</span> <span class="op">/</span> <span class="va">dref_B</span><span class="op">)</span><span class="op">)</span> <span class="op">|</span></span>
<span>    <span class="fl">0</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">drug_A</span><span class="op">/</span><span class="va">dref_A</span> <span class="op">*</span> <span class="va">drug_B</span><span class="op">/</span><span class="va">dref_B</span><span class="op">)</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">drug_A</span><span class="op">/</span><span class="va">dref_A</span> <span class="op">*</span> <span class="va">drug_B</span><span class="op">/</span><span class="va">dref_B</span><span class="op">)</span><span class="op">)</span> <span class="op">|</span></span>
<span>    <span class="va">group_id</span>,</span>
<span>  data <span class="op">=</span> <span class="va">mac_data</span>,</span>
<span>  prior_EX_mu_comp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">prior_A</span>, <span class="va">prior_B</span><span class="op">)</span>,</span>
<span>  prior_EX_tau_comp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">tau_substantial_prior</span>, <span class="va">tau_small_prior</span><span class="op">)</span>,</span>
<span>  prior_EX_mu_inter <span class="op">=</span> <span class="va">interaction_prior</span>,</span>
<span>  prior_EX_tau_inter <span class="op">=</span> <span class="va">dummy_tau_inter</span>,</span>
<span>  prior_is_EXNEX_comp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="va">num_comp</span><span class="op">)</span>,</span>
<span>  prior_is_EXNEX_inter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="va">num_inter</span><span class="op">)</span>,</span>
<span>  prior_EX_prob_comp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, nrow <span class="op">=</span> <span class="va">num_groups</span>, ncol <span class="op">=</span> <span class="va">num_comp</span><span class="op">)</span>,</span>
<span>  prior_EX_prob_inter <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">1</span>, nrow <span class="op">=</span> <span class="va">num_groups</span>, ncol <span class="op">=</span> <span class="va">num_inter</span><span class="op">)</span>,</span>
<span>  prior_tau_dist <span class="op">=</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Info: The group(s) trial_AB have undefined strata. Assigning first stratum 1.</span></span></code></pre>
<p>Now we compare posterior inference for the DLT rates:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mac_summ</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">mac_combo</span>, newdata <span class="op">=</span> <span class="va">doses</span>, interval_prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.16</span>, <span class="fl">0.33</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">doses</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drug_A"</span>, <span class="st">"drug_B"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>        <span class="va">map_summ</span><span class="op">$</span><span class="va">mean</span>, <span class="va">mac_summ</span><span class="op">$</span><span class="va">mean</span>,</span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">map_summ</span><span class="op">$</span><span class="va">mean</span> <span class="op">-</span> <span class="va">mac_summ</span><span class="op">$</span><span class="va">mean</span><span class="op">)</span>,</span>
<span>        <span class="va">map_summ</span><span class="op">[[</span><span class="st">"(0.33,1]"</span><span class="op">]</span><span class="op">]</span>, <span class="va">mac_summ</span><span class="op">[[</span><span class="st">"(0.33,1]"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  col.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Drug A"</span>, <span class="st">"Drug B"</span>,</span>
<span>                <span class="st">"MAP mean"</span>, <span class="st">"MAC mean"</span>,</span>
<span>                <span class="st">"|MAP mean - MAC mean|"</span>,</span>
<span>                <span class="st">"MAP P(DLT rate &gt; 0.33)"</span>, <span class="st">"MAC P(DLT rate &gt; 0.33)"</span><span class="op">)</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  caption <span class="op">=</span> <span class="st">"Posterior summary statistics for P(DLT) by dose"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<table class="table">
<caption>Posterior summary statistics for P(DLT) by dose</caption>
<colgroup>
<col width="6%">
<col width="6%">
<col width="8%">
<col width="8%">
<col width="29%">
<col width="20%">
<col width="20%">
</colgroup>
<thead><tr class="header">
<th align="right">Drug A</th>
<th align="right">Drug B</th>
<th align="right">MAP mean</th>
<th align="right">MAC mean</th>
<th align="right">|MAP mean - MAC mean|</th>
<th align="right">MAP P(DLT rate &gt; 0.33)</th>
<th align="right">MAC P(DLT rate &gt; 0.33)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">25</td>
<td align="right">0.5</td>
<td align="right">0.10</td>
<td align="right">0.10</td>
<td align="right">0</td>
<td align="right">0.01</td>
<td align="right">0.02</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">0.5</td>
<td align="right">0.16</td>
<td align="right">0.16</td>
<td align="right">0</td>
<td align="right">0.08</td>
<td align="right">0.09</td>
</tr>
<tr class="odd">
<td align="right">80</td>
<td align="right">0.5</td>
<td align="right">0.24</td>
<td align="right">0.24</td>
<td align="right">0</td>
<td align="right">0.26</td>
<td align="right">0.25</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="right">0.5</td>
<td align="right">0.30</td>
<td align="right">0.30</td>
<td align="right">0</td>
<td align="right">0.37</td>
<td align="right">0.37</td>
</tr>
<tr class="odd">
<td align="right">25</td>
<td align="right">1.0</td>
<td align="right">0.13</td>
<td align="right">0.13</td>
<td align="right">0</td>
<td align="right">0.05</td>
<td align="right">0.05</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">1.0</td>
<td align="right">0.19</td>
<td align="right">0.19</td>
<td align="right">0</td>
<td align="right">0.19</td>
<td align="right">0.17</td>
</tr>
<tr class="odd">
<td align="right">80</td>
<td align="right">1.0</td>
<td align="right">0.28</td>
<td align="right">0.28</td>
<td align="right">0</td>
<td align="right">0.33</td>
<td align="right">0.33</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="right">1.0</td>
<td align="right">0.33</td>
<td align="right">0.33</td>
<td align="right">0</td>
<td align="right">0.43</td>
<td align="right">0.42</td>
</tr>
<tr class="odd">
<td align="right">25</td>
<td align="right">3.0</td>
<td align="right">0.23</td>
<td align="right">0.23</td>
<td align="right">0</td>
<td align="right">0.25</td>
<td align="right">0.23</td>
</tr>
<tr class="even">
<td align="right">50</td>
<td align="right">3.0</td>
<td align="right">0.29</td>
<td align="right">0.29</td>
<td align="right">0</td>
<td align="right">0.36</td>
<td align="right">0.35</td>
</tr>
<tr class="odd">
<td align="right">80</td>
<td align="right">3.0</td>
<td align="right">0.35</td>
<td align="right">0.35</td>
<td align="right">0</td>
<td align="right">0.45</td>
<td align="right">0.44</td>
</tr>
<tr class="even">
<td align="right">100</td>
<td align="right">3.0</td>
<td align="right">0.39</td>
<td align="right">0.39</td>
<td align="right">0</td>
<td align="right">0.49</td>
<td align="right">0.51</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="appendix-model-specification">Appendix: Model specification<a class="anchor" aria-label="anchor" href="#appendix-model-specification"></a>
</h2>
<div class="section level3">
<h3 id="combination-blrm-new-study-model">Combination BLRM (new study model)<a class="anchor" aria-label="anchor" href="#combination-blrm-new-study-model"></a>
</h3>
<p>Let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mi>A</mi></msub><annotation encoding="application/x-tex">d_A</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mi>B</mi></msub><annotation encoding="application/x-tex">d_B</annotation></semantics></math>
represent the doses of drugs A and B, respectively. The dose-toxicity
model for the combination expresses the DLT probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>A</mi></msub><mo>,</mo><msub><mi>d</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi_{AB}(d_A, d_B)</annotation></semantics></math>
as a function of the doses, through the following model for the DLT
odds</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><msub><mi>π</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>A</mi></msub><mo>,</mo><msub><mi>d</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>−</mo><msub><mi>π</mi><mrow><mi>A</mi><mi>B</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>A</mi></msub><mo>,</mo><msub><mi>d</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>=</mo><mfrac><mrow><msub><mi>π</mi><mo>⊥</mo></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>A</mi></msub><mo>,</mo><msub><mi>d</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>−</mo><msub><mi>π</mi><mo>⊥</mo></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>A</mi></msub><mo>,</mo><msub><mi>d</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>⋅</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>2</mn><mi>η</mi><mfrac><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>A</mi></msub><msub><mi>d</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>d</mi><mi>A</mi><mo>*</mo></msubsup><msubsup><mi>d</mi><mi>B</mi><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>A</mi></msub><msub><mi>d</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>d</mi><mi>A</mi><mo>*</mo></msubsup><msubsup><mi>d</mi><mi>B</mi><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">}</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex"> \frac{\pi_{AB}(d_A, d_B)}{1 - \pi_{AB}(d_A, d_B)} =
\frac{\pi_\perp(d_A, d_B)}{1 - \pi_\perp(d_A, d_B)} \cdot \exp\left\{
2 \eta \frac{(d_A d_B) / (d_A^* d_B^*) }{1 + (d_A d_B) / (d_A^*
d_B^*)}\right\}. </annotation></semantics></math></p>
<p>The two terms on the right-hand side are, respectively, the odds of
DLT under assumed independence of action for the two drugs, i.e.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mo>⊥</mo></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>A</mi></msub><mo>,</mo><msub><mi>d</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>π</mi><mi>A</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>A</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>π</mi><mi>B</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi_\perp(d_A, d_B) = 1 - (1 - \pi_A(d_A))(1 - \pi_B(d_B)) </annotation></semantics></math></p>
<p>and an interaction term which allows for modelling drug toxicity
interactions. See Widmer et al (2023) for a discussion of the
interaction model.</p>
<p>The terms
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mi>A</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>A</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi_A(d_A)</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mi>B</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi_B(d_B)</annotation></semantics></math>
represent the toxicity risk under each single-agent, respectively, and
are modelled with logistic regression as in Neuenschwander et al
(2008):</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mi>A</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>A</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mi>A</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mi>A</mi></msub><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>A</mi></msub><mi>/</mi><msubsup><mi>d</mi><mi>A</mi><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi_A(d_A) = \log(\alpha_A) + \beta_A \log(d_A / d_A^*)</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mi>B</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mi>B</mi></msub><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>B</mi></msub><mi>/</mi><msubsup><mi>d</mi><mi>B</mi><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi_B(d_B) = \log(\alpha_B) + \beta_B \log(d_B / d_B^*)</annotation></semantics></math></p>
<p>The model parameters are hence
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mi>A</mi></msub><mo>,</mo><msub><mi>β</mi><mi>A</mi></msub><mo>,</mo><msub><mi>α</mi><mi>B</mi></msub></mrow><annotation encoding="application/x-tex">\alpha_A, \beta_A, \alpha_B</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>β</mi><mi>B</mi></msub><annotation encoding="application/x-tex">\beta_B</annotation></semantics></math>
(the intercepts and slopes determining the dose-toxicity curve for the
two single agents), and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>η</mi><annotation encoding="application/x-tex">\eta</annotation></semantics></math>
(controlling the magnitude of drug toxicity interactions), while
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>d</mi><mi>A</mi><mo>*</mo></msubsup><annotation encoding="application/x-tex">d_A^*</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>d</mi><mi>B</mi><mo>*</mo></msubsup><annotation encoding="application/x-tex">d_B^*</annotation></semantics></math>
are fixed pre-specified reference doses for each drug.</p>
<p>This parametrization is convenient because in many such situations,
relevant information is available to inform prior distributions for the
intercepts and slopes. Specifically, in this example, we have used MAP
priors based on analysis of the historical data under meta-analytic
models.</p>
<div class="section level4">
<h4 id="prior-specification">Prior specification<a class="anchor" aria-label="anchor" href="#prior-specification"></a>
</h4>
<p>For the intercepts and slopes, the MAP priors have the form</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><msub><mi>α</mi><mi>A</mi></msub><mo>,</mo><mo>log</mo><msub><mi>β</mi><mi>A</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>K</mi><mi>A</mi></msub></munderover><msub><mi>w</mi><mrow><mi>A</mi><mi>k</mi></mrow></msub><mtext mathvariant="normal">BVN</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐦</mi><mrow><mi>A</mi><mi>k</mi></mrow></msub><mo>,</mo><msub><mi>𝐒</mi><mrow><mi>A</mi><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex"> (\log \alpha_A, \log \beta_A ) \sim \sum_{k = 1}^{K_A} w_{Ak} \mbox{BVN}( \mathbf m_{Ak}, \mathbf S_{Ak} ), </annotation></semantics></math></p>
<p>and</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><msub><mi>α</mi><mi>B</mi></msub><mo>,</mo><mo>log</mo><msub><mi>β</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo><munderover><mo>∑</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>K</mi><mi>B</mi></msub></munderover><msub><mi>w</mi><mrow><mi>B</mi><mi>k</mi></mrow></msub><mtext mathvariant="normal">BVN</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>𝐦</mi><mrow><mi>B</mi><mi>k</mi></mrow></msub><mo>,</mo><msub><mi>𝐒</mi><mrow><mi>B</mi><mi>k</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex"> (\log \alpha_B, \log \beta_B ) \sim \sum_{k = 1}^{K_B} w_{Bk} \mbox{BVN}( \mathbf m_{Bk}, \mathbf S_{Bk} ), </annotation></semantics></math></p>
<p>where the bivariate normal mixtures have been chosen to approximate
the MAP distribution, i.e.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map_mix_A</span></span></code></pre></div>
<pre><code><span><span class="co">## EM for Multivariate Normal Mixture Model</span></span>
<span><span class="co">## Log-Likelihood = -4557.01</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Multivariate normal mixture</span></span>
<span><span class="co">## Outcome dimension: 2</span></span>
<span><span class="co">## Mixture Components:</span></span>
<span><span class="co">##                          comp1       comp2      </span></span>
<span><span class="co">## w                         0.56206771  0.43793229</span></span>
<span><span class="co">## m[intercept]             -1.88227571 -1.52601780</span></span>
<span><span class="co">## m[log_slope]              0.59136954  0.01259954</span></span>
<span><span class="co">## s[intercept]              0.68030368  0.92524450</span></span>
<span><span class="co">## s[log_slope]              0.59829373  0.73241598</span></span>
<span><span class="co">## rho[log_slope,intercept] -0.29870546  0.12832698</span></span></code></pre>
<p>and</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">map_mix_B</span></span></code></pre></div>
<pre><code><span><span class="co">## EM for Multivariate Normal Mixture Model</span></span>
<span><span class="co">## Log-Likelihood = -3252.692</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Multivariate normal mixture</span></span>
<span><span class="co">## Outcome dimension: 2</span></span>
<span><span class="co">## Mixture Components:</span></span>
<span><span class="co">##                          comp1       comp2       comp3      </span></span>
<span><span class="co">## w                         0.37748737  0.37130812  0.25120451</span></span>
<span><span class="co">## m[intercept]             -2.62052660 -2.62077157 -3.09269497</span></span>
<span><span class="co">## m[log_slope]             -0.36785969 -0.78173676 -0.08761646</span></span>
<span><span class="co">## s[intercept]              0.42385373  0.66468212  0.66682656</span></span>
<span><span class="co">## s[log_slope]              0.40861667  0.51156577  0.40148441</span></span>
<span><span class="co">## rho[log_slope,intercept] -0.39229212 -0.05739021 -0.50121005</span></span></code></pre>
<p>For the interaction, the prior distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>η</mi><mo>∼</mo><mtext mathvariant="normal">N</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>9</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mn>1.96</mn><mo stretchy="true" form="postfix">)</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\eta \sim \mbox{N}(0,
(\log(9)/1.96)^2)</annotation></semantics></math> was used. This prior
is centered at zero interaction, and 95% of the probability mass falls
between DLT odds multipliers of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi>/</mi><mn>9</mn></mrow><annotation encoding="application/x-tex">1/9</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mn>9</mn><annotation encoding="application/x-tex">9</annotation></semantics></math>
(relative to the no-interaction model).</p>
</div>
</div>
<div class="section level3">
<h3 id="meta-analytic-models-for-the-historical-data">Meta-analytic models for the historical data<a class="anchor" aria-label="anchor" href="#meta-analytic-models-for-the-historical-data"></a>
</h3>
<p>The MAP approach begins with hierarchical meta-analytic modelling of
the historical data, allowing for the possibility of between-study
heterogeneity.</p>
<p>We describe this model for drug A (drug B being analogous). For
historical studies
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>H</mi></mrow><annotation encoding="application/x-tex">h =1 ,\ldots, H</annotation></semantics></math>
(in this case
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">H=1</annotation></semantics></math>),
the DLT probability for dose
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>d</mi><mi>A</mi></msub><annotation encoding="application/x-tex">d_A</annotation></semantics></math>
is modelled as</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mrow><mi>A</mi><mi>h</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>A</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>log</mo><msub><mi>α</mi><mrow><mi>A</mi><mi>h</mi></mrow></msub><mo>+</mo><msub><mi>β</mi><mrow><mi>A</mi><mi>h</mi></mrow></msub><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>A</mi></msub><mi>/</mi><msubsup><mi>d</mi><mi>A</mi><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex"> \pi_{Ah}(d_A) = \log \alpha_{Ah} + \beta_{Ah} \log(d_A / d_A^*). </annotation></semantics></math></p>
<p>Model parameters are assumed to be exchangeable across studies:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><msub><mi>α</mi><mrow><mi>A</mi><mi>h</mi></mrow></msub><mo>,</mo><mo>log</mo><msub><mi>β</mi><mrow><mi>A</mi><mi>h</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mspace width="0.167em"></mspace><mo>∼</mo><mspace width="0.167em"></mspace><mspace width="0.167em"></mspace><mtext mathvariant="normal">BVN</mtext><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mrow><mi>α</mi><mi>A</mi></mrow></msub><mo>,</mo><msub><mi>μ</mi><mrow><mi>β</mi><mi>A</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msub><mi>𝚺</mi><mi>A</mi></msub><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo><mspace width="1.667em"></mspace><mrow><mtext mathvariant="normal">for </mtext><mspace width="0.333em"></mspace></mrow><mi>h</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>H</mi><mo>,</mo></mrow><annotation encoding="application/x-tex"> (\log \alpha_{Ah}, \log \beta_{Ah})  \, \, \sim \, \,
\mbox{BVN}\bigl( (\mu_{\alpha A}, \mu_{\beta A}), \boldsymbol \Sigma_A
\bigr) \hspace{20pt} \text{for }h = 1,\ldots, H, </annotation></semantics></math></p>
<p>and to facilitate prediction of the dose-toxicity curve in a new
study, we additionally assume that the study-level parameters for the
new study are exchangeable with those of the historical studies:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><msub><mi>α</mi><mrow><mi>A</mi><mo>⋆</mo></mrow></msub><mo>,</mo><mo>log</mo><msub><mi>β</mi><mrow><mi>A</mi><mo>⋆</mo></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mspace width="0.167em"></mspace><mo>∼</mo><mspace width="0.167em"></mspace><mspace width="0.167em"></mspace><mtext mathvariant="normal">BVN</mtext><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mrow><mi>α</mi><mi>A</mi></mrow></msub><mo>,</mo><msub><mi>μ</mi><mrow><mi>β</mi><mi>A</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msub><mi>𝚺</mi><mi>A</mi></msub><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo><mi>.</mi></mrow><annotation encoding="application/x-tex"> (\log \alpha_{A\star}, \log \beta_{A\star}) \, \, \sim \, \,
\mbox{BVN}\bigl( (\mu_{\alpha A}, \mu_{\beta A}), \boldsymbol \Sigma_A
\bigr). </annotation></semantics></math></p>
<p>Here,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝚺</mi><mi>A</mi></msub><annotation encoding="application/x-tex">\boldsymbol \Sigma_A</annotation></semantics></math>
is a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mo>×</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">2 \times 2</annotation></semantics></math>
covariance matrix with standard deviations
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>τ</mi><mrow><mi>α</mi><mi>A</mi></mrow></msub><annotation encoding="application/x-tex">\tau_{\alpha A}</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>τ</mi><mrow><mi>β</mi><mi>A</mi></mrow></msub><annotation encoding="application/x-tex">\tau_{\beta A}</annotation></semantics></math>,
and correlation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ρ</mi><mi>A</mi></msub><annotation encoding="application/x-tex">\rho_A</annotation></semantics></math>.</p>
<p>This exchangeability assumption allows for posterior estimation of
the MAP distribution for a study-level parameters in a new study, given
historical data:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mrow><mi>A</mi><mo>⋆</mo></mrow></msub><mo>,</mo><msub><mi>β</mi><mrow><mi>A</mi><mo>⋆</mo></mrow></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>𝐱</mi><mtext mathvariant="normal">hist</mtext></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>∫</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mrow><mi>A</mi><mo>⋆</mo></mrow></msub><mo>,</mo><msub><mi>β</mi><mrow><mi>A</mi><mo>⋆</mo></mrow></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>μ</mi><mrow><mi>α</mi><mi>A</mi></mrow></msub><mo>,</mo><msub><mi>μ</mi><mrow><mi>β</mi><mi>A</mi></mrow></msub><mo>,</mo><msub><mi>τ</mi><mrow><mi>α</mi><mi>A</mi></mrow></msub><mo>,</mo><msub><mi>τ</mi><mrow><mi>β</mi><mi>A</mi></mrow></msub><mo>,</mo><mi>ρ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mspace width="0.167em"></mspace><mi>d</mi><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mrow><mi>α</mi><mi>A</mi></mrow></msub><mo>,</mo><msub><mi>μ</mi><mrow><mi>β</mi><mi>A</mi></mrow></msub><mo>,</mo><msub><mi>τ</mi><mrow><mi>α</mi><mi>A</mi></mrow></msub><mo>,</mo><msub><mi>τ</mi><mrow><mi>β</mi><mi>A</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>𝐱</mi><mtext mathvariant="normal">hist</mtext></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex"> f(\alpha_{A\star}, \beta_{A\star} | \mathbf x_{\text{hist}}) = \int f(\alpha_{A\star}, \beta_{A\star} | \mu_{\alpha A}, \mu_{\beta A}, \tau_{\alpha A}, \tau_{\beta A}, \rho) \, \, dF(\mu_{\alpha A}, \mu_{\beta A}, \tau_{\alpha A}, \tau_{\beta A} | \mathbf x_{\text{hist}}). </annotation></semantics></math></p>
<p>The model is completed with normal priors for the means</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mrow><mi>α</mi><mi>A</mi></mrow></msub><mo>∼</mo><mtext mathvariant="normal">N</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>m</mi><mrow><mi>α</mi><mi>A</mi></mrow></msub><mo>,</mo><msubsup><mi>s</mi><mrow><mi>α</mi><mi>A</mi></mrow><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> \mu_{\alpha A} \sim \mbox{N} ( m_{\alpha A}, s^2_{\alpha A}) </annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>μ</mi><mrow><mi>β</mi><mi>A</mi></mrow></msub><mo>∼</mo><mtext mathvariant="normal">N</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>m</mi><mrow><mi>β</mi><mi>A</mi></mrow></msub><mo>,</mo><msubsup><mi>s</mi><mrow><mi>β</mi><mi>A</mi></mrow><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> \mu_{\beta A} \sim \mbox{N} ( m_{\beta A}, s^2_{\beta A}) </annotation></semantics></math></p>
<p>lognormal priors for the standard deviations,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><msub><mi>τ</mi><mrow><mi>α</mi><mi>A</mi></mrow></msub><mo>∼</mo><mtext mathvariant="normal">N</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>m</mi><mrow><mi>τ</mi><mi>α</mi><mi>A</mi></mrow></msub><mo>,</mo><msubsup><mi>s</mi><mrow><mi>τ</mi><mi>α</mi><mi>A</mi></mrow><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> \log \tau_{\alpha A} \sim \mbox{N}( m_{\tau \alpha A}, s^2_{\tau \alpha A}) </annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>log</mo><msub><mi>τ</mi><mrow><mi>β</mi><mi>A</mi></mrow></msub><mo>∼</mo><mtext mathvariant="normal">N</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>m</mi><mrow><mi>τ</mi><mi>β</mi><mi>A</mi></mrow></msub><mo>,</mo><msubsup><mi>s</mi><mrow><mi>τ</mi><mi>β</mi><mi>A</mi></mrow><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> \log \tau_{\beta A} \sim \mbox{N}( m_{\tau \beta A}, s^2_{\tau \beta A}) </annotation></semantics></math></p>
<p>and for the correlation,</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mi>A</mi></msub><mo>∼</mo><mtext mathvariant="normal">U</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mo>−</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex"> \rho_A \sim \mbox{U}(-1, 1). </annotation></semantics></math></p>
<div class="section level4">
<h4 id="prior-specification-1">Prior specification<a class="anchor" aria-label="anchor" href="#prior-specification-1"></a>
</h4>
<p>Both models, for drugs A and B, used the same set of
hyper-parameters:</p>
<ul>
<li>Intercept mean and standard deviation:</li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mrow><mi>α</mi><mi>A</mi></mrow></msub><mo>=</mo><msub><mi>m</mi><mrow><mi>α</mi><mi>B</mi></mrow></msub><mo>=</mo><mtext mathvariant="normal">logit</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">m_{\alpha A} = m_{\alpha B} = \mbox{logit}(0.2)</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mrow><mi>α</mi><mi>A</mi></mrow></msub><mo>=</mo><msub><mi>s</mi><mrow><mi>α</mi><mi>B</mi></mrow></msub><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">s_{\alpha A} = s_{\alpha B} = 1</annotation></semantics></math></p>
<ul>
<li>Slope mean and standard deviation:</li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mrow><mi>β</mi><mi>A</mi></mrow></msub><mo>=</mo><msub><mi>m</mi><mrow><mi>β</mi><mi>B</mi></mrow></msub><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">m_{\beta A} = m_{\beta B} = \log(1)</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mrow><mi>β</mi><mi>A</mi></mrow></msub><mo>=</mo><msub><mi>s</mi><mrow><mi>β</mi><mi>B</mi></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><mn>4</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mn>1.96</mn></mrow><annotation encoding="application/x-tex">s_{\beta A} = s_{\beta B} = (\log 4) / 1.96</annotation></semantics></math></p>
<ul>
<li>Heterogeneity standard deviations:</li>
</ul>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mrow><mi>τ</mi><mi>α</mi><mi>A</mi></mrow></msub><mo>=</mo><msub><mi>m</mi><mrow><mi>τ</mi><mi>α</mi><mi>B</mi></mrow></msub><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.25</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">m_{\tau \alpha A} = m_{\tau \alpha B} = \log(0.25)</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>m</mi><mrow><mi>τ</mi><mi>β</mi><mi>A</mi></mrow></msub><mo>=</mo><msub><mi>m</mi><mrow><mi>τ</mi><mi>β</mi><mi>B</mi></mrow></msub><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.125</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">m_{\tau \beta A} = m_{\tau \beta B} = \log(0.125)</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>s</mi><mrow><mi>τ</mi><mi>α</mi><mi>A</mi></mrow></msub><mo>=</mo><msub><mi>s</mi><mrow><mi>τ</mi><mi>β</mi><mi>A</mi></mrow></msub><mo>=</mo><msub><mi>s</mi><mrow><mi>τ</mi><mi>α</mi><mi>B</mi></mrow></msub><mo>=</mo><msub><mi>s</mi><mrow><mi>τ</mi><mi>β</mi><mi>B</mi></mrow></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mn>1.96</mn></mrow><annotation encoding="application/x-tex">s_{\tau \alpha A} = s_{\tau \beta A} = s_{\tau \alpha B} = s_{\tau \beta B} = (\log 2) / 1.96</annotation></semantics></math></p>
</div>
</div>
<div class="section level3">
<h3 id="hierarchical-model-for-combined-data-mac">Hierarchical model for combined data (MAC)<a class="anchor" aria-label="anchor" href="#hierarchical-model-for-combined-data-mac"></a>
</h3>
<p>The MAC model is a combined model for data from all sources (both
single-agent trials and the planned combination study). Letting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
index these sources, the model covers toxicity of any combination of
doses of the two agents:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><msub><mi>π</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>A</mi></msub><mo>,</mo><msub><mi>d</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>−</mo><msub><mi>π</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>A</mi></msub><mo>,</mo><msub><mi>d</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>=</mo><mfrac><mrow><msub><mi>π</mi><mrow><mo>⊥</mo><mo>,</mo><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>A</mi></msub><mo>,</mo><msub><mi>d</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>−</mo><msub><mi>π</mi><mrow><mo>⊥</mo><mo>,</mo><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>A</mi></msub><mo>,</mo><msub><mi>d</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>⋅</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">{</mo><mn>2</mn><msub><mi>η</mi><mi>i</mi></msub><mfrac><mrow><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>A</mi></msub><msub><mi>d</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>d</mi><mi>A</mi><mo>*</mo></msubsup><msubsup><mi>d</mi><mi>B</mi><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>A</mi></msub><msub><mi>d</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>d</mi><mi>A</mi><mo>*</mo></msubsup><msubsup><mi>d</mi><mi>B</mi><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo stretchy="true" form="postfix">}</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex"> \frac{\pi_i(d_A, d_B)}{1 - \pi_i(d_A, d_B)} = \frac{\pi_{\perp, i}(d_A, d_B)}{1 - \pi_{\perp, i}(d_A, d_B)} \cdot \exp\left\{ 2 \eta_i \frac{(d_A d_B) / (d_A^* d_B^*) }{1 + (d_A d_B) / (d_A^* d_B^*)}\right\}. </annotation></semantics></math>
With, as before</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mrow><mo>⊥</mo><mo>,</mo><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>A</mi></msub><mo>,</mo><msub><mi>d</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>1</mn><mo>−</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>π</mi><mrow><mi>A</mi><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>A</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msub><mi>π</mi><mrow><mi>B</mi><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi_{\perp,i}(d_A, d_B) = 1 - (1 - \pi_{Ai}(d_A))(1 - \pi_{Bi}(d_B)) </annotation></semantics></math></p>
<p>and
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mrow><mi>A</mi><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>A</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mrow><mi>A</mi><mi>i</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mrow><mi>A</mi><mi>i</mi></mrow></msub><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>A</mi></msub><mi>/</mi><msubsup><mi>d</mi><mi>A</mi><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> \pi_{Ai}(d_A) = \log(\alpha_{Ai}) + \beta_{Ai} \log(d_A / d_A^*)</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>π</mi><mrow><mi>B</mi><mi>i</mi></mrow></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>α</mi><mrow><mi>B</mi><mi>i</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><msub><mi>β</mi><mrow><mi>B</mi><mi>i</mi></mrow></msub><mo>log</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>d</mi><mi>B</mi></msub><mi>/</mi><msubsup><mi>d</mi><mi>B</mi><mo>*</mo></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex"> \pi_{Bi}(d_B) = \log(\alpha_{Bi}) + \beta_{Bi} \log(d_B / d_B^*)</annotation></semantics></math></p>
<p>And as before, ex-changeability assumptions facilitate information
borrowing across data sources.</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><msub><mi>α</mi><mrow><mi>A</mi><mi>i</mi></mrow></msub><mo>,</mo><mo>log</mo><msub><mi>β</mi><mrow><mi>A</mi><mi>i</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mspace width="0.167em"></mspace><mo>∼</mo><mspace width="0.167em"></mspace><mspace width="0.167em"></mspace><mtext mathvariant="normal">BVN</mtext><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mrow><mi>α</mi><mi>A</mi></mrow></msub><mo>,</mo><msub><mi>μ</mi><mrow><mi>β</mi><mi>A</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msub><mi>𝚺</mi><mi>A</mi></msub><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo><mspace width="1.667em"></mspace><mrow><mtext mathvariant="normal">for </mtext><mspace width="0.333em"></mspace></mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>I</mi></mrow><annotation encoding="application/x-tex"> (\log \alpha_{Ai}, \log \beta_{Ai})  \, \, \sim \, \, \mbox{BVN}\bigl( (\mu_{\alpha A}, \mu_{\beta A}), \boldsymbol \Sigma_A \bigr) \hspace{20pt} \text{for }i = 1,\ldots, I </annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><msub><mi>α</mi><mrow><mi>B</mi><mi>i</mi></mrow></msub><mo>,</mo><mo>log</mo><msub><mi>β</mi><mrow><mi>B</mi><mi>i</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mspace width="0.167em"></mspace><mspace width="0.167em"></mspace><mo>∼</mo><mspace width="0.167em"></mspace><mspace width="0.167em"></mspace><mtext mathvariant="normal">BVN</mtext><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mrow><mi>α</mi><mi>B</mi></mrow></msub><mo>,</mo><msub><mi>μ</mi><mrow><mi>β</mi><mi>B</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><msub><mi>𝚺</mi><mi>B</mi></msub><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo><mspace width="1.667em"></mspace><mrow><mtext mathvariant="normal">for </mtext><mspace width="0.333em"></mspace></mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>I</mi></mrow><annotation encoding="application/x-tex"> (\log \alpha_{Bi}, \log \beta_{Bi})  \, \, \sim \, \, \mbox{BVN}\bigl( (\mu_{\alpha B}, \mu_{\beta B}), \boldsymbol \Sigma_B \bigr) \hspace{20pt} \text{for }i = 1,\ldots, I </annotation></semantics></math>
and</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>η</mi><mi>i</mi></msub><mo>∼</mo><mtext mathvariant="normal">N</mtext><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>μ</mi><mi>η</mi></msub><mo>,</mo><msubsup><mi>τ</mi><mi>η</mi><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex"> \eta_i \sim \mbox{N}(\mu_\eta, \tau^2_\eta). </annotation></semantics></math></p>
<p>Priors for the exchangeable means
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>μ</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
and variances
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
are identical to the meta-analytic models for the historical
single-agent data in the previous section.</p>
</div>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.5.1 (2025-06-13)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">## Running under: Ubuntu 24.04.3 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] ggplot2_4.0.0    knitr_1.50       tidyr_1.3.1      dplyr_1.1.4     </span></span>
<span><span class="co">## [5] posterior_1.6.1  OncoBayes2_0.9-4 RBesT_1.8-2     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] gtable_0.3.6          tensorA_0.36.2.1      xfun_0.53            </span></span>
<span><span class="co">##  [4] bslib_0.9.0           QuickJSR_1.8.1        inline_0.3.21        </span></span>
<span><span class="co">##  [7] vctrs_0.6.5           tools_4.5.1           generics_0.1.4       </span></span>
<span><span class="co">## [10] stats4_4.5.1          parallel_4.5.1        tibble_3.3.0         </span></span>
<span><span class="co">## [13] pkgconfig_2.0.3       checkmate_2.3.3       RColorBrewer_1.1-3   </span></span>
<span><span class="co">## [16] S7_0.2.0              desc_1.4.3            distributional_0.5.0 </span></span>
<span><span class="co">## [19] RcppParallel_5.1.11-1 assertthat_0.2.1      lifecycle_1.0.4      </span></span>
<span><span class="co">## [22] compiler_4.5.1        farver_2.1.2          stringr_1.5.2        </span></span>
<span><span class="co">## [25] textshaping_1.0.4     codetools_0.2-20      htmltools_0.5.8.1    </span></span>
<span><span class="co">## [28] sass_0.4.10           bayesplot_1.14.0      yaml_2.3.10          </span></span>
<span><span class="co">## [31] Formula_1.2-5         crayon_1.5.3          pillar_1.11.1        </span></span>
<span><span class="co">## [34] pkgdown_2.1.3         jquerylib_0.1.4       cachem_1.1.0         </span></span>
<span><span class="co">## [37] StanHeaders_2.32.10   abind_1.4-8           rstan_2.32.7         </span></span>
<span><span class="co">## [40] tidyselect_1.2.1      digest_0.6.37         mvtnorm_1.3-3        </span></span>
<span><span class="co">## [43] stringi_1.8.7         reshape2_1.4.4        purrr_1.1.0          </span></span>
<span><span class="co">## [46] labeling_0.4.3        fastmap_1.2.0         grid_4.5.1           </span></span>
<span><span class="co">## [49] cli_3.6.5             magrittr_2.0.4        loo_2.8.0            </span></span>
<span><span class="co">## [52] pkgbuild_1.4.8        withr_3.0.2           scales_1.4.0         </span></span>
<span><span class="co">## [55] backports_1.5.0       rmarkdown_2.30        matrixStats_1.5.0    </span></span>
<span><span class="co">## [58] gridExtra_2.3         ragg_1.5.0            evaluate_1.0.5       </span></span>
<span><span class="co">## [61] rstantools_2.5.0      rlang_1.1.6           isoband_0.2.7        </span></span>
<span><span class="co">## [64] Rcpp_1.1.0            glue_1.8.0            jsonlite_2.0.0       </span></span>
<span><span class="co">## [67] R6_2.6.1              plyr_1.8.9            systemfonts_1.3.1    </span></span>
<span><span class="co">## [70] fs_1.6.6</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian Weber, Lukas A. Widmer, Andrew Bean.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
