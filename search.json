[{"path":"http://opensource.nibr.com/OncoBayes2/articles/introduction.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Guiding Oncology Dose-Escalation Trials","text":"OncoBayes2 package provides flexible functions Bayesian meta-analytic modeling incidence Dose Limiting Toxicities (DLTs) dose level, treatment regimes involving number combination partners. models may used ensure patient safety trial conduct supporting dose-escalation decisions. addition, model can support estimation Maximum Tolerated Dose (MTD) adaptive Bayesian dose-escalation designs. Whereas traditional dose escalation designs, 3+3 design, base dosing decisions predefined rules number DLTs last one two cohorts current dose, model-based designs using Bayesian Logistic Regression Models (BLRMs) endeavor model dose-toxicity relationship continuous curve, allow model guide dosing decisions. way, available data contributes dosing decisions. Furthermore, extensions BLRM approach can support inclusion available additional data compound(s) involved. additional data can either historical data collected prior trial conduct concurrent data, collected trial conduct context another trial/context. package supports incorporation additional data Meta-Analytic-Combined (MAC) framework [1]. Within MAC model heterogeneous sources data assigned groups information shared across groups hierarchical model structure. given group leads borrowing strength groups discounting information groups. amount discounting (-weighting) determined heterogeneity. group commonly defined trial, must necessarily hold. key assumption hierarchical model exchangability assumption groups. two independent mechanisms package aim relaxing exchangability assumption: Differential discounting: Groups assigned different strata. overall hierarchical mean stays , heterogeneity groups allowed different strata. group must assigned single stratum . EXchangeable/Non-EXchangeable (EX/NEX) model group: EXNEX group modelled exchangeable probability allowed ’s group-specific estimate group exchangeable remainder data. techniques rather advanced discussed introduction. following illustrate first common use case historical information consider concurrent data addition. particular, discuss trial evaluating combination two drugs whenever historical information available drug individually separate trials. example expanded using addition concurrent data one drugs combination. Note terminology: literature (see [1], [2], [4]) term stratum refers trial commonly, OncoBayes2 deviates uses term group instead. line hierarchical modeling terminology. term stratum used define higher level grouping structure. , every group assigned single stratum within OncoBayes2. higher level grouping (groups groups) necessary whenever differential discounting used. convention OncoBayes2 assigns group stratum “” whenever stratum assigned group.","code":"## Load involved packages library(RBesT)        ## used to define priors library(OncoBayes2)   ## working horse library(dplyr)        ## for mutate library(tidyr)        ## defines expand_grid library(tibble)       ## for tibbles library(ggplot2)      ## for plotting"},{"path":"http://opensource.nibr.com/OncoBayes2/articles/introduction.html","id":"example-use-case-dual-combination-trial-with-historical-information","dir":"Articles","previous_headings":"","what":"Example use-case: Dual combination trial with historical information","title":"Guiding Oncology Dose-Escalation Trials","text":"Consider application described Section 3.2 [1], risk DLT studied function dose two drugs, drug drug B. Historical information toxicity profiles two drugs available single agent trials trial_A trial_B. historical data example available internal data set. objective aid dosing dose-escalation decisions future trial, trial_AB, drugs combined. Additionally, another investigator-initiated trial IIT study combination concurrently. Note -yet-unobserved sources data included input data unobserved factor levels. mechanism allows us specify joint meta-analytic prior four sources historical concurrent data. However, first consider dual combination trial AB ’s historical data add concurrent data later stage.","code":"kable(hist_combo2) levels(hist_combo2$group_id) ## [1] \"trial_A\"  \"trial_B\"  \"IIT\"      \"trial_AB\""},{"path":"http://opensource.nibr.com/OncoBayes2/articles/introduction.html","id":"setting-up-the-trial-design","dir":"Articles","previous_headings":"Example use-case: Dual combination trial with historical information","what":"Setting up the trial design","title":"Guiding Oncology Dose-Escalation Trials","text":"function blrm_trial provides object-oriented framework operationalizing dose-escalation trial design. framework intended convenient wrapper main model-fitting engine package, blrm_exnex() function. latter allows additional flexibility specifying functional form model, blrm_trial covers common use-cases. introductory vignette highlights blrm_trial lieu blrm_exnex; reader referred help-page function?blrm_exnex details. One begins blrm_trial specifying three key design elements: historical dose-toxicity data Information study drugs provisional dose levels studied escalation trial Information study drugs encoded tibble . includes names study-drugs, reference doses (see [3] ?blrm_exnex understand role choice plays model specification), dosing units, (optionally) priori expected DLT rate study drug given individually respective reference doses. design information study described [1] also included built-datasets, part OncoBayes2 package.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/articles/introduction.html","id":"drug-info","dir":"Articles","previous_headings":"Example use-case: Dual combination trial with historical information > Setting up the trial design","what":"Drug info","title":"Guiding Oncology Dose-Escalation Trials","text":"","code":"kable(drug_info_combo2)"},{"path":"http://opensource.nibr.com/OncoBayes2/articles/introduction.html","id":"dose-info","dir":"Articles","previous_headings":"Example use-case: Dual combination trial with historical information > Setting up the trial design","what":"Dose info","title":"Guiding Oncology Dose-Escalation Trials","text":"provisional dose levels specified . conciseness, limit dose level provisional doses.","code":"dose_info <- filter(   dose_info_combo2, group_id == \"trial_AB\",   drug_A %in% c(3, 6), drug_B %in% c(0, 400, 800) ) kable(dose_info)"},{"path":"http://opensource.nibr.com/OncoBayes2/articles/introduction.html","id":"initializing-a-blrm_trial","dir":"Articles","previous_headings":"Example use-case: Dual combination trial with historical information > Setting up the trial design","what":"Initializing a blrm_trial","title":"Guiding Oncology Dose-Escalation Trials","text":"Together data described previous section, objects can used initialize blrm_trial object.","code":"combo2_trial_setup <- blrm_trial(   data = hist_combo2,   drug_info = drug_info_combo2,   dose_info = dose_info ) ## No stratum defined - assigning all groups to single stratum \"all\" ## Please configure blrm_exnex using the update() function."},{"path":"http://opensource.nibr.com/OncoBayes2/articles/introduction.html","id":"specifying-the-prior-and-fitting-the-model","dir":"Articles","previous_headings":"Example use-case: Dual combination trial with historical information","what":"Specifying the prior and fitting the model","title":"Guiding Oncology Dose-Escalation Trials","text":"point, trial design initialized. However, absence simplified_prior = TRUE, yet specified prior distribution dose-toxicity model. OncoBayes2 provides two methods completing model specification: Use simplified_prior = TRUE, employs package-default prior distribution, subject small number optional arguments controlling details. Provide full prior specification passed blrm_exnex function. simplicity conciseness purposes, use method #1, recommended actual trials prior chosen deliberately guarantee simplified prior remain stable across releases package. See ?'example-combo2_trial' example #2. choice prior broadly follows case study [4], although slightly deviate model [4] different reference dose mean reference DLT rate. employ simplified prior, fit model MCMC: Now, object combo2_trial_start contains posterior model fit start trial, addition trial design details. Next highlight main methods extracting relevant information .","code":"combo2_trial_start <- blrm_trial(   data = hist_combo2,   drug_info = drug_info_combo2,   dose_info = dose_info,   simplified_prior = TRUE,   EXNEX_comp = FALSE,   EX_prob_comp_hist = 1,   EX_prob_comp_new = 1 ) ## Warning in .blrm_trial_compute_simple_prior(object = trial, EXNEX_comp = ## EXNEX_comp, : Simplified prior CAN and WILL change with releases. NOT ## recommended to use in production. Instantiating a simplified prior - run ## summary(trial, \"blrm_exnex_call\") to inspect arguments. ## Warning: There were 1 divergent transitions after warmup. See ## https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup ## to find out why this is a problem and how to eliminate them. ## Warning: Examine the pairs() plot to diagnose sampling problems ## Warning: 1 out of 6 ewoc metrics are within the 95% MCMC error of the decision boundary. ## Be careful when using the imprecise ewoc estimates! It is recommended to run ## more iterations and review doses close to critical thresholds. ## You may call \"summary(trial, summarize='ewoc_check', ...)\" for more diagnostic details. ## Please call \"help('blrm_trial', help_type='summary')\" for further documentation."},{"path":"http://opensource.nibr.com/OncoBayes2/articles/introduction.html","id":"summary-of-prior-specification","dir":"Articles","previous_headings":"Example use-case: Dual combination trial with historical information","what":"Summary of prior specification","title":"Guiding Oncology Dose-Escalation Trials","text":"function prior_summary provides facility printing, readable format, summary prior specification.","code":"prior_summary(combo2_trial_start) # not run here"},{"path":"http://opensource.nibr.com/OncoBayes2/articles/introduction.html","id":"summary-of-posterior","dir":"Articles","previous_headings":"Example use-case: Dual combination trial with historical information","what":"Summary of posterior","title":"Guiding Oncology Dose-Escalation Trials","text":"main target inference generally probability DLT selection provisional dose levels. obtain summaries provisional doses specified previously, simply write: summaries may used assess combination doses unacceptable high risk toxicity. example, according escalation overdose control (EWOC) design criteria [3], one compute posterior probability dose excessively toxic (column prob_overdose; note definition “excessively toxic” encoded blrm_trial object interval_prob argument), take eligible doses probability exceed 25% (column ewoc_ok).","code":"kable(summary(combo2_trial_start, \"dose_prediction\"), digits = 2)"},{"path":"http://opensource.nibr.com/OncoBayes2/articles/introduction.html","id":"posterior-accuracy-of-ewoc-estimation","dir":"Articles","previous_headings":"Example use-case: Dual combination trial with historical information","what":"Posterior accuracy of EWOC estimation","title":"Guiding Oncology Dose-Escalation Trials","text":"Since posterior represented large sample target density, estimate derived subject finite sampling error. sampling error determined posterior sample size quality used Markov chain Monte Carlo (MCMC). Hence, required ensure MCMC chains converged number samples representing posterior large enough estimate desired quantities interest sufficient accuracy. OncoBayes2 package automatically warns case non-convergence indicated Rhat diagnostic [5]. model parameters must Rhat less 1.11.1 (values much larger 1.01.0 indicate non-convergence). primary objective BLRM determine safe set doses via estimation EWOC, key quantities defining EWOC monitored convergence sufficient accuracy pre-defined dose well. diagnostics can obtained pre-defined set doses via ewoc_check summary routine : standard EWOC criterion, prob_overdose_est column contains 75% quantile posterior DLT probability, must smaller 33%. prob_overdose_stat column centered 33% standardized Monte-Carlo standard error (mcse). Therefore, negative values correspond safe doses since quantity approximately distributed standard normal random variate, statistic can compared quantiles standard normal distribution. OncoBayes2 warn imprecise EWOC estimate whenever statistic within range central 95% interval (−1.96,1.96)(-1.96,1.96). Whenever occurs can useful increase number iterations order decrease mcse, scales inverse square root MC ess. MC ess number independent samples posterior corresponds (recall MCMC results correlated samples). information please refer help summary.blrm_trial function (see help(\"blrm_trial\", help_type=\"summary\")). can see pre-defined doses trial EWOC decision can determined enough accuracy given statistic closest 00 −1.17-1.17.","code":"kable(summary(combo2_trial_start, \"ewoc_check\"), digits = 3) ## Warning: 1 out of 6 ewoc metrics are within the 95% MCMC error of the decision boundary. ## Be careful when using the imprecise ewoc estimates! It is recommended to run ## more iterations and review doses close to critical thresholds. ## You may call \"summary(trial, summarize='ewoc_check', ...)\" for more diagnostic details. ## Please call \"help('blrm_trial', help_type='summary')\" for further documentation."},{"path":"http://opensource.nibr.com/OncoBayes2/articles/introduction.html","id":"posterior-predictive-summaries","dir":"Articles","previous_headings":"Example use-case: Dual combination trial with historical information","what":"Posterior predictive summaries","title":"Guiding Oncology Dose-Escalation Trials","text":"BLRM allows principled approach predicting number DLTs may observed future cohort. may key estimand understanding limiting toxicity risk patients. example, suppose candidate starting dose new trial trial_AB 3 mg drug + 400 mg drug B. may wish check dose, predictive probability 2 DLTs initial cohort 3 6 patients sufficiently low. tells us initial cohort, according model, chance two patients developing DLTs ranges 8.7% 19.7%, depending number patients enrolled.","code":"candidate_starting_dose <- summary(combo2_trial_start, \"dose_info\") |>   filter(drug_A == 3, drug_B == 400) |>   crossing(num_toxicities = 0, num_patients = 3:6)  pp_summary <- summary(combo2_trial_start,   interval_prob = c(-1, 0, 1, 6), predictive = TRUE,   newdata = candidate_starting_dose )  kable(bind_cols(   select(candidate_starting_dose, num_patients),   select(pp_summary, ends_with(\"]\")) ), digits = 3)"},{"path":"http://opensource.nibr.com/OncoBayes2/articles/introduction.html","id":"updating-the-model-with-new-data","dir":"Articles","previous_headings":"Example use-case: Dual combination trial with historical information","what":"Updating the model with new data","title":"Guiding Oncology Dose-Escalation Trials","text":"Dose-escalation designs adaptive nature, dosing decisions made sequential cohort. model must updated accrued data dose escalation decision point. new cohort patients observed, say: One can update model incorporate new information using update() add_data equal new cohort: yields new blrm_trial object updated data posterior summaries. Obtaining summaries pre-planned provisional doses straightforward: case posterior summaries needed doses pre-planned ones, possible using newdata_prediction functionality, allows specify different set doses via newdata argument:","code":"new_cohort <- tibble(   group_id = \"trial_AB\",   drug_A = 3,   drug_B = 400,   num_patients = 5,   num_toxicities = 1 ) combo2_trial_update <- update(combo2_trial_start, add_data = new_cohort) ## Warning: 1 out of 6 ewoc metrics are within the 95% MCMC error of the decision boundary. ## Be careful when using the imprecise ewoc estimates! It is recommended to run ## more iterations and review doses close to critical thresholds. ## You may call \"summary(trial, summarize='ewoc_check', ...)\" for more diagnostic details. ## Please call \"help('blrm_trial', help_type='summary')\" for further documentation. kable(summary(combo2_trial_update, \"dose_prediction\"), digits = 2) kable(summary(combo2_trial_update, \"newdata_prediction\",   newdata = tibble(     group_id = \"trial_AB\",     drug_A = 4.5,     drug_B = c(400, 600, 800)   ) ), digits = 2) ## stratum_id not given, but only one stratum defined. Assigning first stratum."},{"path":"http://opensource.nibr.com/OncoBayes2/articles/introduction.html","id":"data-scenarios","dir":"Articles","previous_headings":"Example use-case: Dual combination trial with historical information","what":"Data scenarios","title":"Guiding Oncology Dose-Escalation Trials","text":"may interest test prospectively model responds various scenarios upcoming cohorts. can done easily using update() add_data argument. code , explore 3 possible outcomes subsequent cohort enrolled 3 mg drug + 800 mg drug B, review model’s inference adjacent doses. Model inference trial AB varying hypothetical DLT scenarios cohort size 3","code":"# set up two scenarios at the starting dose level # store them as data frames in a named list scenarios <- expand_grid(   group_id = \"trial_AB\",   drug_A = 3,   drug_B = 800,   num_patients = 3,   num_toxicities = 0:2 ) |>   split(1:3) |>   setNames(paste0(0:2, \"/3 DLTs\"))  candidate_doses <- expand_grid(   group_id = \"trial_AB\",   drug_A = c(3, 4.5),   drug_B = c(600, 800) )  scenario_inference <- lapply(scenarios, function(scenario_newdata) {   # refit the model with each scenario's additional data   scenario_fit <- update(combo2_trial_update, add_data = scenario_newdata)   # summarize posterior at candidate doses   summary(scenario_fit, \"newdata_prediction\", newdata = candidate_doses) }) |>   bind_rows(.id = \"Scenario\") ## Warning: There were 1 divergent transitions after warmup. See ## https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup ## to find out why this is a problem and how to eliminate them. ## Warning: Examine the pairs() plot to diagnose sampling problems ## Warning: 1 out of 6 ewoc metrics are within the 95% MCMC error of the decision boundary. ## Be careful when using the imprecise ewoc estimates! It is recommended to run ## more iterations and review doses close to critical thresholds. ## You may call \"summary(trial, summarize='ewoc_check', ...)\" for more diagnostic details. ## Please call \"help('blrm_trial', help_type='summary')\" for further documentation."},{"path":"http://opensource.nibr.com/OncoBayes2/articles/introduction.html","id":"continuation-of-example-using-concurrent-data","dir":"Articles","previous_headings":"","what":"Continuation of example: Using concurrent data","title":"Guiding Oncology Dose-Escalation Trials","text":"example [1], time completion first stage trial_AB, following additional data observed. data easily incorporated model using another call update, . However, first stage trial_AB, trial_A studying drug continue collected data drug dose-toxicity relationship: Wthin MAC framework may simply add concurrent data overall model yields refined predictions future cohorts. compare effect co-data case simplest visualize interval probabilities predicted model different data constellations. use function plot_toxicity_intervals_stacked explore dose-toxicity relationship continuous manner terms dose.   can observe, additional data drug moves maximal admissible dose allowed EWOC towards higher doses drug B whenever drug 6 mg. reflects drug observed relatively safe, since DLT observed number doses. example [1], conduct second stage trial_AB additional external data source new trial became available. time stemming another trial investigator-initiated trial IIT combination. Numerous toxicities observed concurrent study stage 2 trial_AB. , MAC framework, data can influence model summaries trial_AB. leave reader explore differences co-data (combined historical concurrent data) vs historical data approach. conclude present graphical summary dose-toxicity relationship dual combination trial final data constellation. Note use data option update ensure use entirely new dataset includes data collected; includes historical, trial concurrent data: final summary consider 75% quantile probability DLT dose combinations. Whenever 75% quantile exceeds 33%, EWOC criterion violated dose toxic.","code":"trial_AB_data <- filter(codata_combo2, group_id == \"trial_AB\", cohort_time == 1) kable(trial_AB_data) combo2_trial_histdata <- update(combo2_trial_start, add_data = trial_AB_data) trial_A_codata <- filter(codata_combo2, group_id == \"trial_A\", cohort_time == 1) kable(trial_A_codata) combo2_trial_codata <- update(combo2_trial_histdata, add_data = trial_A_codata) ## Warning in .blrm_trial_sanitize_data(trial = trial, data = args[[\"add_data\"]]): ## Data that was provided does not correspond to a pre-specified dose! plot_toxicity_intervals_stacked(combo2_trial_histdata,   newdata = mutate(dose_info, dose_id = NULL, stratum_id = \"all\"),   x = vars(drug_B),   group = vars(drug_A),   facet_args = list(ncol = 1) ) + ggtitle(\"Trial AB with historical data only\") plot_toxicity_intervals_stacked(combo2_trial_codata,   newdata = mutate(dose_info, dose_id = NULL, stratum_id = \"all\"),   x = vars(drug_B),   group = vars(drug_A),   facet_args = list(ncol = 1) ) + ggtitle(\"Trial AB with historical and concurrent data on drug A\") trial_AB_stage_2_codata <- filter(codata_combo2, cohort_time == 2) kable(trial_AB_stage_2_codata) combo2_trial_final <- update(combo2_trial_start, data = codata_combo2) ## Warning in .blrm_trial_sanitize_data(trial = trial, data = args[[\"data\"]]): ## Data that was provided does not correspond to a pre-specified dose! ## Warning: There were 2 divergent transitions after warmup. See ## https://mc-stan.org/misc/warnings.html#divergent-transitions-after-warmup ## to find out why this is a problem and how to eliminate them. ## Warning: Examine the pairs() plot to diagnose sampling problems grid_length <- 25  dose_info_plot_grid <- expand_grid(   stratum_id = \"all\",   group_id = \"trial_AB\",   drug_A = seq(min(dose_info_combo2$drug_A),                max(dose_info_combo2$drug_A),                length.out = grid_length),   drug_B = seq(min(dose_info_combo2$drug_B),                max(dose_info_combo2$drug_B),                length.out = grid_length) )   dose_info_plot_grid_sum <- summary(combo2_trial_final,   newdata = dose_info_plot_grid,   prob = 0.5 )  ggplot(dose_info_plot_grid_sum, aes(drug_A, drug_B, z = !!as.name(\"75%\"))) +   geom_contour_filled(breaks = c(0, 0.1, 0.16, 0.33, 1)) +   scale_fill_brewer(\"Quantile Range\", type = \"div\", palette = \"RdBu\", direction = -1) +   ggtitle(\"DLT Probability 75% Quantile\")"},{"path":"http://opensource.nibr.com/OncoBayes2/articles/introduction.html","id":"references","dir":"Articles","previous_headings":"","what":"References","title":"Guiding Oncology Dose-Escalation Trials","text":"[1] Neuenschwander, B., Roychoudhury, S., & Schmidli, H. (2016). use co-data clinical trials. Statistics Biopharmaceutical Research, 8(3), 345-354. [2] Neuenschwander, B., Wandel, S., Roychoudhury, S., & Bailey, S. (2016). Robust exchangeability designs early phase clinical trials multiple strata. Pharmaceutical statistics, 15(2), 123-134. [3] Neuenschwander, B., Branson, M., & Gsponer, T. (2008). Critical aspects Bayesian approach phase cancer trials. Statistics medicine, 27(13), 2420-2439. [4] Neuenschwander, B., Matano, ., Tang, Z., Roychoudhury, S., Wandel, S. Bailey, Stuart. (2014). Bayesian Industry Approach Phase Combination Trials Oncology. Statistical methods drug combination studies (Vol. 69). CRC Press. [5] Vehtari, ., Gelman, ., Simpson, D., Carpenter, B., Bürkner, P. C. (2021). Rank-Normalization, Folding, Localization: Improved (R̂\\hat{R}) Assessing Convergence MCMC, Bayesian Analysis, 16 (2), 667–718. https://doi.org/10.1214/20-BA1221","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/articles/introduction.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Guiding Oncology Dose-Escalation Trials","text":"","code":"sessionInfo() ## R version 4.5.1 (2025-06-13) ## Platform: x86_64-pc-linux-gnu ## Running under: Ubuntu 24.04.3 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 ##  ## locale: ##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        ##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    ##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           ## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    ##  ## time zone: UTC ## tzcode source: system (glibc) ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] tibble_3.3.0     ggplot2_4.0.0    knitr_1.50       tidyr_1.3.1      ## [5] dplyr_1.1.4      posterior_1.6.1  OncoBayes2_0.9-4 RBesT_1.8-2      ##  ## loaded via a namespace (and not attached): ##  [1] tensorA_0.36.2.1      sass_0.4.10           generics_0.1.4        ##  [4] digest_0.6.37         magrittr_2.0.4        evaluate_1.0.5        ##  [7] grid_4.5.1            RColorBrewer_1.1-3    mvtnorm_1.3-3         ## [10] fastmap_1.2.0         jsonlite_2.0.0        pkgbuild_1.4.8        ## [13] backports_1.5.0       Formula_1.2-5         gridExtra_2.3         ## [16] purrr_1.1.0           QuickJSR_1.8.1        scales_1.4.0          ## [19] isoband_0.2.7         codetools_0.2-20      textshaping_1.0.4     ## [22] jquerylib_0.1.4       abind_1.4-8           cli_3.6.5             ## [25] rlang_1.1.6           withr_3.0.2           cachem_1.1.0          ## [28] yaml_2.3.10           StanHeaders_2.32.10   parallel_4.5.1        ## [31] tools_4.5.1           rstan_2.32.7          inline_0.3.21         ## [34] rstantools_2.5.0      checkmate_2.3.3       assertthat_0.2.1      ## [37] vctrs_0.6.5           R6_2.6.1              matrixStats_1.5.0     ## [40] stats4_4.5.1          lifecycle_1.0.4       fs_1.6.6              ## [43] ragg_1.5.0            pkgconfig_2.0.3       desc_1.4.3            ## [46] pkgdown_2.1.3         RcppParallel_5.1.11-1 pillar_1.11.1         ## [49] bslib_0.9.0           gtable_0.3.6          loo_2.8.0             ## [52] glue_1.8.0            Rcpp_1.1.0            systemfonts_1.3.1     ## [55] xfun_0.53             tidyselect_1.2.1      bayesplot_1.14.0      ## [58] farver_2.1.2          htmltools_0.5.8.1     labeling_0.4.3        ## [61] rmarkdown_2.30        compiler_4.5.1        S7_0.2.0              ## [64] distributional_0.5.0"},{"path":"http://opensource.nibr.com/OncoBayes2/articles/map_approach.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Meta-Analytic-Predictive (MAP) approach for dose-toxicity modelling","text":"common characteristic modern applications Bayesian Logistic Regression Model (BLRM) model-based dose escalation availability relevant historical data study treatment(s). example, studies testing novel combination therapies may wish incorporate available dose-toxicity data individual agents single-agent dose escalation trials. two broad categories statistical approaches : Meta-Analytic Combined (MAC) approaches use hierarchical model jointly analyze historical data data current study. External data concurrently running trials may also incorporated approach. introductory vignette illustrates approach. Meta-Analytic Predictive (MAP) approaches involve two stages. first, initial hierarchical model estimated historical data, model one extracts posterior prediction trial-level parameters future trial. posterior prediction approximated parametric form used MAP prior future trial. two approaches statistically equivalent (provided parametric representation MAP prior exact), differ “modelling workflow.” MAC approach prospective approach enabling include even concurrent data borrow , MAP approach retrospective historical data summarized usually taken immutable static. MAP approach advantage designing prospectively future study can pre-specify (hence document statistical analysis plan) information borrowed historical data model used future study becomes structurally simpler, since often need hierarchical model structure stage. recommended reference details approaches, relate , applied dose-toxicity setting explained Neuenschwander et al (2016). vignette, illustrate implementation MAP approach, describe usage safety monitoring realistic application. Initial R session setup:","code":"library(OncoBayes2) library(RBesT) library(posterior) library(ggplot2) library(dplyr) library(tidyr) library(knitr)"},{"path":"http://opensource.nibr.com/OncoBayes2/articles/map_approach.html","id":"application-background","dir":"Articles","previous_headings":"","what":"Application background","title":"Meta-Analytic-Predictive (MAP) approach for dose-toxicity modelling","text":"consider case study involving Phase-dose-escalation study combination therapy two compounds, drug drug B, population adult patients solid-tumor cancers. primary objective study identify Maximum Tolerated Dose (MTD) Recommended Phase-2 Dose (RP2D) combination.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/articles/map_approach.html","id":"historical-data","dir":"Articles","previous_headings":"Application background","what":"Historical data","title":"Meta-Analytic-Predictive (MAP) approach for dose-toxicity modelling","text":"application, two compounds previously tested single-agent Phase-dose escalation studies. MTDs declared drug: declarations made basis following dose-toxicity data two single-agent studies. Historical data single-agent study Drug Historical data single-agent study Drug B data understood highly relevant informing prior beliefs single-agent contributions combination toxicity planned study. Therefore MAP approach taken develop priors respective parameters - αA\\alpha_A, βA\\beta_A, αB\\alpha_B, βB\\beta_B obtained meta-analysis historical data.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/articles/map_approach.html","id":"derivation-of-map-priors","dir":"Articles","previous_headings":"","what":"Derivation of MAP priors","title":"Meta-Analytic-Predictive (MAP) approach for dose-toxicity modelling","text":"MAP approach, begin meta-analytic hierarchical modelling historical data, accounting possibility -trial heterogeneity. important note done even case single historical study available. information -trial heterogeneity relies case priors used heterogeneity. practice log normal priors heterogeneity parameters based following table worked well many situations. approach categorize degree heterogeneity trials terms anticipated differences population factors depend specific case: Heterogeneity categorization intercept α\\alpha slope β\\beta fit separate models historical drug-drug-B single-agent data. Note, equivalently, single hierarchical double-combination model without interaction fit data, produced MAP priors drug-level intercepts slopes. detailed specification models fit given appendix. example assume historical data drug comes relatively different population (example different line therapy) historical data drug B stems closely related patient population. translates respective choices -trial heterogeneity priors according table .","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/articles/map_approach.html","id":"drug-a-model","dir":"Articles","previous_headings":"Derivation of MAP priors","what":"Drug A model","title":"Meta-Analytic-Predictive (MAP) approach for dose-toxicity modelling","text":"Implementation meta-analysis single-agent data done using blrm_exnex(). order obtain directly sample MAP prior, set sample_map argument TRUE.","code":"# historical data for drug A hist_A <- data.frame(   group_id = factor(\"trial_A\"),   drug_A = c(12.5, 25, 50, 80, 100, 150),   num_patients = c(1, 1, 3, 9, 23, 3),   num_toxicities = c(0, 0, 0, 1, 4, 2) )  # reference dose for drug A dref_A <- 80  # bivariate normal prior for (intercept, log-slope)  prior_A <- mixmvnorm(c(1.0,                        logit(0.2), 0,                        diag(c(1, (log(4) / 1.96)^2 ))))  # between-trial heterogeneity is centered on \"substantial\" tau_substantial_prior <- mixmvnorm(c(1.0,                                      log(c(0.5, 0.25)),                                      diag(rep(log(2) / 1.96, 2)^2)))  # fit the model to the historical data map_model_A <- blrm_exnex(   cbind(num_toxicities, num_patients - num_toxicities) ~      1 + log(drug_A / dref_A) |      0 |      group_id,   data = hist_A,   prior_EX_mu_comp = list(prior_A),   prior_EX_tau_comp = tau_substantial_prior,   prior_EX_prob_comp = matrix(1, nrow = 1, ncol = 1),   prior_tau_dist = 1,   sample_map = TRUE )"},{"path":"http://opensource.nibr.com/OncoBayes2/articles/map_approach.html","id":"drug-b-model","dir":"Articles","previous_headings":"Derivation of MAP priors","what":"Drug B model","title":"Meta-Analytic-Predictive (MAP) approach for dose-toxicity modelling","text":"Similarly, drug B:","code":"# historical data for drug B hist_B <- data.frame(   group_id = factor(\"trial_B\"),   drug_B = c(0.125, 0.25, 0.5, 1, 2, 2.5, 3, 4),   num_patients = c(2, 1, 2, 2, 3, 7, 12, 3),   num_toxicities = c(0, 0, 0, 0, 1, 0, 0, 1) )  # reference dose dref_B <- 1  # prior for (intercept, log-slope) prior_B <- prior_A  # between-trial heterogeneity is centered on \"small\", but with a # greater degree of uncertainty on this classification tau_small_prior <- mixmvnorm(c(1.0,                                log(c(0.125, 0.0625)),                                diag(rep(log(4) / 1.96, 2)^2)))  # fit model to historical data map_model_B <- blrm_exnex(   cbind(num_toxicities, num_patients - num_toxicities) ~      1 + log(drug_B / dref_B) |      0 |      group_id,   data = hist_B,   prior_EX_mu_comp = list(prior_B),   prior_EX_tau_comp = tau_small_prior,   prior_EX_prob_comp = matrix(1, nrow = 1, ncol = 1),   prior_tau_dist = 1,   sample_map = TRUE )"},{"path":"http://opensource.nibr.com/OncoBayes2/articles/map_approach.html","id":"extraction-of-map-priors","dir":"Articles","previous_headings":"Derivation of MAP priors","what":"Extraction of MAP priors","title":"Meta-Analytic-Predictive (MAP) approach for dose-toxicity modelling","text":"now illustrate meta-analytic model fits can used produce parametric MAP prior new study intercepts slopes.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/articles/map_approach.html","id":"mcmc-samples","dir":"Articles","previous_headings":"Derivation of MAP priors > Extraction of MAP priors","what":"MCMC samples","title":"Meta-Analytic-Predictive (MAP) approach for dose-toxicity modelling","text":"Since called blrm_exnex sample_map=TRUE argument, posterior now contains respective MAP prior MCMC samples \"map_log_beta\" containing defined stratum (just one case) MAP priors MCMC form intercept slope. extract rvar variables simplifies working posterior draws. posteriors 3-dimensional arrays dimensions stratum, drug component coefficient. discussed example single stratum single drug component (per fitted model) present directly select respective entries array (note may use names access respective entries array):","code":"rvar_map_log_beta_A <- as_draws_rvars(map_model_A, variable=\"map_log_beta\")$map_log_beta rvar_map_log_beta_B <- as_draws_rvars(map_model_B, variable=\"map_log_beta\")$map_log_beta rvar_map_log_beta_A[1,\"log(drug_A/dref_A)\",,drop=TRUE] ## rvar<500,4>[2] mean ± sd: ##     intercept     log_slope  ## -1.73 ± 0.82   0.34 ± 0.72 rvar_map_log_beta_B[1,\"log(drug_B/dref_B)\",,drop=TRUE] ## rvar<500,4>[2] mean ± sd: ##     intercept     log_slope  ## -2.74 ± 0.62  -0.45 ± 0.53"},{"path":"http://opensource.nibr.com/OncoBayes2/articles/map_approach.html","id":"mixture-approximation","dir":"Articles","previous_headings":"Derivation of MAP priors > Extraction of MAP priors","what":"Mixture approximation","title":"Meta-Analytic-Predictive (MAP) approach for dose-toxicity modelling","text":"order leverage MAP distributions analyzing new combination study data, need operationalize parametric prior distributions combination model. done approximating finite mixtures multivariate normal distributions, handled RBesT function automixfit(). automixfit() function expects posterior samples matrix form convert draws accordingly: appropriateness parametric approximation MCMC sample can visually inspected using plot function RBesT:","code":"map_mix_A <- automixfit(draws_of(rvar_map_log_beta_A[1,\"log(drug_A/dref_A)\",,drop=TRUE]),                         type = \"mvnorm\") map_mix_A ## EM for Multivariate Normal Mixture Model ## Log-Likelihood = -4557.01 ##  ## Multivariate normal mixture ## Outcome dimension: 2 ## Mixture Components: ##                          comp1       comp2       ## w                         0.56206771  0.43793229 ## m[intercept]             -1.88227571 -1.52601780 ## m[log_slope]              0.59136954  0.01259954 ## s[intercept]              0.68030368  0.92524450 ## s[log_slope]              0.59829373  0.73241598 ## rho[log_slope,intercept] -0.29870546  0.12832698 map_mix_B <- automixfit(draws_of(rvar_map_log_beta_B[1,\"log(drug_B/dref_B)\",,drop=TRUE]),                         type = \"mvnorm\") map_mix_B ## EM for Multivariate Normal Mixture Model ## Log-Likelihood = -3252.692 ##  ## Multivariate normal mixture ## Outcome dimension: 2 ## Mixture Components: ##                          comp1       comp2       comp3       ## w                         0.37748737  0.37130812  0.25120451 ## m[intercept]             -2.62052660 -2.62077157 -3.09269497 ## m[log_slope]             -0.36785969 -0.78173676 -0.08761646 ## s[intercept]              0.42385373  0.66468212  0.66682656 ## s[log_slope]              0.40861667  0.51156577  0.40148441 ## rho[log_slope,intercept] -0.39229212 -0.05739021 -0.50121005 plot(map_mix_A)$mixpairs ## Diagnostic plots for mixture multivariate normal densities are experimental. ## Please note that these are subject to changes in future releases. # plot(map_mix_B)$mixpairs  # respective plot for drug B"},{"path":"http://opensource.nibr.com/OncoBayes2/articles/map_approach.html","id":"combination-model-with-map-priors-for-the-new-study","dir":"Articles","previous_headings":"","what":"Combination model with MAP priors for the new study","title":"Meta-Analytic-Predictive (MAP) approach for dose-toxicity modelling","text":"Finally, mixtures become prior distributions combination dose-toxicity model new study. combination model now need longer hierarchical model structure turn part model setting tau_prior_dist=NULL. Note merely setups model use known heterogeneities τ\\tau fixed zero mean, subsequent output display. detailed description model found appendix. defines prior distribution dose-toxicity relationship novel combination. can visualize prior distributions DLT rates:  also now understanding combination doses may high risk DLTs terms posterior mean, Posterior summary statistics P(DLT) dose posterior predictive distribution assuming specific cohort size (6 used example ): Posterior predictive summary Pr(DLT) dose One can see combination one decrease starting doses well declared MTDs drug. consequence combination new trial -trial heterogeneity leads increased uncertainty dose-toxicity. uncertainty additionally increased introduction possible interaction two drugs. increased uncertainty dose-toxicity curve, escalation overdose criterion EWOC automatically penalizes lack knowledge requires conservative starting dose escalation.","code":"# one row of dummy data with number of patients set to zero in order # to allow the model to be fit dummy_data_AB <- data.frame(   group_id = factor(\"trial_AB\", levels = c(\"trial_AB\")),   drug_A = 1,   drug_B = 1,   num_patients = 0,   num_toxicities = 0 )  interaction_prior <- mixmvnorm(c(1, 0, (log(9)/1.96)^2))  # fit a double-combination model using the MAP priors map_combo <- blrm_exnex(   cbind(num_toxicities, num_patients - num_toxicities) ~     1 + I(log(drug_A / dref_A)) |     1 + I(log(drug_B / dref_B)) |     0 + I(2 * (drug_A/dref_A * drug_B/dref_B) / (1 + drug_A/dref_A * drug_B/dref_B)) |     group_id,   data = dummy_data_AB,   prior_EX_mu_comp = list(map_mix_A, map_mix_B), # BVN mixtures for (log-alpha, log-beta) for drugs A and B   prior_EX_mu_inter = interaction_prior,      # shut off hierarchical part of model --   prior_tau_dist = NULL ) doses <- expand_grid(   group_id = \"trial_AB\",   drug_A = c(25, 50, 80, 100),   drug_B = c(0.5, 1, 3) ) %>%   arrange(drug_B, drug_A)  plot_toxicity_curve(map_combo,                     newdata = doses,                     x = vars(drug_A),                     group = ~ drug_B)  +   theme(legend.position=\"bottom\") ## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0. ## ℹ Please use `linewidth` instead. ## ℹ The deprecated feature was likely used in the OncoBayes2 package. ##   Please report the issue at <https://github.com/Novartis/OncoBayes2/issues>. ## This warning is displayed once every 8 hours. ## Call `lifecycle::last_lifecycle_warnings()` to see where this warning was ## generated. map_summ <- summary(map_combo, newdata = doses, interval_prob = c(0, 0.16, 0.33, 1)) kable(   cbind(doses[c(\"drug_A\", \"drug_B\")], map_summ[c(\"mean\", \"sd\", \"(0.33,1]\")]),   col.names = c(\"Drug A\", \"Drug B\", \"mean\", \"sd\", \"P(DLT rate > 0.33)\"),   digits = 2,   caption = \"Posterior summary statistics for P(DLT) by dose\" ) map_pred_summ <- summary(map_combo,                          newdata = mutate(doses, num_toxicities=0, num_patients=6),                          predictive=TRUE, interval_prob = c(-1, 0, 1, 6)) kable(   cbind(doses[c(\"drug_A\", \"drug_B\")], map_pred_summ[c(\"(-1,0]\", \"(0,1]\", \"(1,6]\")]),   col.names = c(\"Drug A\", \"Drug B\", \"Pr(0 of 6 DLT)\", \"Pr(1 of 6 DLT)\", \"Pr(>=2 of 6 DLT)\"),   digits = 2,   caption = \"Posterior predictive summary for Pr(DLT) by dose\" )"},{"path":"http://opensource.nibr.com/OncoBayes2/articles/map_approach.html","id":"robustification","dir":"Articles","previous_headings":"Combination model with MAP priors for the new study","what":"Robustification","title":"Meta-Analytic-Predictive (MAP) approach for dose-toxicity modelling","text":"Direct use MAP priors assumes ex-changeability historical new trial data. However, assumption can violated may wish robustify analysis. can achieved complementing MAP prior weakly informative mixture component non-zero weight. hierarchical model -weights historical data already, admit interchangeability differences trials, adding way additional weakly informative mixture component leads even greater robustness prior-data conflict. process sometimes referred “robustification”, resulting prior known robust MAP (rMAP) prior. robustification step conceptually equivalent use EXNEX model MAC approach. However, two techniques - robustification EXNEX - differ robustification step done derivation MAP prior EXNEX model joint model fit. robust MAP approach implemented :","code":"# weakly-informative mixture component is chosen here to be equal to # the priors used in the first place weak_A <- prior_A weak_B <- prior_B  # adding this to the drug-A and drug-B MAP priors with weight 0.1 mix_A_robust <- mixcombine(map_mix_A, weak_A, weight = c(0.9, 0.1)) mix_B_robust <- mixcombine(map_mix_B, weak_B, weight = c(0.9, 0.1))  # robust MAP priors mix_robust <- list(mix_A_robust, mix_B_robust)  # fit a double-combination model using the rMAP priors robust_map_combo <- update(map_combo, prior_EX_mu_comp = mix_robust) # disabled plot here plot_toxicity_curve(robust_map_combo,                     newdata = doses,                     x = vars(drug_A),                     group = ~ drug_B)  +   theme(legend.position=\"bottom\")"},{"path":"http://opensource.nibr.com/OncoBayes2/articles/map_approach.html","id":"equivalence-of-map-and-mac-advanced","dir":"Articles","previous_headings":"","what":"Equivalence of MAP and MAC (advanced)","title":"Meta-Analytic-Predictive (MAP) approach for dose-toxicity modelling","text":"demonstrate equivalence MAP MAC, illustrate implementation latter approach. First, combine data three sources. Next, jointly model available data using hierarchical double-combination BLRM, whose detailed specification can found appendix. Note hierarchical model interaction parameter present combination model. turned assign negligibly small mean value τ\\tau interaction heterogeneity. Now compare posterior inference DLT rates: Posterior summary statistics P(DLT) dose","code":"groups <- c(\"trial_A\", \"trial_B\", \"trial_AB\") mac_data <- bind_rows_0(hist_A, hist_B) mac_data$group_id <- factor(as.character(mac_data$group_id), levels = groups) dummy_tau_inter <- mixmvnorm(c(1.0, log(1E-4), (log(2) / 1.96)^2))  num_comp   <- 2 # number of treatment components num_inter  <- 1 num_groups <- length(groups)  mac_combo <- blrm_exnex(   cbind(num_toxicities, num_patients - num_toxicities) ~     1 + I(log(drug_A / dref_A)) |     1 + I(log(drug_B / dref_B)) |     0 + I(2 * (drug_A/dref_A * drug_B/dref_B) / (1 + drug_A/dref_A * drug_B/dref_B)) |     group_id,   data = mac_data,   prior_EX_mu_comp = list(prior_A, prior_B),   prior_EX_tau_comp = list(tau_substantial_prior, tau_small_prior),   prior_EX_mu_inter = interaction_prior,   prior_EX_tau_inter = dummy_tau_inter,   prior_is_EXNEX_comp = rep(FALSE, num_comp),   prior_is_EXNEX_inter = rep(FALSE, num_inter),   prior_EX_prob_comp = matrix(1, nrow = num_groups, ncol = num_comp),   prior_EX_prob_inter = matrix(1, nrow = num_groups, ncol = num_inter),   prior_tau_dist = 1 ) ## Info: The group(s) trial_AB have undefined strata. Assigning first stratum 1. mac_summ <- summary(mac_combo, newdata = doses, interval_prob = c(0, 0.16, 0.33, 1)) kable(   cbind(doses[c(\"drug_A\", \"drug_B\")],         map_summ$mean, mac_summ$mean,         abs(map_summ$mean - mac_summ$mean),         map_summ[[\"(0.33,1]\"]], mac_summ[[\"(0.33,1]\"]]),   col.names = c(\"Drug A\", \"Drug B\",                 \"MAP mean\", \"MAC mean\",                 \"|MAP mean - MAC mean|\",                 \"MAP P(DLT rate > 0.33)\", \"MAC P(DLT rate > 0.33)\"),   digits = 2,   caption = \"Posterior summary statistics for P(DLT) by dose\" )"},{"path":[]},{"path":"http://opensource.nibr.com/OncoBayes2/articles/map_approach.html","id":"combination-blrm-new-study-model","dir":"Articles","previous_headings":"Appendix: Model specification","what":"Combination BLRM (new study model)","title":"Meta-Analytic-Predictive (MAP) approach for dose-toxicity modelling","text":"Let dAd_A dBd_B represent doses drugs B, respectively. dose-toxicity model combination expresses DLT probability πAB(dA,dB)\\pi_{AB}(d_A, d_B) function doses, following model DLT odds πAB(dA,dB)1−πAB(dA,dB)=π⊥(dA,dB)1−π⊥(dA,dB)⋅exp{2η(dAdB)/(dA*dB*)1+(dAdB)/(dA*dB*)}. \\frac{\\pi_{AB}(d_A, d_B)}{1 - \\pi_{AB}(d_A, d_B)} = \\frac{\\pi_\\perp(d_A, d_B)}{1 - \\pi_\\perp(d_A, d_B)} \\cdot \\exp\\left\\{ 2 \\eta \\frac{(d_A d_B) / (d_A^* d_B^*) }{1 + (d_A d_B) / (d_A^* d_B^*)}\\right\\}. two terms right-hand side , respectively, odds DLT assumed independence action two drugs, .e. π⊥(dA,dB)=1−(1−πA(dA))(1−πB(dB))\\pi_\\perp(d_A, d_B) = 1 - (1 - \\pi_A(d_A))(1 - \\pi_B(d_B)) interaction term allows modelling drug toxicity interactions. See Widmer et al (2023) discussion interaction model. terms πA(dA)\\pi_A(d_A) πB(dB)\\pi_B(d_B) represent toxicity risk single-agent, respectively, modelled logistic regression Neuenschwander et al (2008): πA(dA)=log(αA)+βAlog(dA/dA*)\\pi_A(d_A) = \\log(\\alpha_A) + \\beta_A \\log(d_A / d_A^*) πB(dB)=log(αB)+βBlog(dB/dB*)\\pi_B(d_B) = \\log(\\alpha_B) + \\beta_B \\log(d_B / d_B^*) model parameters hence αA,βA,αB\\alpha_A, \\beta_A, \\alpha_B βB\\beta_B (intercepts slopes determining dose-toxicity curve two single agents), η\\eta (controlling magnitude drug toxicity interactions), dA*d_A^* dB*d_B^* fixed pre-specified reference doses drug. parametrization convenient many situations, relevant information available inform prior distributions intercepts slopes. Specifically, example, used MAP priors based analysis historical data meta-analytic models.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/articles/map_approach.html","id":"prior-specification","dir":"Articles","previous_headings":"Appendix: Model specification > Combination BLRM (new study model)","what":"Prior specification","title":"Meta-Analytic-Predictive (MAP) approach for dose-toxicity modelling","text":"intercepts slopes, MAP priors form (logαA,logβA)∼∑k=1KAwAkBVN(𝐦Ak,𝐒Ak), (\\log \\alpha_A, \\log \\beta_A ) \\sim \\sum_{k = 1}^{K_A} w_{Ak} \\mbox{BVN}( \\mathbf m_{Ak}, \\mathbf S_{Ak} ), (logαB,logβB)∼∑k=1KBwBkBVN(𝐦Bk,𝐒Bk), (\\log \\alpha_B, \\log \\beta_B ) \\sim \\sum_{k = 1}^{K_B} w_{Bk} \\mbox{BVN}( \\mathbf m_{Bk}, \\mathbf S_{Bk} ), bivariate normal mixtures chosen approximate MAP distribution, .e. interaction, prior distribution η∼N(0,(log(9)/1.96)2)\\eta \\sim \\mbox{N}(0, (\\log(9)/1.96)^2) used. prior centered zero interaction, 95% probability mass falls DLT odds multipliers 1/91/9 99 (relative -interaction model).","code":"map_mix_A ## EM for Multivariate Normal Mixture Model ## Log-Likelihood = -4557.01 ##  ## Multivariate normal mixture ## Outcome dimension: 2 ## Mixture Components: ##                          comp1       comp2       ## w                         0.56206771  0.43793229 ## m[intercept]             -1.88227571 -1.52601780 ## m[log_slope]              0.59136954  0.01259954 ## s[intercept]              0.68030368  0.92524450 ## s[log_slope]              0.59829373  0.73241598 ## rho[log_slope,intercept] -0.29870546  0.12832698 map_mix_B ## EM for Multivariate Normal Mixture Model ## Log-Likelihood = -3252.692 ##  ## Multivariate normal mixture ## Outcome dimension: 2 ## Mixture Components: ##                          comp1       comp2       comp3       ## w                         0.37748737  0.37130812  0.25120451 ## m[intercept]             -2.62052660 -2.62077157 -3.09269497 ## m[log_slope]             -0.36785969 -0.78173676 -0.08761646 ## s[intercept]              0.42385373  0.66468212  0.66682656 ## s[log_slope]              0.40861667  0.51156577  0.40148441 ## rho[log_slope,intercept] -0.39229212 -0.05739021 -0.50121005"},{"path":"http://opensource.nibr.com/OncoBayes2/articles/map_approach.html","id":"meta-analytic-models-for-the-historical-data","dir":"Articles","previous_headings":"Appendix: Model specification","what":"Meta-analytic models for the historical data","title":"Meta-Analytic-Predictive (MAP) approach for dose-toxicity modelling","text":"MAP approach begins hierarchical meta-analytic modelling historical data, allowing possibility -study heterogeneity. describe model drug (drug B analogous). historical studies h=1,…,Hh =1 ,\\ldots, H (case H=1H=1), DLT probability dose dAd_A modelled πAh(dA)=logαAh+βAhlog(dA/dA*). \\pi_{Ah}(d_A) = \\log \\alpha_{Ah} + \\beta_{Ah} \\log(d_A / d_A^*). Model parameters assumed exchangeable across studies: (logαAh,logβAh)∼BVN((μαA,μβA),𝚺A)h=1,…,H, (\\log \\alpha_{Ah}, \\log \\beta_{Ah})  \\, \\, \\sim \\, \\, \\mbox{BVN}\\bigl( (\\mu_{\\alpha }, \\mu_{\\beta }), \\boldsymbol \\Sigma_A \\bigr) \\hspace{20pt} \\text{}h = 1,\\ldots, H, facilitate prediction dose-toxicity curve new study, additionally assume study-level parameters new study exchangeable historical studies: (logαA⋆,logβA⋆)∼BVN((μαA,μβA),𝚺A). (\\log \\alpha_{\\star}, \\log \\beta_{\\star}) \\, \\, \\sim \\, \\, \\mbox{BVN}\\bigl( (\\mu_{\\alpha }, \\mu_{\\beta }), \\boldsymbol \\Sigma_A \\bigr). , 𝚺A\\boldsymbol \\Sigma_A 2×22 \\times 2 covariance matrix standard deviations ταA\\tau_{\\alpha } τβA\\tau_{\\beta }, correlation ρA\\rho_A. exchangeability assumption allows posterior estimation MAP distribution study-level parameters new study, given historical data: f(αA⋆,βA⋆|𝐱hist)=∫f(αA⋆,βA⋆|μαA,μβA,ταA,τβA,ρ)dF(μαA,μβA,ταA,τβA|𝐱hist). f(\\alpha_{\\star}, \\beta_{\\star} | \\mathbf x_{\\text{hist}}) = \\int f(\\alpha_{\\star}, \\beta_{\\star} | \\mu_{\\alpha }, \\mu_{\\beta }, \\tau_{\\alpha }, \\tau_{\\beta }, \\rho) \\, \\, dF(\\mu_{\\alpha }, \\mu_{\\beta }, \\tau_{\\alpha }, \\tau_{\\beta } | \\mathbf x_{\\text{hist}}). model completed normal priors means μαA∼N(mαA,sαA2) \\mu_{\\alpha } \\sim \\mbox{N} ( m_{\\alpha }, s^2_{\\alpha }) μβA∼N(mβA,sβA2) \\mu_{\\beta } \\sim \\mbox{N} ( m_{\\beta }, s^2_{\\beta }) lognormal priors standard deviations, logταA∼N(mταA,sταA2) \\log \\tau_{\\alpha } \\sim \\mbox{N}( m_{\\tau \\alpha }, s^2_{\\tau \\alpha }) logτβA∼N(mτβA,sτβA2) \\log \\tau_{\\beta } \\sim \\mbox{N}( m_{\\tau \\beta }, s^2_{\\tau \\beta }) correlation, ρA∼U(−1,1). \\rho_A \\sim \\mbox{U}(-1, 1).","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/articles/map_approach.html","id":"prior-specification-1","dir":"Articles","previous_headings":"Appendix: Model specification > Meta-analytic models for the historical data","what":"Prior specification","title":"Meta-Analytic-Predictive (MAP) approach for dose-toxicity modelling","text":"models, drugs B, used set hyper-parameters: Intercept mean standard deviation: mαA=mαB=logit(0.2)m_{\\alpha } = m_{\\alpha B} = \\mbox{logit}(0.2)sαA=sαB=1s_{\\alpha } = s_{\\alpha B} = 1 Slope mean standard deviation: mβA=mβB=log(1)m_{\\beta } = m_{\\beta B} = \\log(1)sβA=sβB=(log4)/1.96s_{\\beta } = s_{\\beta B} = (\\log 4) / 1.96 Heterogeneity standard deviations: mταA=mταB=log(0.25)m_{\\tau \\alpha } = m_{\\tau \\alpha B} = \\log(0.25)mτβA=mτβB=log(0.125)m_{\\tau \\beta } = m_{\\tau \\beta B} = \\log(0.125)sταA=sτβA=sταB=sτβB=(log2)/1.96s_{\\tau \\alpha } = s_{\\tau \\beta } = s_{\\tau \\alpha B} = s_{\\tau \\beta B} = (\\log 2) / 1.96","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/articles/map_approach.html","id":"hierarchical-model-for-combined-data-mac","dir":"Articles","previous_headings":"Appendix: Model specification","what":"Hierarchical model for combined data (MAC)","title":"Meta-Analytic-Predictive (MAP) approach for dose-toxicity modelling","text":"MAC model combined model data sources (single-agent trials planned combination study). Letting ii index sources, model covers toxicity combination doses two agents: πi(dA,dB)1−πi(dA,dB)=π⊥,(dA,dB)1−π⊥,(dA,dB)⋅exp{2ηi(dAdB)/(dA*dB*)1+(dAdB)/(dA*dB*)}. \\frac{\\pi_i(d_A, d_B)}{1 - \\pi_i(d_A, d_B)} = \\frac{\\pi_{\\perp, }(d_A, d_B)}{1 - \\pi_{\\perp, }(d_A, d_B)} \\cdot \\exp\\left\\{ 2 \\eta_i \\frac{(d_A d_B) / (d_A^* d_B^*) }{1 + (d_A d_B) / (d_A^* d_B^*)}\\right\\}.  , π⊥,(dA,dB)=1−(1−πAi(dA))(1−πBi(dB))\\pi_{\\perp,}(d_A, d_B) = 1 - (1 - \\pi_{Ai}(d_A))(1 - \\pi_{Bi}(d_B)) πAi(dA)=log(αAi)+βAilog(dA/dA*) \\pi_{Ai}(d_A) = \\log(\\alpha_{Ai}) + \\beta_{Ai} \\log(d_A / d_A^*)πBi(dB)=log(αBi)+βBilog(dB/dB*) \\pi_{Bi}(d_B) = \\log(\\alpha_{Bi}) + \\beta_{Bi} \\log(d_B / d_B^*) , ex-changeability assumptions facilitate information borrowing across data sources. (logαAi,logβAi)∼BVN((μαA,μβA),𝚺A)=1,…,(\\log \\alpha_{Ai}, \\log \\beta_{Ai})  \\, \\, \\sim \\, \\, \\mbox{BVN}\\bigl( (\\mu_{\\alpha }, \\mu_{\\beta }), \\boldsymbol \\Sigma_A \\bigr) \\hspace{20pt} \\text{}= 1,\\ldots, (logαBi,logβBi)∼BVN((μαB,μβB),𝚺B)=1,…,(\\log \\alpha_{Bi}, \\log \\beta_{Bi})  \\, \\, \\sim \\, \\, \\mbox{BVN}\\bigl( (\\mu_{\\alpha B}, \\mu_{\\beta B}), \\boldsymbol \\Sigma_B \\bigr) \\hspace{20pt} \\text{}= 1,\\ldots,  ηi∼N(μη,τη2). \\eta_i \\sim \\mbox{N}(\\mu_\\eta, \\tau^2_\\eta). Priors exchangeable means μ\\mu variances τ\\tau identical meta-analytic models historical single-agent data previous section.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/articles/map_approach.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session Info","title":"Meta-Analytic-Predictive (MAP) approach for dose-toxicity modelling","text":"","code":"sessionInfo() ## R version 4.5.1 (2025-06-13) ## Platform: x86_64-pc-linux-gnu ## Running under: Ubuntu 24.04.3 LTS ##  ## Matrix products: default ## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  ## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 ##  ## locale: ##  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        ##  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    ##  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           ## [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    ##  ## time zone: UTC ## tzcode source: system (glibc) ##  ## attached base packages: ## [1] stats     graphics  grDevices utils     datasets  methods   base      ##  ## other attached packages: ## [1] ggplot2_4.0.0    knitr_1.50       tidyr_1.3.1      dplyr_1.1.4      ## [5] posterior_1.6.1  OncoBayes2_0.9-4 RBesT_1.8-2      ##  ## loaded via a namespace (and not attached): ##  [1] gtable_0.3.6          tensorA_0.36.2.1      xfun_0.53             ##  [4] bslib_0.9.0           QuickJSR_1.8.1        inline_0.3.21         ##  [7] vctrs_0.6.5           tools_4.5.1           generics_0.1.4        ## [10] stats4_4.5.1          parallel_4.5.1        tibble_3.3.0          ## [13] pkgconfig_2.0.3       checkmate_2.3.3       RColorBrewer_1.1-3    ## [16] S7_0.2.0              desc_1.4.3            distributional_0.5.0  ## [19] RcppParallel_5.1.11-1 assertthat_0.2.1      lifecycle_1.0.4       ## [22] compiler_4.5.1        farver_2.1.2          stringr_1.5.2         ## [25] textshaping_1.0.4     codetools_0.2-20      htmltools_0.5.8.1     ## [28] sass_0.4.10           bayesplot_1.14.0      yaml_2.3.10           ## [31] Formula_1.2-5         crayon_1.5.3          pillar_1.11.1         ## [34] pkgdown_2.1.3         jquerylib_0.1.4       cachem_1.1.0          ## [37] StanHeaders_2.32.10   abind_1.4-8           rstan_2.32.7          ## [40] tidyselect_1.2.1      digest_0.6.37         mvtnorm_1.3-3         ## [43] stringi_1.8.7         reshape2_1.4.4        purrr_1.1.0           ## [46] labeling_0.4.3        fastmap_1.2.0         grid_4.5.1            ## [49] cli_3.6.5             magrittr_2.0.4        loo_2.8.0             ## [52] pkgbuild_1.4.8        withr_3.0.2           scales_1.4.0          ## [55] backports_1.5.0       rmarkdown_2.30        matrixStats_1.5.0     ## [58] gridExtra_2.3         ragg_1.5.0            evaluate_1.0.5        ## [61] rstantools_2.5.0      rlang_1.1.6           isoband_0.2.7         ## [64] Rcpp_1.1.0            glue_1.8.0            jsonlite_2.0.0        ## [67] R6_2.6.1              plyr_1.8.9            systemfonts_1.3.1     ## [70] fs_1.6.6"},{"path":"http://opensource.nibr.com/OncoBayes2/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Novartis Pharma AG. Copyright holder. Sebastian Weber. Author, maintainer. Lukas . Widmer. Author. Andrew Bean. Author. Trustees Columbia University. Copyright holder.           R/stanmodels.R, configure, configure.win","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Weber S, Widmer L, Bean (2025). OncoBayes2: Bayesian Logistic Regression Oncology Dose-Escalation Trials. R package version 0.9-4, https://opensource.nibr.com/OncoBayes2/.","code":"@Manual{,   title = {OncoBayes2: Bayesian Logistic Regression for Oncology Dose-Escalation Trials},   author = {Sebastian Weber and Lukas A. Widmer and Andrew Bean},   year = {2025},   note = {R package version 0.9-4},   url = {https://opensource.nibr.com/OncoBayes2/}, }"},{"path":"http://opensource.nibr.com/OncoBayes2/index.html","id":"oncobayes2","dir":"","previous_headings":"","what":"Bayesian Logistic Regression for Oncology Dose-Escalation Trials","title":"Bayesian Logistic Regression for Oncology Dose-Escalation Trials","text":"Bayesian logistic regression model optional EXchangeability-NonEXchangeability parameter modelling flexible borrowing historical concurrent data-sources. safety model can guide dose-escalation decisions adaptive Oncology phase dose-escalation trials involve arbitrary number drugs.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/index.html","id":"getting-started","dir":"","previous_headings":"","what":"Getting Started","title":"Bayesian Logistic Regression for Oncology Dose-Escalation Trials","text":"get quick overview package functionality, please refer introductory vignette.","code":"[![Codecov test coverage](https://codecov.io/gh/weberse2/OncoBayes2/graph/badge.svg)](https://app.codecov.io/gh/weberse2/OncoBayes2)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/OncoBayes2.html","id":null,"dir":"Reference","previous_headings":"","what":"OncoBayes2 — OncoBayes2","title":"OncoBayes2 — OncoBayes2","text":"Bayesian logistic regression model optional EXchangeability-NonEXchangeability parameter modelling flexible borrowing historical concurrent data-sources. safety model can guide dose-escalation decisions adaptive Oncology phase dose-escalation trials involve arbitrary number drugs.","code":""},{"path":[]},{"path":"http://opensource.nibr.com/OncoBayes2/reference/OncoBayes2.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"OncoBayes2 — OncoBayes2","text":"Neuenschwander, B., Roychoudhury, S., & Schmidli, H. (2016). use co-data clinical trials. Statistics Biopharmaceutical Research, 8(3), 345-354. Neuenschwander, B., Wandel, S., Roychoudhury, S., & Bailey, S. (2016). Robust exchangeability designs early phase clinical trials multiple strata. Pharmaceutical statistics, 15(2), 123-134. Neuenschwander, B., Branson, M., & Gsponer, T. (2008). Critical aspects Bayesian approach phase cancer trials. Statistics medicine, 27(13), 2420-2439. Neuenschwander, B., Matano, ., Tang, Z., Roychoudhury, S., Wandel, S. Bailey, Stuart. (2014). Bayesian Industry Approach Phase Combination Trials Oncology. Statistical methods drug combination studies (Vol. 69). CRC Press. Stan Development Team (2024). RStan: R interface Stan. R package version 2.32.6. https://mc-stan.org","code":""},{"path":[]},{"path":"http://opensource.nibr.com/OncoBayes2/reference/OncoBayes2.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"OncoBayes2 — OncoBayes2","text":"Maintainer: Sebastian Weber sebastian.weber@novartis.com Authors: Lukas . Widmer lukas_andreas.widmer@novartis.com Andrew Bean andrew.bean@novartis.com contributors: Novartis Pharma AG [copyright holder] Trustees Columbia University (R/stanmodels.R, configure, configure.win) [copyright holder]","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/bind_rows_0.html","id":null,"dir":"Reference","previous_headings":"","what":"Bind rows of multiple data frames with zero fill — bind_rows_0","title":"Bind rows of multiple data frames with zero fill — bind_rows_0","text":"version bind_rows dplyr fills non-common columns zeroes instead NA. Gives error input data contains NA already.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/bind_rows_0.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bind rows of multiple data frames with zero fill — bind_rows_0","text":"","code":"bind_rows_0(...)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/bind_rows_0.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bind rows of multiple data frames with zero fill — bind_rows_0","text":"... Data frames combine, passed bind_rows (see dplyr documentation)","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/bind_rows_0.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bind rows of multiple data frames with zero fill — bind_rows_0","text":"","code":"## Setting up dummy sampling for fast execution of example ## Please use 4 chains and 100x more warmup & iter in practice .user_mc_options <- options(   OncoBayes2.MC.warmup = 10, OncoBayes2.MC.iter = 20, OncoBayes2.MC.chains = 1,   OncoBayes2.MC.save_warmup = FALSE )  library(tibble)  dose_info_A <- tibble(   group_id = \"hist_A\",   drug_A = 1 )  dose_info_B <- tibble(   group_id = \"hist_B\",   drug_B = 100 * (1:2) )  bind_rows_0(dose_info_A, dose_info_B) #> # A tibble: 3 × 3 #>   group_id drug_A drug_B #>   <chr>     <dbl>  <dbl> #> 1 hist_A        1      0 #> 2 hist_B        0    100 #> 3 hist_B        0    200  ## Recover user set sampling defaults options(.user_mc_options)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_exnex.html","id":null,"dir":"Reference","previous_headings":"","what":"Bayesian Logistic Regression Model for N-compounds with EXNEX — blrm_exnex","title":"Bayesian Logistic Regression Model for N-compounds with EXNEX — blrm_exnex","text":"Bayesian Logistic Regression Model (BLRM) N compounds using EXchangability NonEXchangability (EXNEX) modeling.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_exnex.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bayesian Logistic Regression Model for N-compounds with EXNEX — blrm_exnex","text":"","code":"blrm_exnex(   formula,   data,   prior_EX_mu_comp,   prior_EX_mu_mean_comp,   prior_EX_mu_sd_comp,   prior_EX_tau_comp,   prior_EX_tau_mean_comp,   prior_EX_tau_sd_comp,   prior_EX_corr_eta_comp,   prior_EX_mu_inter,   prior_EX_mu_mean_inter,   prior_EX_mu_sd_inter,   prior_EX_tau_inter,   prior_EX_tau_mean_inter,   prior_EX_tau_sd_inter,   prior_EX_corr_eta_inter,   prior_is_EXNEX_inter,   prior_is_EXNEX_comp,   prior_EX_prob_comp,   prior_EX_prob_inter,   prior_NEX_mu_comp,   prior_NEX_mu_mean_comp,   prior_NEX_mu_sd_comp,   prior_NEX_mu_inter,   prior_NEX_mu_mean_inter,   prior_NEX_mu_sd_inter,   prior_tau_dist,   sample_map = FALSE,   iter = getOption(\"OncoBayes2.MC.iter\", 2000),   warmup = getOption(\"OncoBayes2.MC.warmup\", 1000),   save_warmup = getOption(\"OncoBayes2.MC.save_warmup\", TRUE),   thin = getOption(\"OncoBayes2.MC.thin\", 1),   init = getOption(\"OncoBayes2.MC.init\", 0.5),   chains = getOption(\"OncoBayes2.MC.chains\", 4),   cores = getOption(\"mc.cores\", 1L),   control = getOption(\"OncoBayes2.MC.control\", list()),   backend = getOption(\"OncoBayes2.MC.backend\", \"rstan\"),   prior_PD = FALSE,   verbose = FALSE )  # S3 method for class 'blrmfit' print(x, ..., prob = 0.95, digits = 2)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_exnex.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Bayesian Logistic Regression Model for N-compounds with EXNEX — blrm_exnex","text":"formula model formula describing linear predictors model. lhs formula two-column matrix number occured events number times event occured. rhs formula defines linear predictors marginal models drug component, interaction model last grouping optional stratum factors models. elements formula separated vertical bar. marginal models must follow intercept slope form interaction model must include interaction term. See examples example instantiation. data optional data frame containing variables model. found data, variables taken environment(formula). prior_EX_mu_comp List bivariate normal mixture priors intercept slope parameters \\(\\boldsymbol\\mu_i =   (\\mu_{\\alpha }, \\mu_{\\beta })\\) component. case single drug model, mixture prior accepted well. prior_EX_mu_mean_comp, prior_EX_mu_sd_comp  Please use prior_EX_mu_comp instead. Mean sd prior mean parameters \\(\\boldsymbol\\mu_i = (\\mu_{\\alpha }, \\mu_{\\beta })\\) component.  Two column matrix (intercept, log-slope) one row per component. prior_EX_tau_comp List bivariate normal mixture priors heterogeniety parameter \\(\\boldsymbol\\tau_{si} =   (\\tau_{\\alpha s }, \\tau_{\\beta s })\\) stratum. differential discounting required (.e. one stratum \\(s = 1\\)), suffices provide bivariate normal mixture prior instead list just one element. prior_EX_tau_mean_comp, prior_EX_tau_sd_comp  Please use prior_EX_tau_comp instead. Prior mean sd heterogeniety parameter \\(\\boldsymbol\\tau_{si} = (\\tau_{\\alpha s }, \\tau_{\\beta s   })\\) stratum. differential discounting required (.e. one stratum \\(s = 1\\)), two-column matrix (intercept, log-slope) one row per component. Otherwise three-dimensional array whose first dimension indexes strata, second dimension indexes components, third dimension length two (intercept, log-slope). prior_EX_corr_eta_comp Prior LKJ correlation parameter component given numeric vector. missing, 1 assumed corresponding marginal uniform prior correlation. prior_EX_mu_inter Multivariate normal mixture prior interaction parameter vector \\(\\boldsymbol{\\mu_{\\eta}}\\). Dimension must correspond number interactions. prior_EX_mu_mean_inter, prior_EX_mu_sd_inter  Please use prior_EX_mu_inter instead. Prior mean sd population mean parameters \\(\\mu_{\\eta k}\\) interaction parameter. Vector length equal number interactions. prior_EX_tau_inter List multivariate normal mixture priors heterogeniety interaction parameter vector \\(\\boldsymbol{\\tau_{\\eta s}}\\) stratum. differential discounting required (.e. one stratum \\(s = 1\\)), suffices provide mixture prior instead list just one element. prior_EX_tau_mean_inter, prior_EX_tau_sd_inter  Please use prior_EX_tau_inter instead. Prior mean sd heterogeniety parameter \\(\\tau_{\\eta s k}\\) stratum. Matrix one column per interaction one row per stratum. prior_EX_corr_eta_inter Prior LKJ correlation parameter interaction given numeric. missing, 1 assumed corresponding marginal uniform prior correlations. prior_is_EXNEX_inter Defines non-exchangability admitted given interaction parameter. Logical vector length equal number interactions. missing FALSE assumed interactions. prior_is_EXNEX_comp Defines non-exchangability admitted given component. Logical vector length equal number components. missing TRUE assumed components. prior_EX_prob_comp Prior probability \\(p_{ij}\\) exchangability component per group. Matrix one column per component one row per group. Values must lie \\([0-1]\\) range. prior_EX_prob_inter Prior probability \\(p_{\\eta k j}\\) exchangability interaction per group. Matrix one column per interaction one row per group. Values must lie \\([0-1]\\) range. prior_NEX_mu_comp List bivariate normal mixture priors \\(\\boldsymbol m_{ij}\\) \\(\\boldsymbol s_{ij} =   \\text{diag}(\\boldsymbol S_{ij})\\) component non-exchangable case. missing set prior given EX part. required specification across groups j. prior_NEX_mu_mean_comp, prior_NEX_mu_sd_comp  Please use prior_NEX_mu_comp instead. Prior mean \\(\\boldsymbol m_{ij}\\) sd \\(\\boldsymbol s_{ij} = \\text{diag}(\\boldsymbol S_{ij})\\) component non-exchangable case. Two column matrix (intercept, log-slope) one row per component. missing set prior given EX part. required specification across groups j. prior_NEX_mu_inter Multivariate normal mixture prior (mean \\(m_{\\eta k j}\\), sd \\(s_{\\eta k j}\\) covariance) interaction parameter vector non-exchangable case. Dimension must correspond number interactions. missing set prior given EX part. prior_NEX_mu_mean_inter, prior_NEX_mu_sd_inter  Please use prior_NEX_mu_inter instead. Prior mean \\(m_{\\eta k j}\\) sd \\(s_{\\eta k j}\\) interaction parameter non-exchangable case. Vector length equal number interactions. missing set prior given EX part. prior_tau_dist Defines distribution used heterogeniety parameters. Choices 0=fixed mean, 1=log-normal, 2=truncated normal NULL shutting hierarchical structure model. sample_map Logical flag (defaults FALSE) controlling inclusion MAP priors stratum defined part generated posterior. set TRUE posterior samples contain map_log_beta map_eta variables. iter number iterations (including warmup). warmup number warmup iterations. save_warmup save warmup samples (TRUE / FALSE). set TRUE, random variables saved posterior. substantially increases storage needs posterior. thin period saving samples. init positive number specify uniform range unconstrained space random initialization. See stan. chains number Markov chains. cores number cores parallel sampling chains. control additional sampler parameters NuTS algorithm. backend sets Stan backend used. Possible choices \"rstan\" (default) \"cmdstanr\". prior_PD Logical flag (defaults FALSE) indicating sample prior predictive distribution instead conditioning data. verbose Logical flag (defaults FALSE) controlling additional output like stan progress reported. x blrmfit object print ... used function prob central probability mass report, .e. quantiles 0.5-prob/2 0.5+prob/2 displayed. Multiple central widths can specified. digits number digits show","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_exnex.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Bayesian Logistic Regression Model for N-compounds with EXNEX — blrm_exnex","text":"function returns S3 object type blrmfit.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_exnex.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Bayesian Logistic Regression Model for N-compounds with EXNEX — blrm_exnex","text":"blrm_exnex flexible function Bayesian meta-analytic modeling binomial count data. particular, designed model counts number observed dose limiting toxicities (DLTs) dose, guiding dose-escalation studies Oncology. accommodate dose escalation one agent, dose may consist combinations study drugs, number treatment components. simplest case, aim model probability \\(\\pi\\) patient experiences DLT, complementing binomial likelihood monotone logistic regression $$\\text{logit}\\,\\pi(d) = \\log\\,\\alpha + \\beta \\, t(d),$$ \\(\\beta > 0\\). typically, \\(d\\) represents dose, \\(t(d)\\) appropriate transformation, \\(t(d) = \\log (d \\big / d^*)\\). joint prior \\(\\boldsymbol \\theta = (\\log\\,\\alpha, \\log\\,\\beta)\\) completes model ensures monotonicity \\(\\beta > 0\\). Many extensions possible. function supports general combination regimens, also provides framework Bayesian meta-analysis dose-toxicity data multiple historical concurrent sources. example single-agent trial refer example-single-agent().","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_exnex.html","id":"functions","dir":"Reference","previous_headings":"","what":"Functions","title":"Bayesian Logistic Regression Model for N-compounds with EXNEX — blrm_exnex","text":"print(blrmfit): print function.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_exnex.html","id":"combination-of-two-treatments","dir":"Reference","previous_headings":"","what":"Combination of two treatments","title":"Bayesian Logistic Regression Model for N-compounds with EXNEX — blrm_exnex","text":"combination two treatment components, basic modeling framework DLT rate \\(\\pi(d_1,d_2)\\) comprised (1) \"-interaction\" baseline model \\(\\tilde \\pi(d_1,d_2)\\) driven single-agent toxicity component, (2) optional interaction terms \\(\\gamma(d_1,d_2)\\) representing synergy antagonism drugs. log-odds scale, $$\\text{logit} \\,\\pi(d_1,d_2) = \\text{logit} \\, \\tilde \\pi(d_1,d_2) + \\eta \\, \\gamma(d_1,d_2). $$ \"interaction\" part \\(\\tilde \\pi(d_1,d_2)\\) represents probability DLT triggered either treatment component acting independently. , $$ \\tilde \\pi(d_1,d_2) = 1- (1 - \\pi_1(d_1))(1 - \\pi_2(d_2)). $$ simple terms, P(DLT combination) = P(DLT drug 1) * P(DLT drug 2). complete part, treatment components can modeled monotone logistic regressions . $$\\text{logit} \\, \\pi_i(d_i) = \\log\\, \\alpha_i + \\beta_i \\, t(d_i),$$ \\(t(d_i)\\) monotone transformation doses respective drug component $$, \\(t(d_i) = \\log (d_i \\big / d_i^*)\\). inclusion interaction term \\(\\gamma(d_1,d_2)\\) allows DLT rates \"-interaction\" rate. magnitude interaction term may also made dependent doses (covariates) regression. example, one let $$\\gamma(d_1, d_2) = \\frac{d_1}{d_1^*} \\frac{d_1}{d_2^*}.$$ specific functional form specified usual notation design matrix. interaction model must respect constraint whenever dose approaches zero, interaction term must vanish well. Therefore, interaction model must include intercept term violate consistency requirement. dual combination example can found example-combo2().","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_exnex.html","id":"general-combinations","dir":"Reference","previous_headings":"","what":"General combinations","title":"Bayesian Logistic Regression Model for N-compounds with EXNEX — blrm_exnex","text":"model extended general combination treatments consisting \\(N\\) components expressing probability \\(\\pi\\) logit scale $$ \\text{logit} \\, \\pi(d_1,\\ldots,d_N) = \\text{logit} \\Bigl( 1 - \\prod_{= 1}^N ( 1 - \\pi_i(d_i) ) \\Bigr) + \\sum_{k=1}^K \\eta_k \\, \\gamma_k(d_1,\\ldots,d_N), $$ Multiple drug-drug interactions among \\(N\\) components now possible, represented \\(K\\) interaction terms \\(\\gamma_k\\). Regression models can specified \\(\\pi_i\\) \\(\\gamma_k\\), $$ \\text{logit}\\, \\pi_i(d_i) = \\log\\, \\alpha_i + \\beta_i \\, t(d_i) $$ Interactions subset \\((k) \\subset \\{1,\\ldots,N \\}\\) treatment components can modeled regression well, example products doses, $$ \\gamma_k(d_1,\\ldots,d_N) = \\prod_{\\(k)} \\frac{d_i}{d_i^*}.$$ example, \\((k) = \\{1,2,3\\}\\) results three-way interaction term $$ \\frac{d_1}{d_1^*} \\frac{d_2}{d_2^*} \\frac{d_3}{d_3^*} $$ drugs 1, 2, 3. triple combination example please refer example-combo3().","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_exnex.html","id":"meta-analytic-framework","dir":"Reference","previous_headings":"","what":"Meta-analytic framework","title":"Bayesian Logistic Regression Model for N-compounds with EXNEX — blrm_exnex","text":"Information toxicity drug may available multiple studies sources. Furthermore, one may wish stratify observations within single study (example groups patients corresponding different geographic regions, multiple dosing dose_info corresponding different schedules). blrm_exnex provides tools robust Bayesian hierarchical modeling jointly model data multiple sources. additional index \\(j=1, \\ldots, J\\) parameters observations denotes \\(J\\) groups. resulting model allows DLT rate differ across groups. general \\(N\\)-component model becomes $$ \\text{logit} \\, \\pi_j(d_1,\\ldots,d_N) = \\text{logit} \\Bigl( 1 - \\prod_{= 1}^N ( 1 - \\pi_{ij}(d_i) ) \\Bigr) + \\sum_{k=1}^K \\eta_{kj} \\, \\gamma_{k}(d_1,\\ldots,d_N), $$ groups \\(j = 1,\\ldots,J\\). component toxicities \\(\\pi_{ij}\\) interaction terms \\(\\gamma_{k}\\) modelled, , regression. example, \\(\\pi_{ij}\\) logistic regression \\(t(d_i) = \\log(d_i/d_i^*)\\) intercept log-slope \\(\\boldsymbol \\theta_{ij}\\), \\(\\gamma_{k}\\) regressed coefficient \\(\\eta_{kj}\\) product \\(\\prod_{\\(k)} (d_i/d_i^*)\\) subset \\((k)\\) components. Thus, \\(j=1,\\ldots,J\\), now group-specific parameters \\(\\boldsymbol\\theta_{ij} = (\\log\\, \\alpha_{ij}, \\log\\, \\beta_{ij})\\) \\(\\boldsymbol\\nu_{j} = (\\eta_{1j}, \\ldots, \\eta_{Kj})\\) component \\(=1,\\ldots,N\\) interaction \\(k=1,\\ldots,K\\). structure prior \\((\\boldsymbol\\theta_{i1},\\ldots,\\boldsymbol\\theta_{iJ})\\) \\((\\boldsymbol\\nu_{1}, \\ldots, \\boldsymbol\\nu_{J})\\) determines much information shared across groups \\(j\\). Several modeling choices available function. EX (Full exchangeability): One can assume parameters conditionally exchangeable given hyperparameters $$\\boldsymbol \\theta_{ij} \\sim \\text{N}\\bigl( \\boldsymbol \\mu_{\\boldsymbol \\theta }, \\boldsymbol \\Sigma_{\\boldsymbol \\theta } \\bigr), $$ independently across groups \\(j = 1,\\ldots, J\\) treatment components \\(=1,\\ldots,N\\). covariance matrix \\(\\boldsymbol \\Sigma_{\\boldsymbol \\theta }\\) captures patterns cross-group heterogeneity, parametrized standard deviations \\(\\boldsymbol \\tau_{\\boldsymbol\\theta } = (\\tau_{\\alpha }, \\tau_{\\beta })\\) correlation \\(\\rho_i\\). Similarly interactions, fully-exchangeable model $$\\boldsymbol \\nu_{j} \\sim \\text{N}\\bigl( \\boldsymbol \\mu_{\\boldsymbol \\nu}, \\boldsymbol \\Sigma_{\\boldsymbol \\nu} \\bigr)$$ groups \\(j = 1,\\ldots, J\\) interactions \\(k=1,\\ldots,K\\), prior covariance matrix \\(\\boldsymbol \\Sigma_{\\boldsymbol \\nu}\\) captures amount heterogeneity expected interaction terms -priori. covariance parametrized standard deviations \\((\\tau_{\\eta 1}, \\ldots, \\tau_{\\eta K})\\) correlation matrix. Differential discounting: one groups \\(j=1,\\ldots,J\\), larger deviations \\(\\boldsymbol\\theta_{ij}\\) may expected mean \\(\\boldsymbol\\mu_i\\), interactions \\(\\eta_{kj}\\) mean \\(\\mu_{\\eta,k}\\). differential heterogeneity can modeled mapping groups \\(j = 1,\\ldots,J\\) strata \\(s_j \\\\{1,\\ldots,S\\}\\), modifying model specification $$\\boldsymbol \\theta_{ij} \\sim \\text{N}\\bigl( \\boldsymbol \\mu_{\\boldsymbol \\theta }, \\boldsymbol \\Sigma_{\\boldsymbol \\theta ij} \\bigr), $$ $$\\boldsymbol \\Sigma_{\\boldsymbol \\theta ij} = \\left( \\begin{array}{cc} \\tau^2_{\\alpha s_j } & \\rho_i \\tau_{\\alpha s_j } \\tau_{\\beta s_j }\\\\ \\rho_i \\tau_{\\alpha s_j } \\tau_{\\beta s_j } & \\tau^2_{\\beta s_j } \\end{array} \\right).$$ interactions, model becomes $$\\boldsymbol \\nu_{j} \\sim \\text{N}\\bigl( \\boldsymbol \\mu_{\\boldsymbol \\nu}, \\boldsymbol \\Sigma_{\\boldsymbol \\nu j} \\bigr),$$ covariance matrix \\(\\boldsymbol \\Sigma_{\\boldsymbol \\nu j}\\) modelled stratum specific standard deviations \\((\\tau_{\\eta 1 s_j}, \\ldots, \\tau_{\\eta K s_j})\\) stratum independent correlation matrix. stratum \\(s=1,\\ldots,S\\) corresponds set standard deviations \\(\\tau\\) leading different discounting per stratum. Independent priors specified component parameters \\(\\tau_{\\alpha s }\\) \\(\\tau_{\\beta s }\\) interaction parameters \\(\\tau_{\\eta s k}\\) stratum \\(s=1,\\ldots,S\\). Inference strata \\(s\\) prior centered larger values \\(\\tau\\) parameters exhibit less shrinkage towards means, \\(\\boldsymbol\\mu_{\\boldsymbol \\theta }\\) \\(\\boldsymbol \\mu_{\\boldsymbol \\nu}\\) respectively. EXNEX (Partial exchangeability): Another mechansim increasing robustness introduce mixture priors group-specific parameters, one mixture component shared across groups, group-specific. result, known EXchangeable-NonEXchangeable (EXNEX) type prior, form $$\\boldsymbol \\theta_{ij} \\sim p_{\\boldsymbol \\theta ij}\\, \\text{N}\\bigl( \\boldsymbol \\mu_{\\boldsymbol \\theta }, \\boldsymbol \\Sigma_{\\boldsymbol \\theta } \\bigr) +(1-p_{\\boldsymbol \\theta ij})\\, \\text{N}\\bigl(\\boldsymbol m_{\\boldsymbol \\theta ij}, \\boldsymbol S_{\\boldsymbol \\theta ij}\\bigr)$$ applied treatment-component parameters, $$\\boldsymbol \\nu_{kj} \\sim p_{\\boldsymbol \\nu_{kj}} \\,\\text{N}\\bigl(\\mu_{\\boldsymbol \\nu}, \\boldsymbol \\Sigma_{\\boldsymbol \\nu}\\bigr)_k + (1-p_{\\boldsymbol \\nu_{kj}})\\, \\text{N}(m_{\\boldsymbol \\nu_{kj}}, s^2_{\\boldsymbol \\nu_{kj}})$$ applied interaction parameters. exchangeability weights \\(p_{\\boldsymbol \\theta ij}\\) \\(p_{\\boldsymbol \\nu_{kj}}\\) fixed constants interval \\([0,1]\\) control degree inference group \\(j\\) informed exchangeable mixture components. Larger values weights correspond greater exchange information, smaller values increase robustness case outlying observations individual groups \\(j\\).","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_exnex.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Bayesian Logistic Regression Model for N-compounds with EXNEX — blrm_exnex","text":"Neuenschwander, B., Roychoudhury, S., & Schmidli, H. (2016). use co-data clinical trials. Statistics Biopharmaceutical Research, 8(3), 345-354. Neuenschwander, B., Wandel, S., Roychoudhury, S., & Bailey, S. (2016). Robust exchangeability designs early phase clinical trials multiple strata. Pharmaceutical statistics, 15(2), 123-134. Neuenschwander, B., Branson, M., & Gsponer, T. (2008). Critical aspects Bayesian approach phase cancer trials. Statistics medicine, 27(13), 2420-2439. Neuenschwander, B., Matano, ., Tang, Z., Roychoudhury, S., Wandel, S. Bailey, Stuart. (2014). Bayesian Industry Approach Phase Combination Trials Oncology. Statistical methods drug combination studies (Vol. 69). CRC Press.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_exnex.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Bayesian Logistic Regression Model for N-compounds with EXNEX — blrm_exnex","text":"","code":"## Setting up dummy sampling for fast execution of example ## Please use 4 chains and 100x more warmup & iter in practice .user_mc_options <- options(   OncoBayes2.MC.warmup = 10, OncoBayes2.MC.iter = 20, OncoBayes2.MC.chains = 1,   OncoBayes2.MC.save_warmup = FALSE )  # fit an example model. See documentation for \"combo3\" example example_model(\"combo3\") #> Running combo3 example: #>  ## example combo3 #>  #>  library(abind) #>  #>  dref <- c(500, 500, 1000) #>  num_comp <- 3 #>  num_inter <- choose(3, 2) + 1 #>  num_strata <- nlevels(hist_combo3$stratum_id) #>  num_groups <- nlevels(hist_combo3$group_id) #>  #>  blrmfit <- blrm_exnex( #>    cbind(num_toxicities, num_patients - num_toxicities) ~ #>      1 + I(log(drug_A / dref[1])) | #>        1 + I(log(drug_B / dref[2])) | #>        1 + I(log(drug_C / dref[3])) | #>        0 #>        + I(drug_A / dref[1] * drug_B / dref[2]) #>          + I(drug_A / dref[1] * drug_C / dref[3]) #>          + I(drug_B / dref[2] * drug_C / dref[3]) #>          + I(drug_A / dref[1] * drug_B / dref[2] * drug_C / dref[3]) | #>        stratum_id / group_id, #>    data = hist_combo3, #>    prior_EX_mu_comp = replicate(num_comp, mixmvnorm(c(1, logit(1/3), 0, diag(c(2^2, 1)))), FALSE), #>    prior_EX_tau_comp = list(replicate(num_comp, #>                                       mixmvnorm(c(1, log(c(0.25, 0.125)), #>                                                 diag(c(log(4)/1.96, log(4)/1.96)^2))), FALSE), #>                             replicate(num_comp, #>                                       mixmvnorm(c(1, log(2 * c(0.25, 0.125)), #>                                                 diag(c(log(4)/1.96, log(4)/1.96)^2))), FALSE)), #>    prior_EX_mu_inter = mixmvnorm(c(1, rep.int(0, num_inter), #>                                       diag((rep.int(sqrt(2) / 2, num_inter))^2))), #>    prior_EX_tau_inter = replicate(num_strata, #>                                   mixmvnorm(c(1, rep.int(log(0.25), num_inter), #>                                               diag((rep.int(log(2) / 1.96, num_inter))^2))), FALSE), #>    prior_EX_prob_comp = matrix(0.9, nrow = num_groups, ncol = num_comp), #>    prior_EX_prob_inter = matrix(1.0, nrow = num_groups, ncol = num_inter), #>    prior_is_EXNEX_comp = rep(TRUE, num_comp), #>    prior_is_EXNEX_inter = rep(FALSE, num_inter), #>    prior_tau_dist = 1, #>    prior_PD = FALSE #>  ) #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess  # print a summary of the prior prior_summary(blrmfit, digits = 3) #> Bayesian Logistic Regression Model with EXchangeability-NonEXchangeability #>  #> Mixture configuration #> --------------------- #> EXNEX components : 3  #> component #> I(log(drug_A/dref[1])) I(log(drug_B/dref[2])) I(log(drug_C/dref[3]))  #>                      1                      1                      1  #>  #> EXNEX interactions: 0  #> interaction #>                  I(drug_A/dref[1] * drug_B/dref[2])  #>                                                   0  #>                  I(drug_A/dref[1] * drug_C/dref[3])  #>                                                   0  #>                  I(drug_B/dref[2] * drug_C/dref[3])  #>                                                   0  #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])  #>                                                   0  #>  #> Prior probability for exchangeability per group #>             component #> group        I(log(drug_A/dref[1])) I(log(drug_B/dref[2])) #>   Combo                         0.9                    0.9 #>   HistAgent1                    0.9                    0.9 #>   HistAgent2                    0.9                    0.9 #>             component #> group        I(log(drug_C/dref[3])) #>   Combo                         0.9 #>   HistAgent1                    0.9 #>   HistAgent2                    0.9 #>  #>             interaction #> group        I(drug_A/dref[1] * drug_B/dref[2]) #>   Combo                                       1 #>   HistAgent1                                  1 #>   HistAgent2                                  1 #>             interaction #> group        I(drug_A/dref[1] * drug_C/dref[3]) #>   Combo                                       1 #>   HistAgent1                                  1 #>   HistAgent2                                  1 #>             interaction #> group        I(drug_B/dref[2] * drug_C/dref[3]) #>   Combo                                       1 #>   HistAgent1                                  1 #>   HistAgent2                                  1 #>             interaction #> group        I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]) #>   Combo                                                        1 #>   HistAgent1                                                   1 #>   HistAgent2                                                   1 #>  #> EXchangable hyperparameter priors #> --------------------------------- #> Component parameters #> Mean mu_log_beta #>                               prior weight m_intercept m_log_slope s_intercept s_log_slope    rho #> component              mix                                                                        #> I(log(drug_A/dref[1])) comp_1        1.000      -0.693       0.000       2.000       1.000  0.000 #> I(log(drug_B/dref[2])) comp_1        1.000      -0.693       0.000       2.000       1.000  0.000 #> I(log(drug_C/dref[3])) comp_1        1.000      -0.693       0.000       2.000       1.000  0.000 #>  #> Heterogeneity tau_log_beta (log-normal) #>                                         prior weight m_tau_intercept m_tau_log_slope s_tau_intercept s_tau_log_slope    rho #> stratum   component              mix                                                                                        #> stratum_1 I(log(drug_A/dref[1])) comp_1        1.000          -1.386          -2.079           0.707           0.707  0.000 #>           I(log(drug_B/dref[2])) comp_1        1.000          -1.386          -2.079           0.707           0.707  0.000 #>           I(log(drug_C/dref[3])) comp_1        1.000          -1.386          -2.079           0.707           0.707  0.000 #> stratum_2 I(log(drug_A/dref[1])) comp_1        1.000          -0.693          -1.386           0.707           0.707  0.000 #>           I(log(drug_B/dref[2])) comp_1        1.000          -0.693          -1.386           0.707           0.707  0.000 #>           I(log(drug_C/dref[3])) comp_1        1.000          -0.693          -1.386           0.707           0.707  0.000 #>  #> Correlation LKJ #> component #> I(log(drug_A/dref[1])) I(log(drug_B/dref[2])) I(log(drug_C/dref[3]))  #>                      1                      1                      1  #>  #> Interaction parameters #> Mean mu_eta #>       prior     w  m[1]  m[2]  m[3]  m[4]  s[1]  s[2]  s[3]  s[4] rho[2,1] rho[3,1] rho[4,1] rho[3,2] rho[4,2] rho[4,3] #> mix                                                                                                                     #> comp1       1.000 0.000 0.000 0.000 0.000 0.707 0.707 0.707 0.707    0.000    0.000    0.000    0.000    0.000    0.000 #>  #> Heterogeneity tau_eta (log-normal) #>                 prior      w   m[1]   m[2]   m[3]   m[4]   s[1]   s[2]   s[3]   s[4] rho[2,1] rho[3,1] rho[4,1] rho[3,2] rho[4,2] rho[4,3] #> stratum   mix                                                                                                                              #> stratum_1 comp1        1.000 -1.386 -1.386 -1.386 -1.386  0.354  0.354  0.354  0.354    0.000    0.000    0.000    0.000    0.000    0.000 #> stratum_2 comp1        1.000 -1.386 -1.386 -1.386 -1.386  0.354  0.354  0.354  0.354    0.000    0.000    0.000    0.000    0.000    0.000 #>  #> Correlation LKJ #> interaction  #>           1  #>  #> NonEXchangable priors #> --------------------- #> Component parameters #> Mean mu_log_beta #>                               prior weight m_intercept m_log_slope s_intercept s_log_slope    rho #> component              mix                                                                        #> I(log(drug_A/dref[1])) comp_1        1.000      -0.693       0.000       2.000       1.000  0.000 #> I(log(drug_B/dref[2])) comp_1        1.000      -0.693       0.000       2.000       1.000  0.000 #> I(log(drug_C/dref[3])) comp_1        1.000      -0.693       0.000       2.000       1.000  0.000 #>  #> Interaction parameters #> Mean mu_eta #>       prior     w  m[1]  m[2]  m[3]  m[4]  s[1]  s[2]  s[3]  s[4] rho[2,1] rho[3,1] rho[4,1] rho[3,2] rho[4,2] rho[4,3] #> mix                                                                                                                     #> comp1       1.000 0.000 0.000 0.000 0.000 0.707 0.707 0.707 0.707    0.000    0.000    0.000    0.000    0.000    0.000  # print a summary of the posterior (model parameters) print(blrmfit) #> Bayesian Logistic Regression Model with EXchangeability-NonEXchangeability #>  #> Number of observations: 18  #> Number of groups      : 3  #> Number of strata      : 2  #> Number of components  : 3  #> Number of interactions: 4  #> EXNEX components      : 3  #> EXNEX interactions    : 0  #>  #> Observations per group: #>        Group n Stratum n_total #> 1      Combo 3     BID      17 #> 2 HistAgent1 7      QD      52 #> 3 HistAgent2 8      QD      32 #>  #> Groups per stratum: #>   Stratum Groups n_total #> 1     BID      1      17 #> 2      QD      2      84 #>  #> Component posterior: #> Population mean posterior mu_log_beta #> intercept: #>                         mean se_mean   sd 2.5%   50% 97.5% n_eff Rhat #> I(log(drug_A/dref[1])) -1.56    0.43 1.35 -3.8 -1.38  0.50  10.0 0.92 #> I(log(drug_B/dref[2])) -3.09    0.23 0.74 -4.0 -3.18 -1.97  10.0 0.92 #> I(log(drug_C/dref[3])) -0.68    0.24 0.73 -1.7 -0.63  0.51   9.1 0.91 #> log-slope: #>                         mean se_mean   sd  2.5%   50% 97.5% n_eff Rhat #> I(log(drug_A/dref[1]))  0.12    0.31 0.93 -0.51 -0.17   2.1   9.0  1.2 #> I(log(drug_B/dref[2])) -0.18    0.33 1.04 -1.66 -0.13   1.3  10.0  0.9 #> I(log(drug_C/dref[3]))  0.44    0.22 0.65 -0.75  0.59   1.3   8.7  1.4 #>  #> Population heterogeniety posterior tau_log_beta #> intercept: #>                            mean se_mean   sd 2.5%  50% 97.5% n_eff Rhat #> BID,I(log(drug_A/dref[1])) 0.28   0.057 0.18 0.11 0.23  0.63  10.0 0.94 #> BID,I(log(drug_B/dref[2])) 0.65   0.311 0.80 0.12 0.30  2.34   6.7 1.17 #> BID,I(log(drug_C/dref[3])) 0.26   0.052 0.17 0.09 0.26  0.59  10.0 1.27 #> QD,I(log(drug_A/dref[1]))  0.67   0.236 0.75 0.11 0.40  2.10  10.0 0.99 #> QD,I(log(drug_B/dref[2]))  0.52   0.098 0.31 0.21 0.41  0.99  10.0 0.93 #> QD,I(log(drug_C/dref[3]))  0.48   0.086 0.27 0.25 0.33  0.95  10.0 1.11 #> log-slope: #>                            mean se_mean    sd  2.5%  50% 97.5% n_eff Rhat #> BID,I(log(drug_A/dref[1])) 0.17   0.039 0.122 0.059 0.14  0.42    10 0.92 #> BID,I(log(drug_B/dref[2])) 0.24   0.080 0.253 0.078 0.15  0.78    10 0.98 #> BID,I(log(drug_C/dref[3])) 0.16   0.027 0.082 0.055 0.14  0.32     9 1.37 #> QD,I(log(drug_A/dref[1]))  0.20   0.028 0.088 0.076 0.20  0.34    10 1.07 #> QD,I(log(drug_B/dref[2]))  0.26   0.055 0.173 0.105 0.20  0.62    10 0.95 #> QD,I(log(drug_C/dref[3]))  0.37   0.075 0.237 0.105 0.31  0.74    10 0.89 #>  #> Population correlation posterior rho_log_beta #>                          mean se_mean   sd  2.5%    50% 97.5% n_eff Rhat #> I(log(drug_A/dref[1]))  0.193    0.14 0.45 -0.41 0.0392  0.94  10.0  0.9 #> I(log(drug_B/dref[2])) -0.069    0.30 0.81 -0.97 0.0300  0.97   7.2  1.6 #> I(log(drug_C/dref[3])) -0.006    0.14 0.43 -0.62 0.0066  0.66  10.0  0.9 #>  #> Interaction model posterior: #> Population mean posterior mu_eta #>                                                       mean se_mean   sd  2.5% #> I(drug_A/dref[1] * drug_B/dref[2])                  -0.503    0.20 0.63 -1.34 #> I(drug_A/dref[1] * drug_C/dref[3])                   0.210    0.19 0.61 -0.47 #> I(drug_B/dref[2] * drug_C/dref[3])                  -0.028    0.20 0.65 -1.13 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])  0.356    0.16 0.52 -0.52 #>                                                       50% 97.5% n_eff Rhat #> I(drug_A/dref[1] * drug_B/dref[2])                  -0.61  0.41    10 0.90 #> I(drug_A/dref[1] * drug_C/dref[3])                  -0.10  1.07    10 0.99 #> I(drug_B/dref[2] * drug_C/dref[3])                   0.20  0.70    10 0.90 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])  0.41  1.01    10 1.48 #>  #> Population heterogeniety posterior tau_eta #>                                                         mean se_mean    sd #> BID,I(drug_A/dref[1] * drug_B/dref[2])                  0.23   0.056 0.179 #> BID,I(drug_A/dref[1] * drug_C/dref[3])                  0.22   0.032 0.101 #> BID,I(drug_B/dref[2] * drug_C/dref[3])                  0.29   0.024 0.071 #> BID,I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]) 0.25   0.023 0.073 #> QD,I(drug_A/dref[1] * drug_B/dref[2])                   0.26   0.040 0.094 #> QD,I(drug_A/dref[1] * drug_C/dref[3])                   0.31   0.031 0.099 #> QD,I(drug_B/dref[2] * drug_C/dref[3])                   0.21   0.021 0.049 #> QD,I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])  0.25   0.030 0.093 #>                                                          2.5%  50% 97.5% n_eff #> BID,I(drug_A/dref[1] * drug_B/dref[2])                  0.097 0.15  0.59  10.0 #> BID,I(drug_A/dref[1] * drug_C/dref[3])                  0.131 0.21  0.43  10.0 #> BID,I(drug_B/dref[2] * drug_C/dref[3])                  0.220 0.28  0.43   8.4 #> BID,I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]) 0.149 0.25  0.38  10.0 #> QD,I(drug_A/dref[1] * drug_B/dref[2])                   0.178 0.21  0.43   5.6 #> QD,I(drug_A/dref[1] * drug_C/dref[3])                   0.144 0.33  0.42  10.0 #> QD,I(drug_B/dref[2] * drug_C/dref[3])                   0.137 0.21  0.27   5.5 #> QD,I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])  0.138 0.23  0.43  10.0 #>                                                         Rhat #> BID,I(drug_A/dref[1] * drug_B/dref[2])                  0.91 #> BID,I(drug_A/dref[1] * drug_C/dref[3])                  0.90 #> BID,I(drug_B/dref[2] * drug_C/dref[3])                  1.14 #> BID,I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]) 0.90 #> QD,I(drug_A/dref[1] * drug_B/dref[2])                   0.92 #> QD,I(drug_A/dref[1] * drug_C/dref[3])                   0.90 #> QD,I(drug_B/dref[2] * drug_C/dref[3])                   1.56 #> QD,I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])  0.90 #>  #> Population correlation posterior Sigma_corr_eta #>                                                                                                           mean #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_A/dref[1] * drug_B/dref[2])                                    1.000 #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_A/dref[1] * drug_C/dref[3])                                   -0.037 #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_B/dref[2] * drug_C/dref[3])                                   -0.024 #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])                  -0.014 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2])                                   -0.037 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_A/dref[1] * drug_C/dref[3])                                    1.000 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_B/dref[2] * drug_C/dref[3])                                    0.239 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])                  -0.213 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2])                                   -0.024 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_C/dref[3])                                    0.239 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_B/dref[2] * drug_C/dref[3])                                    1.000 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])                   0.068 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2])                  -0.014 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_C/dref[3])                  -0.213 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_B/dref[2] * drug_C/dref[3])                   0.068 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])  1.000 #>                                                                                                         se_mean #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_A/dref[1] * drug_B/dref[2])                                       NaN #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_A/dref[1] * drug_C/dref[3])                                   2.1e-01 #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_B/dref[2] * drug_C/dref[3])                                   1.9e-01 #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])                  8.7e-02 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2])                                   2.1e-01 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_A/dref[1] * drug_C/dref[3])                                   2.9e-17 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_B/dref[2] * drug_C/dref[3])                                   1.3e-01 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])                  1.6e-01 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2])                                   1.9e-01 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_C/dref[3])                                   1.3e-01 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_B/dref[2] * drug_C/dref[3])                                   3.3e-17 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])                  1.1e-01 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2])                  8.7e-02 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_C/dref[3])                  1.6e-01 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_B/dref[2] * drug_C/dref[3])                  1.1e-01 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]) 2.1e-17 #>                                                                                                              sd #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_A/dref[1] * drug_B/dref[2])                                   0.0e+00 #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_A/dref[1] * drug_C/dref[3])                                   6.6e-01 #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_B/dref[2] * drug_C/dref[3])                                   5.9e-01 #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])                  2.8e-01 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2])                                   6.6e-01 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_A/dref[1] * drug_C/dref[3])                                   9.1e-17 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_B/dref[2] * drug_C/dref[3])                                   3.7e-01 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])                  5.0e-01 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2])                                   5.9e-01 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_C/dref[3])                                   3.7e-01 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_B/dref[2] * drug_C/dref[3])                                   1.0e-16 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])                  3.4e-01 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2])                  2.8e-01 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_C/dref[3])                  5.0e-01 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_B/dref[2] * drug_C/dref[3])                  3.4e-01 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]) 5.2e-17 #>                                                                                                          2.5% #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_A/dref[1] * drug_B/dref[2])                                    1.00 #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_A/dref[1] * drug_C/dref[3])                                   -0.89 #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_B/dref[2] * drug_C/dref[3])                                   -0.69 #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])                  -0.39 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2])                                   -0.89 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_A/dref[1] * drug_C/dref[3])                                    1.00 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_B/dref[2] * drug_C/dref[3])                                   -0.35 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])                  -0.67 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2])                                   -0.69 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_C/dref[3])                                   -0.35 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_B/dref[2] * drug_C/dref[3])                                    1.00 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])                  -0.48 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2])                  -0.39 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_C/dref[3])                  -0.67 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_B/dref[2] * drug_C/dref[3])                  -0.48 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])  1.00 #>                                                                                                            50% #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_A/dref[1] * drug_B/dref[2])                                    1.000 #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_A/dref[1] * drug_C/dref[3])                                   -0.023 #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_B/dref[2] * drug_C/dref[3])                                   -0.225 #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])                  -0.050 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2])                                   -0.023 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_A/dref[1] * drug_C/dref[3])                                    1.000 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_B/dref[2] * drug_C/dref[3])                                    0.283 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])                  -0.390 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2])                                   -0.225 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_C/dref[3])                                    0.283 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_B/dref[2] * drug_C/dref[3])                                    1.000 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])                   0.121 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2])                  -0.050 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_C/dref[3])                  -0.390 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_B/dref[2] * drug_C/dref[3])                   0.121 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])  1.000 #>                                                                                                         97.5% #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_A/dref[1] * drug_B/dref[2])                                    1.00 #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_A/dref[1] * drug_C/dref[3])                                    0.85 #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_B/dref[2] * drug_C/dref[3])                                    0.71 #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])                   0.39 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2])                                    0.85 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_A/dref[1] * drug_C/dref[3])                                    1.00 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_B/dref[2] * drug_C/dref[3])                                    0.72 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])                   0.66 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2])                                    0.71 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_C/dref[3])                                    0.72 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_B/dref[2] * drug_C/dref[3])                                    1.00 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])                   0.51 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2])                   0.39 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_C/dref[3])                   0.66 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_B/dref[2] * drug_C/dref[3])                   0.51 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])  1.00 #>                                                                                                         n_eff #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_A/dref[1] * drug_B/dref[2])                                     NaN #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_A/dref[1] * drug_C/dref[3])                                    10.0 #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_B/dref[2] * drug_C/dref[3])                                    10.0 #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])                   10.0 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2])                                    10.0 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_A/dref[1] * drug_C/dref[3])                                    10.0 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_B/dref[2] * drug_C/dref[3])                                     8.0 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])                   10.0 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2])                                    10.0 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_C/dref[3])                                     8.0 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_B/dref[2] * drug_C/dref[3])                                    10.0 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])                   10.0 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2])                   10.0 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_C/dref[3])                   10.0 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_B/dref[2] * drug_C/dref[3])                   10.0 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])   6.3 #>                                                                                                         Rhat #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_A/dref[1] * drug_B/dref[2])                                    NaN #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_A/dref[1] * drug_C/dref[3])                                   0.94 #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_B/dref[2] * drug_C/dref[3])                                   0.92 #> I(drug_A/dref[1] * drug_B/dref[2]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])                  0.90 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2])                                   0.94 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_A/dref[1] * drug_C/dref[3])                                   0.89 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_B/dref[2] * drug_C/dref[3])                                   1.01 #> I(drug_A/dref[1] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])                  1.17 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2])                                   0.92 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_C/dref[3])                                   1.01 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_B/dref[2] * drug_C/dref[3])                                   0.89 #> I(drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3])                  1.16 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2])                  0.90 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_C/dref[3])                  1.17 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_B/dref[2] * drug_C/dref[3])                  1.16 #> I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]),I(drug_A/dref[1] * drug_B/dref[2] * drug_C/dref[3]) 0.89 #> Warning: Parts of the model have not converged (some Rhats are > 1.1). #> Be careful when analysing the results! It is recommend to run #> more iterations and/or setting stronger priors.  # summary of posterior for DLT rate by dose for observed covariate levels summ <- summary(blrmfit, interval_prob = c(0, 0.16, 0.33, 1)) print(cbind(hist_combo3, summ)) #>    stratum_id   group_id drug_A drug_B drug_C num_toxicities num_patients #> 1         BID      Combo    400    800     80              0            4 #> 2         BID      Combo    400    800    160              1            8 #> 3         BID      Combo    400    800    240              2            5 #> 4          QD HistAgent1      0    240      0              0            5 #> 5          QD HistAgent1      0    400      0              0           10 #> 6          QD HistAgent1      0    800      0              1           11 #> 7          QD HistAgent1    240     80      0              0            4 #> 8          QD HistAgent1    400    400      0              1            6 #> 9          QD HistAgent1    400    800      0              0           11 #> 10         QD HistAgent1    400   1000      0              1            5 #> 11         QD HistAgent2      0      0     80              0            3 #> 12         QD HistAgent2      0      0    160              0            3 #> 13         QD HistAgent2      0      0    320              0            6 #> 14         QD HistAgent2      0      0    480              0            3 #> 15         QD HistAgent2      0      0    640              1            5 #> 16         QD HistAgent2    400      0    160              1            6 #> 17         QD HistAgent2    400      0    320              2            5 #> 18         QD HistAgent2    400      0    240              1            1 #>          mean         sd         2.5%        50%      97.5% [0,0.16] #> 1  0.15763035 0.05249890 0.0788935468 0.15386253 0.23775325      0.6 #> 2  0.18049107 0.06426261 0.0967196390 0.17314636 0.28667184      0.5 #> 3  0.20548523 0.07597862 0.1093537954 0.19694823 0.32983900      0.3 #> 4  0.01694962 0.01517327 0.0002702704 0.01471781 0.04570499      1.0 #> 5  0.02674302 0.02086952 0.0031741245 0.02241720 0.06811877      1.0 #> 6  0.08019912 0.05108842 0.0214118296 0.08389474 0.14499121      1.0 #> 7  0.12219773 0.10787006 0.0033342835 0.11643727 0.30511285      0.6 #> 8  0.13319085 0.08116821 0.0364489312 0.14272116 0.25594805      0.7 #> 9  0.10739850 0.04876519 0.0419003297 0.10383520 0.18253735      0.9 #> 10 0.10656435 0.05387841 0.0411395761 0.09668417 0.20920996      0.9 #> 11 0.01577683 0.01562399 0.0004452036 0.01181081 0.04403863      1.0 #> 12 0.03409630 0.02408099 0.0017825166 0.03279358 0.07007867      1.0 #> 13 0.08200248 0.04426954 0.0082446535 0.08279723 0.14439985      1.0 #> 14 0.14091971 0.07121965 0.0293088684 0.14135581 0.22605819      0.7 #> 15 0.20816371 0.09586503 0.0922844339 0.20206875 0.34228233      0.4 #> 16 0.20779780 0.10857143 0.0862082526 0.17852808 0.39193461      0.4 #> 17 0.25223444 0.08337001 0.1434467908 0.24298442 0.39014378      0.1 #> 18 0.22835057 0.09570861 0.1164104578 0.20972589 0.39135373      0.3 #>    (0.16,0.33] (0.33,1] #> 1          0.4      0.0 #> 2          0.5      0.0 #> 3          0.6      0.1 #> 4          0.0      0.0 #> 5          0.0      0.0 #> 6          0.0      0.0 #> 7          0.4      0.0 #> 8          0.3      0.0 #> 9          0.1      0.0 #> 10         0.1      0.0 #> 11         0.0      0.0 #> 12         0.0      0.0 #> 13         0.0      0.0 #> 14         0.3      0.0 #> 15         0.5      0.1 #> 16         0.4      0.2 #> 17         0.7      0.2 #> 18         0.5      0.2  # summary of posterior for DLT rate by dose for new set of covariate levels newdata <- expand.grid(   stratum_id = \"BID\", group_id = \"Combo\",   drug_A = 400, drug_B = 800, drug_C = c(320, 400, 600, 800),   stringsAsFactors = FALSE ) summ_pred <- summary(blrmfit, newdata = newdata, interval_prob = c(0, 0.16, 0.33, 1)) print(cbind(newdata, summ_pred)) #>   stratum_id group_id drug_A drug_B drug_C      mean         sd      2.5% #> 1        BID    Combo    400    800    320 0.2332778 0.08904148 0.1206098 #> 2        BID    Combo    400    800    400 0.2638937 0.10505501 0.1308699 #> 3        BID    Combo    400    800    600 0.3497262 0.15767879 0.1531685 #> 4        BID    Combo    400    800    800 0.4400316 0.20652868 0.1714653 #>         50%     97.5% [0,0.16] (0.16,0.33] (0.33,1] #> 1 0.2419234 0.3678581      0.3         0.6      0.1 #> 2 0.2971380 0.4041882      0.3         0.4      0.3 #> 3 0.3855898 0.5462626      0.1         0.3      0.6 #> 4 0.4704068 0.7417759      0.0         0.4      0.6  # update the model after observing additional data newdata$num_patients <- rep(3, nrow(newdata)) newdata$num_toxicities <- c(0, 1, 2, 2) library(dplyr) #>  #> Attaching package: ‘dplyr’ #> The following objects are masked from ‘package:stats’: #>  #>     filter, lag #> The following objects are masked from ‘package:base’: #>  #>     intersect, setdiff, setequal, union blrmfit_new <- update(blrmfit,   data = rbind(hist_combo3, newdata) %>%     arrange(stratum_id, group_id) ) #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess  # updated posterior summary summ_upd <- summary(blrmfit_new, newdata = newdata, interval_prob = c(0, 0.16, 0.33, 1)) print(cbind(newdata, summ_upd)) #>   stratum_id group_id drug_A drug_B drug_C num_patients num_toxicities #> 1        BID    Combo    400    800    320            3              0 #> 2        BID    Combo    400    800    400            3              1 #> 3        BID    Combo    400    800    600            3              2 #> 4        BID    Combo    400    800    800            3              2 #>        mean        sd      2.5%       50%     97.5% [0,0.16] (0.16,0.33] #> 1 0.2964530 0.1020539 0.1681743 0.3159403 0.4718398        0         0.7 #> 2 0.3352460 0.1242714 0.1751319 0.3529986 0.5560451        0         0.4 #> 3 0.4375843 0.1713431 0.1808415 0.4518160 0.7224272        0         0.2 #> 4 0.5439770 0.2113270 0.1867277 0.5662284 0.8322125        0         0.2 #>   (0.33,1] #> 1      0.3 #> 2      0.6 #> 3      0.8 #> 4      0.8 ## Recover user set sampling defaults options(.user_mc_options)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_formula_linear.html","id":null,"dir":"Reference","previous_headings":"","what":"Build a BLRM formula with linear interaction term in logit-space — blrm_formula_linear","title":"Build a BLRM formula with linear interaction term in logit-space — blrm_formula_linear","text":"blrm_formula_linear convenience function generating formula blrm_trial blrm_exnex interaction form: $$\\eta \\, \\prod_{=1}^N (d_i \\big / d_i^*))$$","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_formula_linear.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build a BLRM formula with linear interaction term in logit-space — blrm_formula_linear","text":"","code":"blrm_formula_linear(   ref_doses,   max_interaction_level = 2,   specific_interaction_terms = NULL )"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_formula_linear.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build a BLRM formula with linear interaction term in logit-space — blrm_formula_linear","text":"ref_doses Numeric vector reference doses names corresponding drug names max_interaction_level Highest interaction order consider \\([1 - Inf]\\). Default: 2 specific_interaction_terms List custom interaction terms generate (e.g. list(c(\"drug1\", \"drug2\"), c(\"drug1\", \"drug3\"))). Default: NULL","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_formula_linear.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build a BLRM formula with linear interaction term in logit-space — blrm_formula_linear","text":"function returns object class blrm_formula.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_formula_linear.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Build a BLRM formula with linear interaction term in logit-space — blrm_formula_linear","text":"","code":"ref_doses <- c(drug_A = 10, drug_B = 20)  # can be used with blrm_trial blrm_formula_linear(ref_doses) #> $blrm_formula #> [1] \"cbind(num_toxicities, num_patients - num_toxicities) ~ 1 + I(log(drug_A/10)) | 1 + I(log(drug_B/20)) | 0 + I(drug_A/10 * drug_B/20) | stratum_id / group_id\" #>  #> $num_interaction_terms #> [1] 1 #>  #> $num_components #> [1] 2 #>  #> $component_names #> [1] \"drug_A\" \"drug_B\" #>  #> $max_interaction_level #> [1] 2 #>  #> $ref_doses #> drug_A drug_B  #>     10     20  #>  #> attr(,\"class\") #> [1] \"blrm_formula\""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_formula_saturating.html","id":null,"dir":"Reference","previous_headings":"","what":"Build a BLRM formula with saturating interaction term in logit-space — blrm_formula_saturating","title":"Build a BLRM formula with saturating interaction term in logit-space — blrm_formula_saturating","text":"blrm_formula_saturating convenience function generating formula blrm_trial blrm_exnex interaction form: $$2 \\eta \\, \\frac{\\prod_{=1}^N (d_i \\big / d_i^*)}{1 + \\prod_{=1}^N (d_i \\big / d_i^*)}$$","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_formula_saturating.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Build a BLRM formula with saturating interaction term in logit-space — blrm_formula_saturating","text":"","code":"blrm_formula_saturating(   ref_doses,   max_interaction_level = 2,   specific_interaction_terms = NULL )"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_formula_saturating.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Build a BLRM formula with saturating interaction term in logit-space — blrm_formula_saturating","text":"ref_doses Numeric vector reference doses names corresponding drug names max_interaction_level Highest interaction order consider \\([1 - Inf]\\). Default: 2 specific_interaction_terms List custom interaction terms generate (e.g. list(c(\"drug1\", \"drug2\"), c(\"drug1\", \"drug3\"))).","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_formula_saturating.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Build a BLRM formula with saturating interaction term in logit-space — blrm_formula_saturating","text":"function returns object class blrm_formula.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_formula_saturating.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Build a BLRM formula with saturating interaction term in logit-space — blrm_formula_saturating","text":"Widmer, L.., Bean, ., Ohlssen, D., Weber, S., Principled Drug-Drug Interaction Terms Bayesian Logistic Regression Models Drug Safety Oncology Phase Combination Trials arXiv pre-print, 2023, doi:10.48550/arXiv.2302.11437","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_formula_saturating.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Build a BLRM formula with saturating interaction term in logit-space — blrm_formula_saturating","text":"","code":"ref_doses <- c(drug_A = 10, drug_B = 20)  # can be used with blrm_trial blrm_formula_saturating(ref_doses) #> $blrm_formula #> [1] \"cbind(num_toxicities, num_patients - num_toxicities) ~ 1 + I(log(drug_A/10)) | 1 + I(log(drug_B/20)) | 0 + I(2 * (drug_A/10 * drug_B/20) / (1 + drug_A/10 * drug_B/20))| stratum_id / group_id\" #>  #> $num_interaction_terms #> [1] 1 #>  #> $num_components #> [1] 2 #>  #> $component_names #> [1] \"drug_A\" \"drug_B\" #>  #> $max_interaction_level #> [1] 2 #>  #> $ref_doses #> drug_A drug_B  #>     10     20  #>  #> attr(,\"class\") #> [1] \"blrm_formula\""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_trial.html","id":null,"dir":"Reference","previous_headings":"","what":"Dose-Escalation Trials guided by Bayesian Logistic Regression Model — blrm_trial","title":"Dose-Escalation Trials guided by Bayesian Logistic Regression Model — blrm_trial","text":"blrm_trial facilitates conduct dose escalation studies guided Bayesian Logistic Regression Models (BLRM). blrm_exnex fits BLRM model data, blrm_trial function standardizes specification entire trial design provides various standardized functions trial data accrual derivation model summaries needed dose-escalation decisions.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_trial.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dose-Escalation Trials guided by Bayesian Logistic Regression Model — blrm_trial","text":"","code":"blrm_trial(   data,   dose_info,   drug_info,   simplified_prior = FALSE,   EXNEX_comp = FALSE,   EX_prob_comp_hist = 1,   EX_prob_comp_new = 0.8,   EXNEX_inter = FALSE,   EX_prob_inter = 1,   formula_generator = blrm_formula_saturating,   interval_prob = c(0, 0.16, 0.33, 1),   interval_max_mass = c(prob_underdose = 1, prob_target = 1, prob_overdose = 0.25),   ... )  # S3 method for class 'blrm_trial' print(x, ...)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_trial.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Dose-Escalation Trials guided by Bayesian Logistic Regression Model — blrm_trial","text":"data dose-toxicity data available design stage trial dose_info specificaion dose levels planned ongoing trial arms. drug_info specification drugs used trial arms. simplified_prior logical (defaults FALSE) indicating whether simplified prior employed based reference_p_dlt values provided drug_info. Warning: simplified prior change releases. Please read instructions respective section simplified prior. EXNEX_comp logical (default TRUE) indicating whether EXchangeable-NonEXchangeable priors employed component parameters EX_prob_comp_hist prior weight (\\([0,1]\\), default 1) exchangeability component parameters groups representing historical data EX_prob_comp_new prior weight (\\([0,1]\\), default 0.8) exchangeability component parameters groups representing new concurrent data EXNEX_inter logical (default FALSE) indicating whether EXchangeable-NonEXchangeable priors employed interaction parameters EX_prob_inter prior weight (\\([0,1]\\), defaults 0.8) exchangeability interaction parameters formula_generator formula generation function (see example blrm_formula_linear blrm_formula_saturating). formula generator defines employed interaction model. interval_prob defines interval probabilities reported standard outputs. Defaults c(0, 0.16, 0.33, 1). interval_max_mass named vector defining interval interval_prob vector maxmimal admissable probability mass given dose level. Whenever posterior probability mass given interval exceeds threshold, Escalation Overdose Control (EWOC) criterion considered fullfilled. Dose levels fullfilling EWOC ineligible next cohort patients. default restricts overdose probability less 0.25. ... Additional arguments forwarded blrm_exnex, .e. purpose prior specification. x blrm_trial object print","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_trial.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Dose-Escalation Trials guided by Bayesian Logistic Regression Model — blrm_trial","text":"function returns object class blrm_trial.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_trial.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Dose-Escalation Trials guided by Bayesian Logistic Regression Model — blrm_trial","text":"blrm_trial constructs object class blrm_trial stores compelte information study design dose-escalation trial. study design defined data sets (see sections definition columns): data (historical data) data argument defines available dose-toxicity data design stage trial. Together prior model (without data) defines prior used trial conduct. dose_info Definition pre-specified dose levels explored ongoing trial arms. Thus, dose-toxcitiy trial data added object expected correspond one dose levels pre-defined set dose_info. drug_info Determines drugs used trial, units, reference dose level optionally defines expected probability toxicity reference dose. blrm_trial object setup complete trial design specified model fitted given data. allows evaluation pre-specified dose levels trial design wrt. safety, .e. whether starting dose trial fullfills escalate overdose criterion (EWOC) condition. blrm_trial trial can also constructed 2-step process allows convenient specification prior since meta data like number drugs like can used. See example section details. setup initial blrm_trial object additional data added use update method add_data argument intended add data ongoing trial. summary function finally allows extract various model summaries. particular, EWOC criterion can calculated pre-defined dose levels trial.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_trial.html","id":"methods-by-generic-","dir":"Reference","previous_headings":"","what":"Methods (by generic)","title":"Dose-Escalation Trials guided by Bayesian Logistic Regression Model — blrm_trial","text":"print(blrm_trial): print function.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_trial.html","id":"simplified-prior","dir":"Reference","previous_headings":"","what":"Simplified prior","title":"Dose-Escalation Trials guided by Bayesian Logistic Regression Model — blrm_trial","text":"convenience user, simplified prior can specifed whenever reference_p_dlt column present drug_info data set. However, user warned simplified prior change future releases package thus strongly discourage use simplified prior setting trial designs. functionality intended provide user quick start starting point. actually instantiated prior can seen demonstrated examples.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_trial.html","id":"input-data","dir":"Reference","previous_headings":"","what":"Input data","title":"Dose-Escalation Trials guided by Bayesian Logistic Regression Model — blrm_trial","text":"data given data argument blrm_trial considered available design stage trial. collected input data thus necessarily need dose levels pre-specified dose_info ongoing trial(s). data columns must include, limited : group_id study stratum_id optional, required differential discounting groups num_patients number patients num_toxicities number toxicities drug_A Columns dose treatment component, column names matching drug_name values specified drug_info argument blrm_trial","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_trial.html","id":"drug-info-data","dir":"Reference","previous_headings":"","what":"Drug info data","title":"Dose-Escalation Trials guided by Bayesian Logistic Regression Model — blrm_trial","text":"drug information data-set defines drug properties. fields included : drug_name name drug also used column name dose dose_ref reference dose dose_unit units used drug amounts reference_p_dlt optional; provided, allows setup simplified prior","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_trial.html","id":"dose-info-data","dir":"Reference","previous_headings":"","what":"Dose info data","title":"Dose-Escalation Trials guided by Bayesian Logistic Regression Model — blrm_trial","text":"drug_info data-set pre-specifies dose levels ongoing trial. Thus, data added blrm_trial update command must consistent pre-defined dose levels pre-specified ones can explored ongoing trial. dose_id optional column assigns unique id group_id/dose combination. specified column internally generated. group_id study drug_A Columns dose treatment component, column names matching drug_name values specified drug_info argument blrm_trial","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_trial.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Dose-Escalation Trials guided by Bayesian Logistic Regression Model — blrm_trial","text":"Babb, J., Rogatko, ., & Zacks, S. (1998). Cancer phase clinical trials: efficient dose escalation overdose control. Statistics medicine, 17(10), 1103-1120. Neuenschwander, B., Roychoudhury, S., & Schmidli, H. (2016). use co-data clinical trials. Statistics Biopharmaceutical Research, 8(3), 345-354.","code":""},{"path":[]},{"path":"http://opensource.nibr.com/OncoBayes2/reference/blrm_trial.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Dose-Escalation Trials guided by Bayesian Logistic Regression Model — blrm_trial","text":"","code":"## Setting up dummy sampling for fast execution of example ## Please use 4 chains and 100x more warmup & iter in practice .user_mc_options <- options(   OncoBayes2.MC.warmup = 10, OncoBayes2.MC.iter = 20, OncoBayes2.MC.chains = 1,   OncoBayes2.MC.save_warmup = FALSE )   # construct initial blrm_trial object from built-in example datasets combo2_trial_setup <- blrm_trial(   data = hist_combo2,   dose_info = dose_info_combo2,   drug_info = drug_info_combo2,   simplified_prior = TRUE ) #> No stratum defined - assigning all groups to single stratum \"all\" #> Warning: Simplified prior CAN and WILL change with releases. NOT recommended to use in production. Instantiating a simplified prior - run summary(trial, \"blrm_exnex_call\") to inspect arguments.  #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess #> Warning: 14 out of 42 ewoc metrics have not converged (some Rhats are > 1.1). #> Be careful when analysing the results! It is recommended to run #> more iterations and/or setting stronger priors. #> You may call \"summary(trial, summarize='ewoc_check', ...)\" for more diagnostic details. #> Please call \"help('blrm_trial', help_type='summary')\" for further documentation. #> Warning: 19 out of 42 ewoc metrics are within the 95% MCMC error of the decision boundary. #> Be careful when using the imprecise ewoc estimates! It is recommended to run #> more iterations and review doses close to critical thresholds. #> You may call \"summary(trial, summarize='ewoc_check', ...)\" for more diagnostic details. #> Please call \"help('blrm_trial', help_type='summary')\" for further documentation.  # extract blrm_call to see setup of the prior as passed to blrm_exnex summary(combo2_trial_setup, \"blrm_exnex_call\") #> blrm_exnex(formula = cbind(num_toxicities, num_patients - num_toxicities) ~  #>     1 + I(log(drug_A/6)) | 1 + I(log(drug_B/1500)) | 0 + I(2 *  #>         (drug_A/6 * drug_B/1500)/(1 + drug_A/6 * drug_B/1500)) |  #>         stratum_id/group_id, data = data, prior_EX_mu_comp = list(mixmvnorm(c(1,  #>     logit(0.2), 0, diag(c(2, 0.7)^2))), mixmvnorm(c(1, logit(0.2),  #>     0, diag(c(2, 0.7)^2)))), prior_EX_tau_comp = replicate(2L,  #>     mixmvnorm(c(1, log(0.25), log(0.125), diag((c(4, 2)/1.96)^2))),  #>     FALSE), prior_EX_mu_inter = mixmvnorm(c(1, 0, diag(1.5^2,  #>     1, 1))), prior_EX_tau_inter = mixmvnorm(c(1, c(log(0.5)),  #>     diag(c(log(2)/1.96)^2, 1, 1))), prior_is_EXNEX_inter = FALSE,  #>     prior_is_EXNEX_comp = c(FALSE, FALSE), prior_EX_prob_comp = c(1,  #>     1, 1, 1, 1, 1, 1, 1), prior_EX_prob_inter = c(1, 1, 1, 1),  #>     prior_tau_dist = 1)  # Warning: The simplified prior will change between releases! # please refer to the combo2_trial example for a complete # example. You can obtain this example with # ?example-combo2_trial # or by running # example_model(\"combo2_trial\")  ## Recover user set sampling defaults options(.user_mc_options)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/codata_combo2.html","id":null,"dir":"Reference","previous_headings":"","what":"Dataset: historical and concurrent data on a two-way combination — codata_combo2","title":"Dataset: historical and concurrent data on a two-way combination — codata_combo2","text":"One two datasets application described Neuenschwander et al (2016). study trial_AB, risk DLT studied function dose two drugs, drug drug B. Historical information toxicity profiles two drugs available single agent trials trial_A trial_B. Another study IIT run concurrently trial_AB, studies combination. second dataset hist_combo2 available example, includes data single agent studies, prior initiation trial_AB IIT.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/codata_combo2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dataset: historical and concurrent data on a two-way combination — codata_combo2","text":"","code":"codata_combo2"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/codata_combo2.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Dataset: historical and concurrent data on a two-way combination — codata_combo2","text":"data frame 20 rows 5 variables: group_id study drug_A dose Drug drug_B dose Drug B num_patients number patients num_toxicities number DLTs cohort_time cohort number patients","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/codata_combo2.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Dataset: historical and concurrent data on a two-way combination — codata_combo2","text":"Neuenschwander, B., Roychoudhury, S., & Schmidli, H. (2016). use co-data clinical trials. Statistics Biopharmaceutical Research, 8(3), 345-354.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/codata_combo2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Dataset: historical and concurrent data on a two-way combination — codata_combo2","text":"","code":"## Setting up dummy sampling for fast execution of example ## Please use 4 chains and 100x more warmup & iter in practice .user_mc_options <- options(   OncoBayes2.MC.warmup = 10, OncoBayes2.MC.iter = 20, OncoBayes2.MC.chains = 1,   OncoBayes2.MC.save_warmup = FALSE )  dref <- c(6, 960)  num_comp   <- 2 # two investigational drugs num_inter  <- 1 # one drug-drug interaction needs to be modeled num_groups <- nlevels(codata_combo2$group_id) # no stratification needed num_strata <- 1 # no stratification needed  blrmfit <- blrm_exnex(   cbind(num_toxicities, num_patients - num_toxicities) ~     1 + I(log(drug_A / dref[1])) |       1 + I(log(drug_B / dref[2])) |       0 + I(drug_A / dref[1] * drug_B / dref[2]) |       group_id,   data = codata_combo2,   prior_EX_mu_comp  = list(mixmvnorm(c(1, logit(0.2), 0, diag(c(2^2, 1)))),                            mixmvnorm(c(1, logit(0.2), 0, diag(c(2^2, 1))))),   prior_EX_tau_comp = list(mixmvnorm(c(1,                                        log(0.250), log(0.125),                                        diag(c(log(4)/1.96, log(4)/1.96)^2))),                            mixmvnorm(c(1,                                        log(0.250), log(0.125),                                        diag(c(log(4)/1.96, log(4)/1.96)^2)))),   prior_EX_mu_inter = mixmvnorm(c(1, 0, 1.121^2)),   prior_EX_tau_inter = mixmvnorm(c(1, log(0.125), (log(4) / 1.96)^2)),   prior_is_EXNEX_comp = rep(FALSE, num_comp),   prior_is_EXNEX_inter = rep(FALSE, num_inter),   prior_EX_prob_comp = matrix(1, nrow = num_groups, ncol = num_comp),   prior_EX_prob_inter = matrix(1, nrow = num_groups, ncol = num_inter),   prior_tau_dist = 1 ) #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess ## Recover user set sampling defaults options(.user_mc_options)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/critical_quantile.html","id":null,"dir":"Reference","previous_headings":"","what":"Critical quantile — critical_quantile","title":"Critical quantile — critical_quantile","text":"Calculates critical value model covariate fixed quantile crude rate equal specified (tail interval) probability. specified quantile can relate posterior predictive distribution response rate.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/critical_quantile.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Critical quantile — critical_quantile","text":"","code":"critical_quantile(object, ...)  # S3 method for class 'blrmfit' critical_quantile(   object,   newdata,   x,   p,   qc,   lower.tail,   interval.x,   extendInt.x = c(\"auto\", \"no\", \"yes\", \"downX\", \"upX\"),   log.x,   predictive = FALSE,   maxiter = 100,   ... )  # S3 method for class 'blrm_trial' critical_quantile(   object,   newdata,   x,   p,   qc,   lower.tail,   interval.x,   extendInt.x = c(\"auto\", \"no\", \"yes\", \"downX\", \"upX\"),   log.x,   predictive = FALSE,   maxiter = 100,   ... )"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/critical_quantile.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Critical quantile — critical_quantile","text":"object fitted model object ... used function newdata optional data frame specifying predict; missing, data input model object used x character giving covariate name search meet critical conditions.  also supports 'tidy' parameter selection specifying x = vars(...), ...  specified way dplyr::select() similar functions. Examples using x way can found examples. blrm_trial methods, defaults first entry summary(blrm_trial, \"drug_info\")$drug_name. p cumulative probability corresponding critical quantile range. qc given sorted vector length 2, two entries define interval response rate scale must correspond cumulative probability p. case lower.tail must NULL left missing. qc single number, lower.tail must set complete specification tail area. lower.tail defines probabilities lower upper tail areas. Must defined qc single number must defined qc denotes interval. interval.x interval covariate x searched. Defaults minimal maximal value x data set used. Whenever lower.tail set known tail area used, function automatically attempt enlarge search interval since direction inverted function determined around critical value. extendInt.x controls interval given interval.x extended root finding. default \"auto\" attempts guess adequate setting cases thats possible. possible values extendInt argument stats::uniroot() function. log.x determines numerical search critical value covariate space logarithmized. default x log transformed whenever values positive. predictive logical indicates critical quantile relates posterior (FALSE) predictive (TRUE) distribution. Defaults FALSE. maxiter maximal number iterations root finding. Defaults 100.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/critical_quantile.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Critical quantile — critical_quantile","text":"Vector length equal number rows input data set crticial value covariate specified x fullfills requirements detailled . May return NA cases solution found specified interval interval.x.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/critical_quantile.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Critical quantile — critical_quantile","text":"function searches critical value \\(x_c\\) covariate \\(x\\) (x) integral model response specified interval \\(\\pi_1\\) \\(\\pi_2\\) (qc) equal given probability \\(p\\) (p). given interval considered tail area lower.tail used \\(\\pi_1 = 0\\) TRUE \\(\\pi_2=1\\) FALSE. critical value \\(x_c\\) equality holds $$p = \\int_{\\pi_1}^{\\pi_2} p(\\pi | x_c) \\, d\\pi .$$ Note solution guranteed exist circumstances. However, single agent model requesting tail probability solution exist. case interval probability specified, solution may necessarily exist root finding confined range specified interval.x. case solution requested predictive distribution (predictive=TRUE), respective problem solved leads equality $$p = \\sum_{y= r_1 = \\lceil n \\, \\pi_1 \\rceil }^{r_2 = \\lceil n \\, \\pi_2 \\rceil } \\int p(y|\\pi, n) \\, p(\\pi | x_c) \\, d\\pi .$$ Furthermore, covariate space log transformed default whenever values covariate \\(x\\) positive data set. Values \\(0\\) shifted positive domain machine precision avoid issues ill-defined \\(\\log(0)\\). blrm_trial objects default arguments p, qc lower.tail set correspond highest interval interval_prob constrained respective interval_max_mass (defined part blrm_trial objects). default case correspond EWOC metric. defaults applied p, qc lower.tail missing.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/critical_quantile.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Critical quantile — critical_quantile","text":"","code":"## Setting up dummy sampling for fast execution of example ## Please use 4 chains and 100x more warmup & iter in practice .user_mc_options <- options(   OncoBayes2.MC.warmup = 10, OncoBayes2.MC.iter = 20, OncoBayes2.MC.chains = 1,   OncoBayes2.MC.save_warmup = FALSE )  # fit an example model. See documentation for \"combo2\" example example_model(\"combo2\", silent = TRUE) #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess  # Find dose of drug_A at which EWOC criterium is just fulfilled data_trial_ab <- subset(codata_combo2, group_id == \"trial_AB\") drug_A_crit <- critical_quantile(blrmfit,   newdata = data_trial_ab,   x = \"drug_A\", p = 0.25, qc = 0.33,   lower.tail = FALSE ) data_trial_ab$drug_A <- drug_A_crit summary(blrmfit, newdata = data_trial_ab, interval_prob = c(0, 0.16, 0.33, 1)) #>        mean         sd       2.5%       50%     97.5% [0,0.16] (0.16,0.33] #> 1 0.2784784 0.10046646 0.15311191 0.2942422 0.4260879      0.1         0.6 #> 2 0.2575160 0.10161998 0.09526054 0.2553971 0.3886394      0.1         0.6 #> 3 0.2784784 0.10046646 0.15311191 0.2942422 0.4260879      0.1         0.6 #> 4 0.2784784 0.10046646 0.15311191 0.2942422 0.4260879      0.1         0.6 #> 5 0.2575160 0.10161998 0.09526054 0.2553971 0.3886394      0.1         0.6 #> 6 0.2769644 0.08214743 0.18177646 0.2522595 0.4188390      0.0         0.7 #> 7 0.2784784 0.10046646 0.15311191 0.2942422 0.4260879      0.1         0.6 #>   (0.33,1] #> 1      0.3 #> 2      0.3 #> 3      0.3 #> 4      0.3 #> 5      0.3 #> 6      0.3 #> 7      0.3  ## Recover user set sampling defaults options(.user_mc_options)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/diagnostic-quantities.html","id":null,"dir":"Reference","previous_headings":"","what":"Extract Diagnostic Quantities of OncoBayes2 Models — diagnostic-quantities","title":"Extract Diagnostic Quantities of OncoBayes2 Models — diagnostic-quantities","text":"Extract quantities can used diagnose sampling behavior algorithms applied Stan back-end OncoBayes2.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/diagnostic-quantities.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Extract Diagnostic Quantities of OncoBayes2 Models — diagnostic-quantities","text":"","code":"# S3 method for class 'blrmfit' log_posterior(object, ...)  # S3 method for class 'blrmfit' nuts_params(object, pars = NULL, ...)  # S3 method for class 'blrmfit' rhat(object, pars = NULL, ...)  # S3 method for class 'blrmfit' neff_ratio(object, pars = NULL, ...)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/diagnostic-quantities.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Extract Diagnostic Quantities of OncoBayes2 Models — diagnostic-quantities","text":"object blrmfit blrmtrial object. ... Arguments passed individual methods. pars optional character vector parameter names. nuts_params NUTS sampler parameter names rather model parameters. pars omitted parameters included.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/diagnostic-quantities.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Extract Diagnostic Quantities of OncoBayes2 Models — diagnostic-quantities","text":"exact form output depends method.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/diagnostic-quantities.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Extract Diagnostic Quantities of OncoBayes2 Models — diagnostic-quantities","text":"details see bayesplot::bayesplot-extractors().","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/diagnostic-quantities.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Extract Diagnostic Quantities of OncoBayes2 Models — diagnostic-quantities","text":"","code":"## Setting up dummy sampling for fast execution of example ## Please use 4 chains and 100x more warmup & iter in practice .user_mc_options <- options(   OncoBayes2.MC.warmup = 10, OncoBayes2.MC.iter = 20, OncoBayes2.MC.chains = 1,   OncoBayes2.MC.save_warmup = FALSE )  example_model(\"single_agent\", silent = TRUE) #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess  head(log_posterior(blrmfit)) #>   Chain Iteration     Value #> 1     1         1 -17.00453 #> 2     1         2 -15.89877 #> 3     1         3 -13.37728 #> 4     1         4 -13.70039 #> 5     1         5 -15.04728 #> 6     1         6 -18.13408  np <- nuts_params(blrmfit) str(np) #> 'data.frame':\t60 obs. of  4 variables: #>  $ Chain    : int  1 1 1 1 1 1 1 1 1 1 ... #>  $ Iteration: int  1 2 3 4 5 6 7 8 9 10 ... #>  $ Parameter: Factor w/ 6 levels \"accept_stat__\",..: 1 1 1 1 1 1 1 1 1 1 ... #>  $ Value    : num  0.999 1 0.999 0.997 1 ... # extract the number of divergence transitions sum(subset(np, Parameter == \"divergent__\")$Value) #> [1] 0  head(rhat(blrmfit)) #>        mu_log_beta[log(drug_A/dref),intercept]  #>                                       1.391186  #>        mu_log_beta[log(drug_A/dref),log_slope]  #>                                       1.384032  #>     tau_log_beta[1,log(drug_A/dref),intercept]  #>                                            NaN  #>     tau_log_beta[1,log(drug_A/dref),log_slope]  #>                                            NaN  #> beta_group[trial_A,log(drug_A/dref),intercept]  #>                                       1.391186  #>     beta_group[trial_A,log(drug_A/dref),slope]  #>                                       1.238610  head(neff_ratio(blrmfit)) #>        mu_log_beta[log(drug_A/dref),intercept]  #>                                      0.6793941  #>        mu_log_beta[log(drug_A/dref),log_slope]  #>                                      0.5941920  #>     tau_log_beta[1,log(drug_A/dref),intercept]  #>                                            NaN  #>     tau_log_beta[1,log(drug_A/dref),log_slope]  #>                                            NaN  #> beta_group[trial_A,log(drug_A/dref),intercept]  #>                                      0.6793941  #>     beta_group[trial_A,log(drug_A/dref),slope]  #>                                      0.8094134   ## Recover user set sampling defaults options(.user_mc_options)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/dose_info_combo2.html","id":null,"dir":"Reference","previous_headings":"","what":"Dataset: trial dose information for a dual-agent combination study — dose_info_combo2","title":"Dataset: trial dose information for a dual-agent combination study — dose_info_combo2","text":"data set defines pre-defined dose-levels can explored dual-agent example trial.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/dose_info_combo2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dataset: trial dose information for a dual-agent combination study — dose_info_combo2","text":"","code":"dose_info_combo2"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/dose_info_combo2.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Dataset: trial dose information for a dual-agent combination study — dose_info_combo2","text":"object class tbl_df (inherits tbl, data.frame) 42 rows 4 columns.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/dose_info_combo2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Dataset: trial dose information for a dual-agent combination study — dose_info_combo2","text":"group_id study drug_A drug dose amount drug_B drug B dose amount dose_id unique id record","code":""},{"path":[]},{"path":"http://opensource.nibr.com/OncoBayes2/reference/dot-get_X.html","id":null,"dir":"Reference","previous_headings":"","what":"Obtain design matrices. — .get_X","title":"Obtain design matrices. — .get_X","text":"Obtain design matrices.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/dot-get_X.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Obtain design matrices. — .get_X","text":"","code":".get_X(formula, model_frame, num_comp, has_inter, idx_inter_term)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/dot-get_strata_group_fct.html","id":null,"dir":"Reference","previous_headings":"","what":"extracts from a blrmfit object and a given data-set the group and stratum factor — .get_strata_group_fct","title":"extracts from a blrmfit object and a given data-set the group and stratum factor — .get_strata_group_fct","text":"extracts blrmfit object given data-set group stratum factor","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/dot-get_strata_group_fct.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"extracts from a blrmfit object and a given data-set the group and stratum factor — .get_strata_group_fct","text":"","code":".get_strata_group_fct(object, data)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/dot-label_index.html","id":null,"dir":"Reference","previous_headings":"","what":"Utility function to label parameter indices according to factor levels. — .label_index","title":"Utility function to label parameter indices according to factor levels. — .label_index","text":"Utility function label parameter indices according factor levels.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/dot-label_index.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Utility function to label parameter indices according to factor levels. — .label_index","text":"","code":".label_index(stanfit, par, ...)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/dot-label_index.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Utility function to label parameter indices according to factor levels. — .label_index","text":"stanfit stan fit names modified par parameter selected ... must include many factors indices used order given translate indices text labels","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/dot-validate_group_stratum_nesting.html","id":null,"dir":"Reference","previous_headings":"","what":"Test if each group is assigned to exactly 1 stratum. Error otherwise. — .validate_group_stratum_nesting","title":"Test if each group is assigned to exactly 1 stratum. Error otherwise. — .validate_group_stratum_nesting","text":"Test group assigned exactly 1 stratum. Error otherwise.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/dot-validate_group_stratum_nesting.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Test if each group is assigned to exactly 1 stratum. Error otherwise. — .validate_group_stratum_nesting","text":"","code":".validate_group_stratum_nesting(group_def, strata_def)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/dot-validate_group_stratum_nesting.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Test if each group is assigned to exactly 1 stratum. Error otherwise. — .validate_group_stratum_nesting","text":"group_def groups data strata_def assigned stratum group","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/draws-OncoBayes2.html","id":null,"dir":"Reference","previous_headings":"","what":"Transform blrmfit or blrm_trial to draws objects — draws-OncoBayes2","title":"Transform blrmfit or blrm_trial to draws objects — draws-OncoBayes2","text":"Transform blrmfit blrm_trial object format supported posterior package.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/draws-OncoBayes2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Transform blrmfit or blrm_trial to draws objects — draws-OncoBayes2","text":"","code":"# S3 method for class 'blrmfit' as_draws(x, variable = NULL, regex = FALSE, inc_warmup = FALSE, ...)  # S3 method for class 'blrmfit' as_draws_matrix(x, variable = NULL, regex = FALSE, inc_warmup = FALSE, ...)  # S3 method for class 'blrmfit' as_draws_array(x, variable = NULL, regex = FALSE, inc_warmup = FALSE, ...)  # S3 method for class 'blrmfit' as_draws_df(x, variable = NULL, regex = FALSE, inc_warmup = FALSE, ...)  # S3 method for class 'blrmfit' as_draws_list(x, variable = NULL, regex = FALSE, inc_warmup = FALSE, ...)  # S3 method for class 'blrmfit' as_draws_rvars(x, variable = NULL, regex = FALSE, inc_warmup = FALSE, ...)  # S3 method for class 'blrm_trial' as_draws(x, variable = NULL, regex = FALSE, inc_warmup = FALSE, ...)  # S3 method for class 'blrm_trial' as_draws_matrix(x, variable = NULL, regex = FALSE, inc_warmup = FALSE, ...)  # S3 method for class 'blrm_trial' as_draws_array(x, variable = NULL, regex = FALSE, inc_warmup = FALSE, ...)  # S3 method for class 'blrm_trial' as_draws_df(x, variable = NULL, regex = FALSE, inc_warmup = FALSE, ...)  # S3 method for class 'blrm_trial' as_draws_list(x, variable = NULL, regex = FALSE, inc_warmup = FALSE, ...)  # S3 method for class 'blrm_trial' as_draws_rvars(x, variable = NULL, regex = FALSE, inc_warmup = FALSE, ...)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/draws-OncoBayes2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Transform blrmfit or blrm_trial to draws objects — draws-OncoBayes2","text":"x blrmfit blrm_trial object. variable character vector providing variables extract.  default, variables extracted. regex Logical; variable treated (vector ) regular expressions? variable x matching least one regular expressions selected. Defaults FALSE. inc_warmup warmup draws included? Defaults FALSE. ... Arguments passed individual methods (applicable).","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/draws-OncoBayes2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Transform blrmfit or blrm_trial to draws objects — draws-OncoBayes2","text":"subset iterations, chains, draws, use posterior::subset_draws() method transforming input object draws object. function experimental set exported posterior variables subject updates.","code":""},{"path":[]},{"path":"http://opensource.nibr.com/OncoBayes2/reference/draws-OncoBayes2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Transform blrmfit or blrm_trial to draws objects — draws-OncoBayes2","text":"","code":"## Setting up dummy sampling for fast execution of example ## Please use 4 chains and 100x more warmup & iter in practice .user_mc_options <- options(   OncoBayes2.MC.warmup = 10, OncoBayes2.MC.iter = 20, OncoBayes2.MC.chains = 1,   OncoBayes2.MC.save_warmup = FALSE )  # fit an example model. See documentation for \"combo2\" example example_model(\"combo2\") #> Running combo2 example: #>  dref <- c(6, 960) #>  #>  num_comp   <- 2 # two investigational drugs #>  num_inter  <- 1 # one drug-drug interaction needs to be modeled #>  num_groups <- nlevels(codata_combo2$group_id) # no stratification needed #>  num_strata <- 1 # no stratification needed #>  #>  blrmfit <- blrm_exnex( #>    cbind(num_toxicities, num_patients - num_toxicities) ~ #>      1 + I(log(drug_A / dref[1])) | #>        1 + I(log(drug_B / dref[2])) | #>        0 + I(drug_A / dref[1] * drug_B / dref[2]) | #>        group_id, #>    data = codata_combo2, #>    prior_EX_mu_comp  = list(mixmvnorm(c(1, logit(0.2), 0, diag(c(2^2, 1)))), #>                             mixmvnorm(c(1, logit(0.2), 0, diag(c(2^2, 1))))), #>    prior_EX_tau_comp = list(mixmvnorm(c(1, #>                                         log(0.250), log(0.125), #>                                         diag(c(log(4)/1.96, log(4)/1.96)^2))), #>                             mixmvnorm(c(1, #>                                         log(0.250), log(0.125), #>                                         diag(c(log(4)/1.96, log(4)/1.96)^2)))), #>    prior_EX_mu_inter = mixmvnorm(c(1, 0, 1.121^2)), #>    prior_EX_tau_inter = mixmvnorm(c(1, log(0.125), (log(4) / 1.96)^2)), #>    prior_is_EXNEX_comp = rep(FALSE, num_comp), #>    prior_is_EXNEX_inter = rep(FALSE, num_inter), #>    prior_EX_prob_comp = matrix(1, nrow = num_groups, ncol = num_comp), #>    prior_EX_prob_inter = matrix(1, nrow = num_groups, ncol = num_inter), #>    prior_tau_dist = 1 #>  ) #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess  post <- as_draws(blrmfit)  ## Recover user set sampling defaults options(.user_mc_options)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/drug_info_combo2.html","id":null,"dir":"Reference","previous_headings":"","what":"Dataset: drug information for a dual-agent combination study — drug_info_combo2","title":"Dataset: drug information for a dual-agent combination study — drug_info_combo2","text":"Data set describing two drugs involved example dual-agent combination study.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/drug_info_combo2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dataset: drug information for a dual-agent combination study — drug_info_combo2","text":"","code":"drug_info_combo2"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/drug_info_combo2.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Dataset: drug information for a dual-agent combination study — drug_info_combo2","text":"tibble 2 rows (one per durg) 4 columns: drug_name name drug dose_ref reference dose dose_unit units used drug amounts reference_p_dlt -priori probability DLT reference dose","code":""},{"path":[]},{"path":"http://opensource.nibr.com/OncoBayes2/reference/example-combo2.html","id":null,"dir":"Reference","previous_headings":"","what":"Two-drug combination example — example-combo2","title":"Two-drug combination example — example-combo2","text":"Example using combination two experimental drugs.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/example-combo2.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Two-drug combination example — example-combo2","text":"following example described reference Neuenschwander, B. et al (2016). data described help page codata_combo2. study trial_AB, risk DLT studied function dose two drugs, drug drug B. Historical information toxicity profiles two drugs available single agent trials trial_A trial_B. Another study IIT run concurrently trial_AB, studies combination. model described Neuenschwander, et al (2016) adapted follows. groups \\(j = 1,\\ldots, 4\\) representing four sources data mentioned , $$\\text{logit}\\, \\pi_{1j}(d_1) = \\log\\, \\alpha_{1j} + \\beta_{1j} \\, \\log\\, \\Bigl(\\frac{d_1}{d_1^*}\\Bigr),$$ $$\\text{logit}\\, \\pi_{2j}(d_2) = \\log\\, \\alpha_{2j} + \\beta_{2j} \\, \\log\\, \\Bigl(\\frac{d_2}{d_2^*}\\Bigr),$$ logistic regressions single-agent toxicity drugs B, respectively, administered group \\(j\\). Conditional regression parameters \\(\\boldsymbol\\theta_{1j} = (\\log \\, \\alpha_{1j}, \\log \\, \\beta_{1j})\\) \\(\\boldsymbol\\theta_{2j} = (\\log \\, \\alpha_{2j}, \\log \\, \\beta_{2j})\\), toxicity \\(\\pi_{j}(d_1, d_2)\\) combination modeled \"-interaction\" DLT rate, $$\\tilde\\pi_{j}(d_1, d_2) = 1 - (1-\\pi_{1j}(d_1) )(1- \\pi_{2j}(d_2))$$ single interaction term added log odds scale, $$\\text{logit} \\, \\pi_{j}(d_1, d_2) = \\text{logit} \\, \\tilde\\pi_{j}(d_1, d_2) + \\eta_j \\frac{d_1}{d_1^*}\\frac{d_2}{d_2^*}.$$ hierarchical model across four groups \\(j\\) allows dose-toxicity information shared common hyperparameters. component parameters \\(\\boldsymbol\\theta_{ij}\\), $$\\boldsymbol\\theta_{ij} \\sim \\text{BVN}(\\boldsymbol \\mu_i, \\boldsymbol\\Sigma_i).$$ mean, prior specified $$\\boldsymbol\\mu_i = (\\mu_{\\alpha }, \\mu_{\\beta }) \\sim \\text{BVN}(\\boldsymbol m_i, \\boldsymbol S_i),$$ manuscript prior \\(\\boldsymbol m_i = (\\text{logit}\\, 0.1, \\log 1)\\) \\(\\boldsymbol S_i  = \\text{diag}(3.33^2, 1^2)\\) \\(= 1,2\\) used, deviate use instead \\(\\boldsymbol m_i = (\\text{logit}\\, 0.2, \\log 1)\\) \\(\\boldsymbol S_i  = \\text{diag}(2^2, 1^2)\\). standard deviations correlation parameters covariance matrix, $$\\boldsymbol\\Sigma_i = \\left( \\begin{array}{cc} \\tau^2_{\\alpha } & \\rho_i \\tau_{\\alpha } \\tau_{\\beta }\\\\ \\rho_i \\tau_{\\alpha } \\tau_{\\beta } & \\tau^2_{\\beta } \\end{array} \\right), $$ specified priors \\(\\tau_{\\alpha } \\sim \\text{Log-Normal}(\\log\\, 0.25, ((\\log 4) / 1.96)^2)\\), \\(\\tau_{\\beta } \\sim \\text{Log-Normal}(\\log\\, 0.125, ((\\log 4) / 1.96)^2)\\), \\(\\rho_i \\sim \\text{U}(-1,1)\\) \\(= 1,2\\). interaction parameters \\(\\eta_j\\) group, hierarchical model $$\\eta_j \\sim \\text{N}(\\mu_\\eta, \\tau^2_\\eta),$$ \\(j = 1,\\ldots, 4\\), \\(\\mu_\\eta \\sim \\text{N}(0, 1.121^2)\\) \\(\\tau_\\eta \\sim \\text{Log-Normal}(\\log\\, 0.125, ((\\log 4) / 1.96)^2).\\) syntax specifying fully exchangeable model blrm_exnex.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/example-combo2.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Two-drug combination example — example-combo2","text":"Neuenschwander, B., Roychoudhury, S., & Schmidli, H. (2016). use co-data clinical trials. Statistics Biopharmaceutical Research, 8(3), 345-354.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/example-combo2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Two-drug combination example — example-combo2","text":"","code":"## Setting up dummy sampling for fast execution of example ## Please use 4 chains and 100x more warmup & iter in practice .user_mc_options <- options(   OncoBayes2.MC.warmup = 10, OncoBayes2.MC.iter = 20, OncoBayes2.MC.chains = 1,   OncoBayes2.MC.save_warmup = FALSE )  dref <- c(6, 960)  num_comp   <- 2 # two investigational drugs num_inter  <- 1 # one drug-drug interaction needs to be modeled num_groups <- nlevels(codata_combo2$group_id) # no stratification needed num_strata <- 1 # no stratification needed  blrmfit <- blrm_exnex(   cbind(num_toxicities, num_patients - num_toxicities) ~     1 + I(log(drug_A / dref[1])) |       1 + I(log(drug_B / dref[2])) |       0 + I(drug_A / dref[1] * drug_B / dref[2]) |       group_id,   data = codata_combo2,   prior_EX_mu_comp  = list(mixmvnorm(c(1, logit(0.2), 0, diag(c(2^2, 1)))),                            mixmvnorm(c(1, logit(0.2), 0, diag(c(2^2, 1))))),   prior_EX_tau_comp = list(mixmvnorm(c(1,                                        log(0.250), log(0.125),                                        diag(c(log(4)/1.96, log(4)/1.96)^2))),                            mixmvnorm(c(1,                                        log(0.250), log(0.125),                                        diag(c(log(4)/1.96, log(4)/1.96)^2)))),   prior_EX_mu_inter = mixmvnorm(c(1, 0, 1.121^2)),   prior_EX_tau_inter = mixmvnorm(c(1, log(0.125), (log(4) / 1.96)^2)),   prior_is_EXNEX_comp = rep(FALSE, num_comp),   prior_is_EXNEX_inter = rep(FALSE, num_inter),   prior_EX_prob_comp = matrix(1, nrow = num_groups, ncol = num_comp),   prior_EX_prob_inter = matrix(1, nrow = num_groups, ncol = num_inter),   prior_tau_dist = 1 ) #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess ## Recover user set sampling defaults options(.user_mc_options)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/example-combo2_trial.html","id":null,"dir":"Reference","previous_headings":"","what":"Two-drug combination example using BLRM Trial — example-combo2_trial","title":"Two-drug combination example using BLRM Trial — example-combo2_trial","text":"Example using blrm_trial() guide built-two-drug combination study example.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/example-combo2_trial.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Two-drug combination example using BLRM Trial — example-combo2_trial","text":"blrm_trial() used collect store relevant design information example. Subsequent use update.blrm_trial() command allows convenient model fitting via blrm_exnex(). summary.blrm_trial() method allows exploration design modeling results. run example, use example_model(\"combo2_trial\"). See example_model().","code":""},{"path":[]},{"path":"http://opensource.nibr.com/OncoBayes2/reference/example-combo2_trial.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Two-drug combination example using BLRM Trial — example-combo2_trial","text":"","code":"## Setting up dummy sampling for fast execution of example ## Please use 4 chains and 100x more warmup & iter in practice .user_mc_options <- options(   OncoBayes2.MC.warmup = 10, OncoBayes2.MC.iter = 20, OncoBayes2.MC.chains = 1,   OncoBayes2.MC.save_warmup = FALSE )  library(tibble) library(dplyr) library(tidyr)  # Combo2 example using blrm_trial functionality  # construct initial blrm_trial object from built-in example datasets combo2_trial_setup <- blrm_trial(   data = hist_combo2,   dose_info = dose_info_combo2,   drug_info = drug_info_combo2,   simplified_prior = FALSE ) #> No stratum defined - assigning all groups to single stratum \"all\" #> Please configure blrm_exnex using the update() function.  # summary of dimensionality of data structures dims <- summary(combo2_trial_setup, \"dimensionality\")  # Fit the initial model with the historical data and fully specified prior   combo2_trial_start <- update(    combo2_trial_setup,    ## bivariate normal prior for drug A and drug B of intercept and    ## log-slope    prior_EX_mu_comp =      replicate(2,                mixmvnorm(c(1,                            logit(0.2), 0,                            diag(c(2^2, 1))))              , FALSE),    prior_EX_tau_comp =      replicate(2,                mixmvnorm(c(1,                            log(0.25), log(0.125),                            diag(c(log(4)/1.96, log(4)/1.96)^2)))              , FALSE),    prior_EX_mu_inter = mixmvnorm(c(1, 0, 1.121^2)),    prior_EX_tau_inter = mixmvnorm(c(1, log(0.125), (log(4) / 1.96)^2)),    prior_is_EXNEX_comp = c(FALSE, FALSE),    prior_is_EXNEX_inter = FALSE,    prior_EX_prob_comp = matrix(1,      nrow = dims$num_groups,      ncol = 2    ),    prior_EX_prob_inter = matrix(1,      nrow = nlevels(dose_info_combo2$group_id),      ncol = 1    ),    prior_tau_dist = 1  ) #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess #> Warning: 11 out of 42 ewoc metrics have not converged (some Rhats are > 1.1). #> Be careful when analysing the results! It is recommended to run #> more iterations and/or setting stronger priors. #> You may call \"summary(trial, summarize='ewoc_check', ...)\" for more diagnostic details. #> Please call \"help('blrm_trial', help_type='summary')\" for further documentation. #> Warning: 16 out of 42 ewoc metrics are within the 95% MCMC error of the decision boundary. #> Be careful when using the imprecise ewoc estimates! It is recommended to run #> more iterations and review doses close to critical thresholds. #> You may call \"summary(trial, summarize='ewoc_check', ...)\" for more diagnostic details. #> Please call \"help('blrm_trial', help_type='summary')\" for further documentation.  # print summary of prior specification prior_summary(combo2_trial_start) #> Bayesian Logistic Regression Model with EXchangeability-NonEXchangeability #>  #> Mixture configuration #> --------------------- #> EXNEX components : 0  #> component #>    I(log(drug_A/6)) I(log(drug_B/1500))  #>                   0                   0  #>  #> EXNEX interactions: 0  #> interaction #> I(2 * (drug_A/6 * drug_B/1500)/(1 + drug_A/6 * drug_B/1500))  #>                                                            0  #>  #> Prior probability for exchangeability per group #>           component #> group      I(log(drug_A/6)) I(log(drug_B/1500)) #>   trial_A                 1                   1 #>   trial_B                 1                   1 #>   IIT                     1                   1 #>   trial_AB                1                   1 #>  #>           interaction #> group      I(2 * (drug_A/6 * drug_B/1500)/(1 + drug_A/6 * drug_B/1500)) #>   trial_A                                                             1 #>   trial_B                                                             1 #>   IIT                                                                 1 #>   trial_AB                                                            1 #>  #> EXchangable hyperparameter priors #> --------------------------------- #> Component parameters #> Mean mu_log_beta #>                            prior weight m_intercept m_log_slope s_intercept s_log_slope  rho #> component           mix                                                                      #> I(log(drug_A/6))    comp_1          1.0        -1.4         0.0         2.0         1.0  0.0 #> I(log(drug_B/1500)) comp_1          1.0        -1.4         0.0         2.0         1.0  0.0 #>  #> Heterogeneity tau_log_beta (log-normal) #>                                      prior weight m_tau_intercept m_tau_log_slope s_tau_intercept s_tau_log_slope   rho #> stratum   component           mix                                                                                       #> stratum_1 I(log(drug_A/6))    comp_1         1.00           -1.39           -2.08            0.71            0.71  0.00 #>           I(log(drug_B/1500)) comp_1         1.00           -1.39           -2.08            0.71            0.71  0.00 #>  #> Correlation LKJ #> component #>    I(log(drug_A/6)) I(log(drug_B/1500))  #>                   1                   1  #>  #> Interaction parameters #> Mean mu_eta #>       prior   w m[1] s[1] #> mix                       #> comp1       1.0  0.0  1.1 #>  #> Heterogeneity tau_eta (log-normal) #>                 prior     w  m[1]  s[1] #> stratum   mix                           #> stratum_1 comp1        1.00 -2.08  0.71 #>  #> Correlation LKJ #> interaction  #>           1  #>  #> NonEXchangable priors #> --------------------- #> Component parameters #> Mean mu_log_beta #>                            prior weight m_intercept m_log_slope s_intercept s_log_slope  rho #> component           mix                                                                      #> I(log(drug_A/6))    comp_1          1.0        -1.4         0.0         2.0         1.0  0.0 #> I(log(drug_B/1500)) comp_1          1.0        -1.4         0.0         2.0         1.0  0.0 #>  #> Interaction parameters #> Mean mu_eta #>       prior   w m[1] s[1] #> mix                       #> comp1       1.0  0.0  1.1  # summarize inference at observed dose levels summary(combo2_trial_start, \"data_prediction\") #> # A tibble: 11 × 17 #>    group_id drug_A drug_B num_patients num_toxicities cohort_time stratum_id #>    <fct>     <dbl>  <dbl>        <dbl>          <dbl>       <dbl> <fct>      #>  1 trial_A     3      0              3              0           0 all        #>  2 trial_A     4.5    0              3              0           0 all        #>  3 trial_A     6      0              6              0           0 all        #>  4 trial_A     8      0              3              2           0 all        #>  5 trial_B     0     33.3            3              0           0 all        #>  6 trial_B     0     50              3              0           0 all        #>  7 trial_B     0    100              4              0           0 all        #>  8 trial_B     0    200              9              0           0 all        #>  9 trial_B     0    400             15              0           0 all        #> 10 trial_B     0    800             20              2           0 all        #> 11 trial_B     0   1120             17              4           0 all        #> # ℹ 10 more variables: dose_id <int>, mean <dbl>, sd <dbl>, `2.5%` <dbl>, #> #   `50%` <dbl>, `97.5%` <dbl>, prob_underdose <dbl>, prob_target <dbl>, #> #   prob_overdose <dbl>, ewoc_ok <lgl>  # summarize inference at specified dose levels summary(combo2_trial_start, \"dose_prediction\") #> # A tibble: 42 × 14 #>    group_id drug_A drug_B dose_id stratum_id   mean     sd   `2.5%`   `50%` #>    <fct>     <dbl>  <dbl>   <int> <fct>       <dbl>  <dbl>    <dbl>   <dbl> #>  1 trial_A     3        0       1 all        0.0142 0.0138 0.000137 0.00842 #>  2 trial_A     4.5      0       2 all        0.0522 0.0379 0.00545  0.0498  #>  3 trial_A     6        0       3 all        0.144  0.0903 0.0652   0.0982  #>  4 trial_A     8        0       4 all        0.373  0.202  0.141    0.380   #>  5 IIT         0      400       5 all        0.0445 0.0727 0.000623 0.00830 #>  6 IIT         0      600       6 all        0.0641 0.0925 0.00287  0.0183  #>  7 IIT         0      800       7 all        0.0869 0.107  0.00821  0.0366  #>  8 IIT         3        0       8 all        0.0212 0.0269 0.000382 0.0136  #>  9 IIT         3      400       9 all        0.0728 0.112  0.00518  0.0318  #> 10 IIT         3      600      10 all        0.0967 0.142  0.00701  0.0407  #> # ℹ 32 more rows #> # ℹ 5 more variables: `97.5%` <dbl>, prob_underdose <dbl>, prob_target <dbl>, #> #   prob_overdose <dbl>, ewoc_ok <lgl>   # Update again with new data  # using update() with data argument supplied # dem <- update(combo2_trial_start, data = codata_combo2)  # alternate way using update() with add_data argument for # new observations only (those collected after the trial # design stage). new_data <- filter(codata_combo2, cohort_time > 0)  combo2_trial <- update(combo2_trial_start, add_data = new_data) #> stratum_id not given, but only one stratum defined. Assigning first stratum. #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess #> Warning: 17 out of 42 ewoc metrics have not converged (some Rhats are > 1.1). #> Be careful when analysing the results! It is recommended to run #> more iterations and/or setting stronger priors. #> You may call \"summary(trial, summarize='ewoc_check', ...)\" for more diagnostic details. #> Please call \"help('blrm_trial', help_type='summary')\" for further documentation. #> Warning: 11 out of 42 ewoc metrics are within the 95% MCMC error of the decision boundary. #> Be careful when using the imprecise ewoc estimates! It is recommended to run #> more iterations and review doses close to critical thresholds. #> You may call \"summary(trial, summarize='ewoc_check', ...)\" for more diagnostic details. #> Please call \"help('blrm_trial', help_type='summary')\" for further documentation.  summary(combo2_trial, \"data\") # cohort_time is tracked #> # A tibble: 27 × 8 #>    group_id drug_A drug_B num_patients num_toxicities cohort_time stratum_id #>    <fct>     <dbl>  <dbl>        <dbl>          <dbl>       <dbl> <fct>      #>  1 trial_A     3      0              3              0           0 all        #>  2 trial_A     4.5    0              3              0           0 all        #>  3 trial_A     6      0              6              0           0 all        #>  4 trial_A     8      0              3              2           0 all        #>  5 trial_B     0     33.3            3              0           0 all        #>  6 trial_B     0     50              3              0           0 all        #>  7 trial_B     0    100              4              0           0 all        #>  8 trial_B     0    200              9              0           0 all        #>  9 trial_B     0    400             15              0           0 all        #> 10 trial_B     0    800             20              2           0 all        #> # ℹ 17 more rows #> # ℹ 1 more variable: dose_id <int> summary(combo2_trial, \"data_prediction\") #> # A tibble: 27 × 17 #>    group_id drug_A drug_B num_patients num_toxicities cohort_time stratum_id #>    <fct>     <dbl>  <dbl>        <dbl>          <dbl>       <dbl> <fct>      #>  1 trial_A     3      0              3              0           0 all        #>  2 trial_A     4.5    0              3              0           0 all        #>  3 trial_A     6      0              6              0           0 all        #>  4 trial_A     8      0              3              2           0 all        #>  5 trial_B     0     33.3            3              0           0 all        #>  6 trial_B     0     50              3              0           0 all        #>  7 trial_B     0    100              4              0           0 all        #>  8 trial_B     0    200              9              0           0 all        #>  9 trial_B     0    400             15              0           0 all        #> 10 trial_B     0    800             20              2           0 all        #> # ℹ 17 more rows #> # ℹ 10 more variables: dose_id <int>, mean <dbl>, sd <dbl>, `2.5%` <dbl>, #> #   `50%` <dbl>, `97.5%` <dbl>, prob_underdose <dbl>, prob_target <dbl>, #> #   prob_overdose <dbl>, ewoc_ok <lgl> summary(combo2_trial, \"dose_prediction\") #> # A tibble: 42 × 14 #>    group_id drug_A drug_B dose_id stratum_id     mean       sd    `2.5%`   `50%` #>    <fct>     <dbl>  <dbl>   <int> <fct>         <dbl>    <dbl>     <dbl>   <dbl> #>  1 trial_A     3        0       1 all        0.000317 0.000580   6.95e-6 6.01e-5 #>  2 trial_A     4.5      0       2 all        0.00616  0.00688    9.10e-4 3.03e-3 #>  3 trial_A     6        0       3 all        0.0624   0.0316     2.69e-2 6.29e-2 #>  4 trial_A     8        0       4 all        0.482    0.0967     3.14e-1 4.72e-1 #>  5 IIT         0      400       5 all        0.0915   0.0849     7.11e-3 6.60e-2 #>  6 IIT         0      600       6 all        0.168    0.130      3.31e-2 1.29e-1 #>  7 IIT         0      800       7 all        0.258    0.157      8.15e-2 2.39e-1 #>  8 IIT         3        0       8 all        0.000456 0.000550   8.57e-6 2.21e-4 #>  9 IIT         3      400       9 all        0.102    0.0682     1.65e-2 8.36e-2 #> 10 IIT         3      600      10 all        0.213    0.0769     9.70e-2 2.14e-1 #> # ℹ 32 more rows #> # ℹ 5 more variables: `97.5%` <dbl>, prob_underdose <dbl>, prob_target <dbl>, #> #   prob_overdose <dbl>, ewoc_ok <lgl>  rm(dims, new_data)  ## Recover user set sampling defaults options(.user_mc_options)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/example-combo3.html","id":null,"dir":"Reference","previous_headings":"","what":"Three-drug combination example — example-combo3","title":"Three-drug combination example — example-combo3","text":"Example using combination two experimental drugs, EXNEX differential discounting.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/example-combo3.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Three-drug combination example — example-combo3","text":"dataset involves hypothetical dose-escalation study combination therapy three treatment components. two previous studies HistAgent1 HistAgent2, historical data available treatments single-agents, well two two-way combinations. However, due difference treatment schedule Combo study historical studies, stratification (stratum_id) made groups allow differential discounting alternate-schedule data. association . additional robustness, EXNEX priors used group-level treatment components interaction parameters. limit amount borrowing case significant heterogeneity across groups. complete model follows. function doses \\(d_1,d_2,d_3\\), DLT rate group \\(j\\) , \\(j = 1,\\ldots,3\\), $$\\text{logit}\\, \\pi_j(d_1,d_2,d_3) = \\text{logit}\\Bigl( 1 - \\prod_{=1}^3 (1-\\pi_{ij}(d_i))\\Bigr) + \\eta_{j}^{(12)}\\frac{d_1}{d_1^*}\\frac{d_2}{d_2^*} + \\eta_{j}^{(13)}\\frac{d_1}{d_1^*}\\frac{d_3}{d_3^*} + \\eta_{j}^{(23)}\\frac{d_2}{d_2^*}\\frac{d_3}{d_3^*} + \\eta_{j}^{(123)}\\frac{d_1}{d_1^*}\\frac{d_2}{d_2^*}\\frac{d_3}{d_3^*}.$$ group \\(j\\) treatment component \\(\\) toxicity modeled logistic regression, $$\\text{logit}\\, \\pi_{ij}(d_i) = \\log\\, \\alpha_{ij} + \\beta_{ij} \\, \\log\\, \\Bigl(\\frac{d_i}{d_i^*}\\Bigr).$$ intercept log-slope parameters \\(\\boldsymbol\\theta_{ij} = (\\log\\, \\alpha_{ij}, \\log\\, \\beta_{ij})\\) given EXNEX prior $$\\boldsymbol\\theta_{ij} \\sim p_{ij} \\text{BVN}(\\boldsymbol\\mu_i, \\boldsymbol\\Sigma_{ij}) + (1-p_{ij}) \\text{BVN}(\\boldsymbol m_{ij}, \\boldsymbol S_{ij}),$$ exchangeability weights \\(p_{ij} = 0.9\\). NEX parameters set \\(\\boldsymbol m_{ij} = (\\text{logit}(1/3), \\log\\, 1)\\), \\(\\boldsymbol S_{ij} = \\text{diag}(2^2, 1^2)\\) components \\(=1,2,3\\) groups \\(j = 1,2,3\\), EX parameters modeled hierarchically. mean exchangeable part distribution $$\\boldsymbol\\mu_i = (\\mu_{\\alpha }, \\mu_{\\beta }) \\sim \\text{BVN}(\\boldsymbol m_i, \\boldsymbol S_i),$$ \\(\\boldsymbol m_i = (\\text{logit}(1/3), \\log 1)\\) \\(\\boldsymbol S_i  = \\text{diag}(2^2, 1^2)\\) component \\(= 1,2,3\\). differentially discounting data schedule (QD BID), covariance parameters exchangeable part $$\\Sigma_{ij} = \\left( \\begin{array}{cc} \\tau^2_{\\alpha s_j } & \\rho_i \\tau_{\\alpha s_j } \\tau_{\\beta s_j }\\\\ \\rho_i \\tau_{\\alpha s_j } \\tau_{\\beta s_j } & \\tau^2_{\\beta s_j } \\end{array} \\right).$$ allowed vary across groups \\(j\\) depending mapping strata \\(s(j)\\) described . stratum \\(s=1\\) (BID, contains group \\(j = 1\\) (Combo)), standard deviations modeled $$\\tau_{\\alpha 1 } \\sim \\text{Log-Normal}(\\log\\,0.25, (\\log 4 / 1.96)^2)$$ $$\\tau_{\\beta 1 } \\sim \\text{Log-Normal}(\\log\\,0.125, (\\log 4 / 1.96)^2).$$ Whereas stratum \\(s=2\\) (QD, contains historical groups \\(j=2,3\\) (HistData1, HistData2)), standard deviations $$\\tau_{\\alpha 2 } \\sim \\text{Log-Normal}(\\log\\,0.5, (\\log 4 / 1.96)^2)$$ $$\\tau_{\\beta 2 } \\sim \\text{Log-Normal}(\\log\\,0.25, (\\log 4 / 1.96)^2).$$ interaction parameters \\(\\eta_{j}^{(12)}\\), \\(\\eta_{j}^{(13)}\\), \\(\\eta_{j}^{(23)}\\), \\(\\eta_{j}^{(123)}\\) (\\(j = 1,2,3\\)), following prior assumed: $$\\eta_{j}^{(\\cdot)} \\sim  \\text{N}(\\mu_{\\eta}^{(\\cdot)},{\\tau_{\\eta s_j}^{(\\cdot)}}^2).$$ exchangeability weights \\(p_{\\eta j}^{(\\cdot)} = 0.9\\) parameters EXNEX. , \\(\\mu_{\\eta}^{(12)}\\), \\(\\mu_{\\eta}^{(13)}\\), \\(\\mu_{\\eta}^{(23)}\\), \\(\\mu_{\\eta}^{(123)}\\), take $$\\mu_{\\eta}^{(\\cdot)} \\sim \\text{N}(0, 1/2),$$ \\(\\tau_{\\eta s}^{(12)}\\), \\(\\tau_{\\eta s}^{(13)}\\), \\(\\tau_{\\eta s}^{(23)}\\), \\(\\tau_{\\eta s}^{(123)}\\), $$\\tau_{\\eta s}^{(\\cdot)} \\sim \\text{Log-Normal}(\\log(0.25), (\\log 2 / 1.96)^2),$$ strata \\(s = 1,2\\). syntax specifying model blrm_exnex.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/example-combo3.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Three-drug combination example — example-combo3","text":"Neuenschwander, B., Roychoudhury, S., & Schmidli, H. (2016). use co-data clinical trials. Statistics Biopharmaceutical Research, 8(3), 345-354.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/example-combo3.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Three-drug combination example — example-combo3","text":"","code":"## Setting up dummy sampling for fast execution of example ## Please use 4 chains and 100x more warmup & iter in practice .user_mc_options <- options(   OncoBayes2.MC.warmup = 10, OncoBayes2.MC.iter = 20, OncoBayes2.MC.chains = 1,   OncoBayes2.MC.save_warmup = FALSE )  ## example combo3  library(abind)  dref <- c(500, 500, 1000) num_comp <- 3 num_inter <- choose(3, 2) + 1 num_strata <- nlevels(hist_combo3$stratum_id) num_groups <- nlevels(hist_combo3$group_id)  blrmfit <- blrm_exnex(   cbind(num_toxicities, num_patients - num_toxicities) ~     1 + I(log(drug_A / dref[1])) |       1 + I(log(drug_B / dref[2])) |       1 + I(log(drug_C / dref[3])) |       0       + I(drug_A / dref[1] * drug_B / dref[2])         + I(drug_A / dref[1] * drug_C / dref[3])         + I(drug_B / dref[2] * drug_C / dref[3])         + I(drug_A / dref[1] * drug_B / dref[2] * drug_C / dref[3]) |       stratum_id / group_id,   data = hist_combo3,   prior_EX_mu_comp = replicate(num_comp, mixmvnorm(c(1, logit(1/3), 0, diag(c(2^2, 1)))), FALSE),   prior_EX_tau_comp = list(replicate(num_comp,                                      mixmvnorm(c(1, log(c(0.25, 0.125)),                                                diag(c(log(4)/1.96, log(4)/1.96)^2))), FALSE),                            replicate(num_comp,                                      mixmvnorm(c(1, log(2 * c(0.25, 0.125)),                                                diag(c(log(4)/1.96, log(4)/1.96)^2))), FALSE)),   prior_EX_mu_inter = mixmvnorm(c(1, rep.int(0, num_inter),                                      diag((rep.int(sqrt(2) / 2, num_inter))^2))),   prior_EX_tau_inter = replicate(num_strata,                                  mixmvnorm(c(1, rep.int(log(0.25), num_inter),                                              diag((rep.int(log(2) / 1.96, num_inter))^2))), FALSE),   prior_EX_prob_comp = matrix(0.9, nrow = num_groups, ncol = num_comp),   prior_EX_prob_inter = matrix(1.0, nrow = num_groups, ncol = num_inter),   prior_is_EXNEX_comp = rep(TRUE, num_comp),   prior_is_EXNEX_inter = rep(FALSE, num_inter),   prior_tau_dist = 1,   prior_PD = FALSE ) #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess ## Recover user set sampling defaults options(.user_mc_options)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/example-single-agent.html","id":null,"dir":"Reference","previous_headings":"","what":"Single Agent Example — example-single-agent","title":"Single Agent Example — example-single-agent","text":"Example using single experimental drug.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/example-single-agent.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Single Agent Example — example-single-agent","text":"single agent example described reference Neuenschwander, B. et al (2008). data described help page hist_SA. case, data come one study, treatment single agent. Hence model specified involve hierarchical prior intercept log-slope parameters. model described Neuenschwander, et al (2008) adapted follows: $$\\text{logit}\\, \\pi(d) = \\log\\, \\alpha + \\beta \\, \\log\\, \\Bigl(\\frac{d}{d^*}\\Bigr),$$ \\(d^* = 250\\), prior \\(\\boldsymbol\\theta = (\\log\\, \\alpha, \\log\\, \\beta)\\) $$\\boldsymbol\\theta \\sim \\text{N}(\\boldsymbol m, \\boldsymbol S),$$ \\(\\boldsymbol m = (\\text{logit}\\, 0.5, \\log\\, 1)\\) \\(\\boldsymbol S = \\text{diag}(2^2, 1^2)\\) constants. model non-hierarchical. disable hierarchical model structure blrm_exnex framework, user can specify option prior_tau_dist=NULL. internally set heterogeniety parameters (\\(\\tau^2_\\alpha\\) \\(\\tau^2_\\beta\\)) zero.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/example-single-agent.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Single Agent Example — example-single-agent","text":"Neuenschwander, B., Branson, M., & Gsponer, T. (2008). Critical aspects Bayesian approach phase cancer trials. Statistics medicine, 27(13), 2420-2439.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/example-single-agent.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Single Agent Example — example-single-agent","text":"","code":"## Setting up dummy sampling for fast execution of example ## Please use 4 chains and 100x more warmup & iter in practice .user_mc_options <- options(   OncoBayes2.MC.warmup = 10, OncoBayes2.MC.iter = 20, OncoBayes2.MC.chains = 1,   OncoBayes2.MC.save_warmup = FALSE )  ## Example from Neuenschwander, B., et al. (2009). Stats in Medicine  dref <- 50  ## Since there is no prior information the hierarchical model ## is not used in this example by setting tau to (almost) 0. blrmfit <- blrm_exnex(   cbind(num_toxicities, num_patients - num_toxicities) ~       1 + log(drug_A / dref) |       0 |       group_id,   data = hist_SA,   prior_EX_mu_comp = mixmvnorm(c(1, logit(1 / 2), log(1), diag(c(2^2, 1)))),   ## Setting prior_tau_dist=NULL disables the hierarchical prior which is   ## not required in this example as we analyze a single trial.   prior_tau_dist = NULL,   prior_PD = FALSE ) #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess ## Recover user set sampling defaults options(.user_mc_options)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/example_model.html","id":null,"dir":"Reference","previous_headings":"","what":"Runs example models — example_model","title":"Runs example models — example_model","text":"Runs example models","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/example_model.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Runs example models — example_model","text":"","code":"example_model(topic, envir = parent.frame(), silent = FALSE)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/example_model.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Runs example models — example_model","text":"topic example run envir environment example loaded . Defaults caller environment. silent logical controlling execution run silently (defaults FALSE)","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/example_model.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Runs example models — example_model","text":"topic specified list possible topics return. Whenever valid topic specified, function inserts example environment given returns (invisibly) updated environment.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/example_model.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Runs example models — example_model","text":"","code":"## Setting up dummy sampling for fast execution of example ## Please use 4 chains and 100x more warmup & iter in practice .user_mc_options <- options(   OncoBayes2.MC.warmup = 10, OncoBayes2.MC.iter = 20, OncoBayes2.MC.chains = 1,   OncoBayes2.MC.save_warmup = FALSE )   ## get a list of available examples example_model() #> [1] \"combo2_trial\" \"combo2\"       \"combo3\"       \"single_agent\"  ## run 3 component example example_model(\"combo3\") #> Running combo3 example: #>  ## example combo3 #>  #>  library(abind) #>  #>  dref <- c(500, 500, 1000) #>  num_comp <- 3 #>  num_inter <- choose(3, 2) + 1 #>  num_strata <- nlevels(hist_combo3$stratum_id) #>  num_groups <- nlevels(hist_combo3$group_id) #>  #>  blrmfit <- blrm_exnex( #>    cbind(num_toxicities, num_patients - num_toxicities) ~ #>      1 + I(log(drug_A / dref[1])) | #>        1 + I(log(drug_B / dref[2])) | #>        1 + I(log(drug_C / dref[3])) | #>        0 #>        + I(drug_A / dref[1] * drug_B / dref[2]) #>          + I(drug_A / dref[1] * drug_C / dref[3]) #>          + I(drug_B / dref[2] * drug_C / dref[3]) #>          + I(drug_A / dref[1] * drug_B / dref[2] * drug_C / dref[3]) | #>        stratum_id / group_id, #>    data = hist_combo3, #>    prior_EX_mu_comp = replicate(num_comp, mixmvnorm(c(1, logit(1/3), 0, diag(c(2^2, 1)))), FALSE), #>    prior_EX_tau_comp = list(replicate(num_comp, #>                                       mixmvnorm(c(1, log(c(0.25, 0.125)), #>                                                 diag(c(log(4)/1.96, log(4)/1.96)^2))), FALSE), #>                             replicate(num_comp, #>                                       mixmvnorm(c(1, log(2 * c(0.25, 0.125)), #>                                                 diag(c(log(4)/1.96, log(4)/1.96)^2))), FALSE)), #>    prior_EX_mu_inter = mixmvnorm(c(1, rep.int(0, num_inter), #>                                       diag((rep.int(sqrt(2) / 2, num_inter))^2))), #>    prior_EX_tau_inter = replicate(num_strata, #>                                   mixmvnorm(c(1, rep.int(log(0.25), num_inter), #>                                               diag((rep.int(log(2) / 1.96, num_inter))^2))), FALSE), #>    prior_EX_prob_comp = matrix(0.9, nrow = num_groups, ncol = num_comp), #>    prior_EX_prob_inter = matrix(1.0, nrow = num_groups, ncol = num_inter), #>    prior_is_EXNEX_comp = rep(TRUE, num_comp), #>    prior_is_EXNEX_inter = rep(FALSE, num_inter), #>    prior_tau_dist = 1, #>    prior_PD = FALSE #>  ) #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess  ## Recover user set sampling defaults options(.user_mc_options)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/hist_SA.html","id":null,"dir":"Reference","previous_headings":"","what":"Single-agent example — hist_SA","title":"Single-agent example — hist_SA","text":"Example data application Neuenschwander, et. al. 2008, \"open-label, multicenter, non-comparative, dose-escalation cancer trial characterize safety, tolerability, pharmacokinetic profile drug determine MTD.\"","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/hist_SA.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Single-agent example — hist_SA","text":"","code":"hist_SA"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/hist_SA.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Single-agent example — hist_SA","text":"data frame 5 rows 4 variables: group_id study drug_A dose num_patients number patients num_toxicities number events","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/hist_SA.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Single-agent example — hist_SA","text":"Neuenschwander, B., Branson, M., & Gsponer, T. (2008). Critical aspects Bayesian approach phase cancer trials. Statistics medicine, 27(13), 2420-2439.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/hist_SA.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Single-agent example — hist_SA","text":"","code":"## Setting up dummy sampling for fast execution of example ## Please use 4 chains and 100x more warmup & iter in practice .user_mc_options <- options(   OncoBayes2.MC.warmup = 10, OncoBayes2.MC.iter = 20, OncoBayes2.MC.chains = 1,   OncoBayes2.MC.save_warmup = FALSE )  ## Example from Neuenschwander, B., et al. (2009). Stats in Medicine  dref <- 50  ## Since there is no prior information the hierarchical model ## is not used in this example by setting tau to (almost) 0. blrmfit <- blrm_exnex(   cbind(num_toxicities, num_patients - num_toxicities) ~       1 + log(drug_A / dref) |       0 |       group_id,   data = hist_SA,   prior_EX_mu_comp = mixmvnorm(c(1, logit(1 / 2), log(1), diag(c(2^2, 1)))),   ## Setting prior_tau_dist=NULL disables the hierarchical prior which is   ## not required in this example as we analyze a single trial.   prior_tau_dist = NULL,   prior_PD = FALSE ) #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess ## Recover user set sampling defaults options(.user_mc_options)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/hist_combo2.html","id":null,"dir":"Reference","previous_headings":"","what":"Dataset: historical data on two single-agents to inform a combination study — hist_combo2","title":"Dataset: historical data on two single-agents to inform a combination study — hist_combo2","text":"One two datasets application described Neuenschwander et al (2016). risk DLT studied function dose two drugs, drug drug B. Historical information toxicity profiles two drugs available single agent trials trial_A trial_B. second dataset codata_combo2 available application, includes additional dose-toxicity data trial_AB IIT combination Drugs B.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/hist_combo2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dataset: historical data on two single-agents to inform a combination study — hist_combo2","text":"","code":"hist_combo2"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/hist_combo2.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Dataset: historical data on two single-agents to inform a combination study — hist_combo2","text":"tibble 11 rows 5 variables: group_id study drug_A dose Drug drug_B dose Drug B num_patients number patients num_toxicities number DLTs cohort_time cohort number patients","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/hist_combo2.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"Dataset: historical data on two single-agents to inform a combination study — hist_combo2","text":"Neuenschwander, B., Roychoudhury, S., & Schmidli, H. (2016). use co-data clinical trials. Statistics Biopharmaceutical Research, 8(3), 345-354.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/hist_combo3.html","id":null,"dir":"Reference","previous_headings":"","what":"Dataset: historical and concurrent data on a three-way combination — hist_combo3","title":"Dataset: historical and concurrent data on a three-way combination — hist_combo3","text":"dataset involves hypothetical dose-escalation study combination therapy three treatment components. two previous studies HistAgent1 HistAgent2, historical data available treatments single-agents, well two two-way combinations. However, due difference treatment schedule Combo study historical studies, stratification (stratum_id) made groups allow differential discounting alternate-dose data.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/hist_combo3.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Dataset: historical and concurrent data on a three-way combination — hist_combo3","text":"","code":"hist_combo3"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/hist_combo3.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Dataset: historical and concurrent data on a three-way combination — hist_combo3","text":"data frame 18 rows 7 variables: group_id study drug_A dose Drug drug_B dose Drug B drug_C dose Drug C num_patients number patients num_toxicities number DLTs stratum_id stratum group_id's used differential discounting","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/hist_combo3.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Dataset: historical and concurrent data on a three-way combination — hist_combo3","text":"","code":"## Setting up dummy sampling for fast execution of example ## Please use 4 chains and 100x more warmup & iter in practice .user_mc_options <- options(   OncoBayes2.MC.warmup = 10, OncoBayes2.MC.iter = 20, OncoBayes2.MC.chains = 1,   OncoBayes2.MC.save_warmup = FALSE )  ## example combo3  library(abind)  dref <- c(500, 500, 1000) num_comp <- 3 num_inter <- choose(3, 2) + 1 num_strata <- nlevels(hist_combo3$stratum_id) num_groups <- nlevels(hist_combo3$group_id)  blrmfit <- blrm_exnex(   cbind(num_toxicities, num_patients - num_toxicities) ~     1 + I(log(drug_A / dref[1])) |       1 + I(log(drug_B / dref[2])) |       1 + I(log(drug_C / dref[3])) |       0       + I(drug_A / dref[1] * drug_B / dref[2])         + I(drug_A / dref[1] * drug_C / dref[3])         + I(drug_B / dref[2] * drug_C / dref[3])         + I(drug_A / dref[1] * drug_B / dref[2] * drug_C / dref[3]) |       stratum_id / group_id,   data = hist_combo3,   prior_EX_mu_comp = replicate(num_comp, mixmvnorm(c(1, logit(1/3), 0, diag(c(2^2, 1)))), FALSE),   prior_EX_tau_comp = list(replicate(num_comp,                                      mixmvnorm(c(1, log(c(0.25, 0.125)),                                                diag(c(log(4)/1.96, log(4)/1.96)^2))), FALSE),                            replicate(num_comp,                                      mixmvnorm(c(1, log(2 * c(0.25, 0.125)),                                                diag(c(log(4)/1.96, log(4)/1.96)^2))), FALSE)),   prior_EX_mu_inter = mixmvnorm(c(1, rep.int(0, num_inter),                                      diag((rep.int(sqrt(2) / 2, num_inter))^2))),   prior_EX_tau_inter = replicate(num_strata,                                  mixmvnorm(c(1, rep.int(log(0.25), num_inter),                                              diag((rep.int(log(2) / 1.96, num_inter))^2))), FALSE),   prior_EX_prob_comp = matrix(0.9, nrow = num_groups, ncol = num_comp),   prior_EX_prob_inter = matrix(1.0, nrow = num_groups, ncol = num_inter),   prior_is_EXNEX_comp = rep(TRUE, num_comp),   prior_is_EXNEX_inter = rep(FALSE, num_inter),   prior_tau_dist = 1,   prior_PD = FALSE ) #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess ## Recover user set sampling defaults options(.user_mc_options)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/lodds.html","id":null,"dir":"Reference","previous_headings":"","what":"Logit (log-odds) and inverse-logit function. — lodds","title":"Logit (log-odds) and inverse-logit function. — lodds","text":"Calculates logit (log-odds) inverse-logit.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/lodds.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Logit (log-odds) and inverse-logit function. — lodds","text":"","code":"logit(mu)  inv_logit(eta)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/lodds.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Logit (log-odds) and inverse-logit function. — lodds","text":"mu numeric object probabilies, values range \\([0,1]\\). Missing values (NAs) allowed. eta numeric object log-odds values, values range \\([-\\infty,\\infty]\\). Missing values (NAs) allowed.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/lodds.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Logit (log-odds) and inverse-logit function. — lodds","text":"numeric object type mu eta containing logits inverse logit input values.  logit inverse transformation equates $$\\text{logit}(\\mu) = \\log(\\mu/(1-\\mu))$$ $$\\text{logit}^{-1}(\\eta)= \\exp(\\eta)/(1 + \\exp(\\eta)).$$","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/lodds.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Logit (log-odds) and inverse-logit function. — lodds","text":"Values mu equal 0 1 return \\(-\\infty\\) \\(\\infty\\) respectively.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/lodds.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Logit (log-odds) and inverse-logit function. — lodds","text":"","code":"logit(0.2) #> [1] -1.386294 inv_logit(-1.386) #> [1] 0.2000471"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/log_inv_logit.html","id":null,"dir":"Reference","previous_headings":"","what":"Numerically stable summation of log inv logit — log_inv_logit","title":"Numerically stable summation of log inv logit — log_inv_logit","text":"Numerically stable summation log inv logit","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/log_inv_logit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Numerically stable summation of log inv logit — log_inv_logit","text":"","code":"log_inv_logit(mat)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/log_mean_exp.html","id":null,"dir":"Reference","previous_headings":"","what":"Numerically stable mean of logs — log_mean_exp","title":"Numerically stable mean of logs — log_mean_exp","text":"Numerically stable mean logs","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/log_mean_exp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Numerically stable mean of logs — log_mean_exp","text":"","code":"log_mean_exp(x)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/nsamples.blrmfit.html","id":null,"dir":"Reference","previous_headings":"","what":"Return the number of posterior samples — nsamples.blrmfit","title":"Return the number of posterior samples — nsamples.blrmfit","text":"Return number posterior samples","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/nsamples.blrmfit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Return the number of posterior samples — nsamples.blrmfit","text":"","code":"# S3 method for class 'blrmfit' nsamples(object, ...)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/nsamples.blrmfit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Return the number of posterior samples — nsamples.blrmfit","text":"object fitted model object ... used function","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/nsamples.blrmfit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Return the number of posterior samples — nsamples.blrmfit","text":"","code":"## Setting up dummy sampling for fast execution of example ## Please use 4 chains and 100x more warmup & iter in practice .user_mc_options <- options(   OncoBayes2.MC.warmup = 10, OncoBayes2.MC.iter = 20, OncoBayes2.MC.chains = 1,   OncoBayes2.MC.save_warmup = FALSE )   ## run single-agent analysis which defines blrmfit model object example_model(\"single_agent\", silent = TRUE) #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess  nsamples(blrmfit) #> [1] 10  ## Recover user set sampling defaults options(.user_mc_options)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/plot_blrm.html","id":null,"dir":"Reference","previous_headings":"","what":"Plot a fitted model — plot_blrm","title":"Plot a fitted model — plot_blrm","text":"Warning: methods experimental stage development, may change future releases. Plotting methods blrmfit blrm_trial objects.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/plot_blrm.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Plot a fitted model — plot_blrm","text":"","code":"plot_toxicity_curve(object, ...)  plot_toxicity_intervals(object, ...)  plot_toxicity_intervals_stacked(object, ...)  # S3 method for class 'blrmfit' plot_toxicity_curve(   object,   newdata,   x,   group,   xlim,   ylim,   transform = TRUE,   prob = 0.5,   prob_outer = 0.95,   size = 0.75,   alpha = 1,   facet_args = list(),   hline_at = c(0.16, 0.33),   grid_length = 100,   ... )  # S3 method for class 'blrm_trial' plot_toxicity_curve(   object,   newdata,   x,   group,   xlim,   ylim,   transform = TRUE,   prob = 0.5,   prob_outer = 0.95,   size = 0.75,   alpha = 1,   facet_args = list(),   hline_at,   grid_length = 100,   ewoc_shading = TRUE,   ... )  # S3 method for class 'blrmfit' plot_toxicity_intervals(   object,   newdata,   x,   group,   interval_prob = c(0, 0.16, 0.33, 1),   interval_max_mass = c(NA, NA, 0.25),   ewoc_colors = c(\"green\", \"red\"),   facet_args = list(),   ... )  # S3 method for class 'blrm_trial' plot_toxicity_intervals(   object,   newdata,   x,   group,   interval_prob,   interval_max_mass,   ewoc_colors = c(\"green\", \"red\"),   ... )  # S3 method for class 'blrmfit' plot_toxicity_intervals_stacked(   object,   newdata,   x,   group,   xlim,   ylim = c(0, 0.5),   predictive = FALSE,   transform = !predictive,   interval_prob,   grid_length = 100,   facet_args = list(),   ... )  # S3 method for class 'blrm_trial' plot_toxicity_intervals_stacked(   object,   newdata,   x,   group,   xlim,   ylim = c(0, 0.5),   predictive = FALSE,   transform = !predictive,   interval_prob,   grid_length = 100,   ewoc_shading = TRUE,   facet_args = list(),   ... )"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/plot_blrm.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Plot a fitted model — plot_blrm","text":"object fitted model object ... currently unused newdata optional data frame specifying predict; missing, data input model object used. object blrmfit object, newdata defaults data argument. object blrm_trial, defaults summary(object, \"dose_info\"). x Character giving parameter name mapped x-axis.  also supports 'tidy' parameter selection specifying x = vars(...), ... specified way dplyr::select() similar functions. Examples using x way can found examples. blrm_trial methods, defaults first entry summary(blrm_trial,     \"drug_info\")$drug_name. group Grouping variable(s) whose levels mapped different facets plot. group can character vector, tidy parameter(s) form group = vars(...), formula passed directly ggplot2::facet_wrap(). blrm_trial methods, defaults group_id, plus entries summary(blrm_trial,     \"drug_info\")$drug_name except first, mapped x. xlim x-axis limits ylim y-axis limits probability scale transform logical (defaults FALSE) indicating linear predictor logit link scale transformed inv_logit 0-1 response scale. prob central probability mass report inner ribbon, .e. quantiles 0.5-prob/2 0.5+prob/2 displayed. prob_outer central probability mass report outer ribbon, .e. quantiles 0.5-prob/2 0.5+prob/2 displayed. alpha, size Arguments passed geoms. plot, alpha passed ggplot2::geom_ribbon(), size passed ggplot2::geom_line(). facet_args named list arguments (facets) passed ggplot2::facet_wrap(). hline_at Location(s) horizontal guide lines (passed bayesplot::hline_at()). grid_length Number grid points within xlim plotting. ewoc_shading logical indicates doses violating EWOC shaded gray. Applies blrm_trial methods. Defaults TRUE. interval_prob defines interval probabilities reported standard outputs. Defaults c(0, 0.16, 0.33, 1), predictive = FALSE /transform = TRUE, intervals giving 0, 1, 2+ DLTs predictive = TRUE transform = FALSE. blrm_trial methods, taken summary(blrm_trial, \"interval_prob\") default. interval_max_mass vector defining interval interval_prob vector maximal admissible probability mass given dose level. Whenever posterior probability mass given interval exceeds threshold, Escalation Overdose Control (EWOC) criterion considered fulfilled. Dose levels fulfilling EWOC ineligible next cohort patients. default restricts overdose probability less 0.25. blrm_trial methods, taken summary(blrm_trial, \"interval_max_mass\") default. ewoc_colors Fill colors used bars indicating EWOC OK . Vector two characters, must correspond bayesplot::bayesplot-package() color schemes (see ?[bayesplot::color_scheme_get()][bayesplot::color_scheme_get]) predictive logical indicates posterior predictive summarized. Defaults FALSE.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/plot_blrm.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Plot a fitted model — plot_blrm","text":"ggplot object can customized using ggplot2::ggplot2() package.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/plot_blrm.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Plot a fitted model — plot_blrm","text":"plot_toxicity_curve plots continuous profiles dose-toxicity curve. plot_toxicity_intervals plots posterior probability mass subintervals \\([0,1]\\), discrete set provisional doses. plot_toxicity_intervals_stacked similar plot_toxicity_intervals, continuous range doses.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/plot_blrm.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Plot a fitted model — plot_blrm","text":"","code":"## Setting up dummy sampling for fast execution of example ## Please use 4 chains and 100x more warmup & iter in practice .user_mc_options <- options(   OncoBayes2.MC.warmup = 10, OncoBayes2.MC.iter = 20, OncoBayes2.MC.chains = 1,   OncoBayes2.MC.save_warmup = FALSE )   example_model(\"combo2\", silent = TRUE) #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess  # Plot the dose-toxicity curve plot_toxicity_curve(blrmfit,   x = \"drug_A\",   group = ~ group_id * drug_B,   newdata = subset(dose_info_combo2, group_id == \"trial_AB\"),   facet_args = list(ncol = 4) ) #> Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0. #> ℹ Please use `linewidth` instead. #> ℹ The deprecated feature was likely used in the OncoBayes2 package. #>   Please report the issue at <https://github.com/Novartis/OncoBayes2/issues>.   # Plot posterior DLT-rate-interval probabilities at discrete dose levels plot_toxicity_intervals(blrmfit,   x = \"drug_A\",   group = ~ group_id * drug_B,   newdata = subset(dose_info_combo2, group_id == \"trial_AB\") )   # Plot posterior DLT-rate-interval probabilities over continuous dose plot_toxicity_intervals_stacked(blrmfit,   x = \"drug_A\",   group = ~ group_id * drug_B,   newdata = subset(dose_info_combo2, group_id == \"trial_AB\") )   # Plot predictive distribution probabilities over continuous dose plot_toxicity_intervals_stacked(blrmfit,   x = \"drug_A\",   group = ~ group_id * drug_B,   predictive = TRUE,   interval_prob = c(-1, 0, 1, 6),   newdata = transform(     subset(       dose_info_combo2,       group_id == \"trial_AB\"     ),     num_patients = 6,     num_toxicities = 0   ) )  ## Recover user set sampling defaults options(.user_mc_options)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/posterior_interval.blrmfit.html","id":null,"dir":"Reference","previous_headings":"","what":"Posterior intervals — posterior_interval.blrmfit","title":"Posterior intervals — posterior_interval.blrmfit","text":"Posterior intervals model parameters.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/posterior_interval.blrmfit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Posterior intervals — posterior_interval.blrmfit","text":"","code":"# S3 method for class 'blrmfit' posterior_interval(object, prob = 0.95, ...)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/posterior_interval.blrmfit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Posterior intervals — posterior_interval.blrmfit","text":"object fitted model object prob central probability mass report, .e. quantiles 0.5-prob/2 0.5+prob/2 displayed. Multiple central widths can specified. ... used function","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/posterior_interval.blrmfit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Posterior intervals — posterior_interval.blrmfit","text":"Matrix two columns central probability interval prob parameters model.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/posterior_interval.blrmfit.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Posterior intervals — posterior_interval.blrmfit","text":"Reports quantiles posterior parameters correspond central probability mass specified. output includes posterior hyper-parameters posterior group estimate.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/posterior_interval.blrmfit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Posterior intervals — posterior_interval.blrmfit","text":"","code":"## Setting up dummy sampling for fast execution of example ## Please use 4 chains and 100x more warmup & iter in practice .user_mc_options <- options(   OncoBayes2.MC.warmup = 10, OncoBayes2.MC.iter = 20, OncoBayes2.MC.chains = 1,   OncoBayes2.MC.save_warmup = FALSE )  example_model(\"single_agent\", silent = TRUE) #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess  posterior_interval(blrmfit) #>                                                      2.5%     97.5% #> mu_log_beta[log(drug_A/dref),intercept]        -0.8640091 3.8839930 #> mu_log_beta[log(drug_A/dref),log_slope]        -0.4132765 1.5579169 #> tau_log_beta[1,log(drug_A/dref),intercept]      0.0000000 0.0000000 #> tau_log_beta[1,log(drug_A/dref),log_slope]      0.0000000 0.0000000 #> rho_log_beta[log(drug_A/dref)]                 -0.8234919 0.8211436 #> beta_group[trial_A,log(drug_A/dref),intercept] -0.8640091 3.8839930 #> beta_group[trial_A,log(drug_A/dref),slope]      0.7324769 4.7797538  ## Recover user set sampling defaults options(.user_mc_options)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/posterior_linpred.blrmfit.html","id":null,"dir":"Reference","previous_headings":"","what":"Posterior of linear predictor — posterior_linpred.blrmfit","title":"Posterior of linear predictor — posterior_linpred.blrmfit","text":"Calculates posterior linear predictor.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/posterior_linpred.blrmfit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Posterior of linear predictor — posterior_linpred.blrmfit","text":"","code":"# S3 method for class 'blrmfit' posterior_linpred(object, transform = FALSE, newdata, draws, ...)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/posterior_linpred.blrmfit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Posterior of linear predictor — posterior_linpred.blrmfit","text":"object fitted model object transform logical (defaults FALSE) indicating linear predictor logit link scale transformed inv_logit 0-1 response scale. newdata optional data frame specifying predict; missing, data input model object used draws number returned posterior draws; default entire posterior returned ... used function","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/posterior_linpred.blrmfit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Posterior of linear predictor — posterior_linpred.blrmfit","text":"Matrix dimensions draws nrow(newdata) row correspond draw posterior column corresponds row newdata. columns labelled row.names newdata.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/posterior_linpred.blrmfit.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Posterior of linear predictor — posterior_linpred.blrmfit","text":"Simulates posterior linear predictor model object specified data set.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/posterior_linpred.blrmfit.html","id":"group-and-strata-definitions","dir":"Reference","previous_headings":"","what":"Group and strata definitions","title":"Posterior of linear predictor — posterior_linpred.blrmfit","text":"groups strata defined running blrm_exnex analysis changed later stage. result evaluations can performed groups present data set used running analysis. However, admissible code group (/stratum) column factor contains empty levels. groups thus contained fitting data set assigned default first stratum. addition priors must setup groups (/strata). empty group (/strata) levels allowed subsequent evaluations. enables evaluation hierarchical model terms representing prior future groups.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/posterior_linpred.blrmfit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Posterior of linear predictor — posterior_linpred.blrmfit","text":"","code":"## Setting up dummy sampling for fast execution of example ## Please use 4 chains and 100x more warmup & iter in practice .user_mc_options <- options(   OncoBayes2.MC.warmup = 10, OncoBayes2.MC.iter = 20, OncoBayes2.MC.chains = 1,   OncoBayes2.MC.save_warmup = FALSE )   ## run single-agent analysis which defines blrmfit model object example_model(\"single_agent\", silent = TRUE) #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess  ## obtain posterior of linear prediction on 0-1 scale post_prob_dlt <- posterior_linpred(blrmfit, TRUE, newdata = hist_SA) ## name columns to obtain nice bayesplot labels colnames(post_prob_dlt) <- hist_SA$drug_A  library(bayesplot) #> This is bayesplot version 1.14.0 #> - Online documentation and vignettes at mc-stan.org/bayesplot #> - bayesplot theme set to bayesplot::theme_default() #>    * Does _not_ affect other ggplot2 plots #>    * See ?bayesplot_theme_set for details on theme setting library(ggplot2) mcmc_intervals(post_prob_dlt, prob = 0.5, prob_outer = 0.95) +   coord_flip() +   vline_at(c(0.16, 0.33), linetype = 2) +   ylab(\"Dose [mg]\") +   ggtitle(\"Posterior Probability of a DLT\") +   scale_x_continuous(breaks = c(0.1, 0.16, 0.33, 0.5, 0.75)) #> Scale for x is already present. #> Adding another scale for x, which will replace the existing scale.   ## Recover user set sampling defaults options(.user_mc_options)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/posterior_predict.blrmfit.html","id":null,"dir":"Reference","previous_headings":"","what":"Posterior of predictive — posterior_predict.blrmfit","title":"Posterior of predictive — posterior_predict.blrmfit","text":"Simulation predictive distribution.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/posterior_predict.blrmfit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Posterior of predictive — posterior_predict.blrmfit","text":"","code":"# S3 method for class 'blrmfit' posterior_predict(object, newdata, draws, ...)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/posterior_predict.blrmfit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Posterior of predictive — posterior_predict.blrmfit","text":"object fitted model object newdata optional data frame specifying predict; missing, data input model object used draws number returned posterior draws; default entire posterior returned ... used function","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/posterior_predict.blrmfit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Posterior of predictive — posterior_predict.blrmfit","text":"Matrix dimensions draws nrow(newdata) row correspond draw posterior column corresponds row newdata. columns labelled row.names newdata.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/posterior_predict.blrmfit.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Posterior of predictive — posterior_predict.blrmfit","text":"Simulates posterior predictive model object specified data set.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/posterior_predict.blrmfit.html","id":"group-and-strata-definitions","dir":"Reference","previous_headings":"","what":"Group and strata definitions","title":"Posterior of predictive — posterior_predict.blrmfit","text":"groups strata defined running blrm_exnex analysis changed later stage. result evaluations can performed groups present data set used running analysis. However, admissible code group (/stratum) column factor contains empty levels. groups thus contained fitting data set assigned default first stratum. addition priors must setup groups (/strata). empty group (/strata) levels allowed subsequent evaluations. enables evaluation hierarchical model terms representing prior future groups.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/posterior_predict.blrmfit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Posterior of predictive — posterior_predict.blrmfit","text":"","code":"## Setting up dummy sampling for fast execution of example ## Please use 4 chains and 100x more warmup & iter in practice .user_mc_options <- options(   OncoBayes2.MC.warmup = 10, OncoBayes2.MC.iter = 20, OncoBayes2.MC.chains = 1,   OncoBayes2.MC.save_warmup = FALSE )   example_model(\"single_agent\", silent = TRUE) #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess  post_pred <- posterior_predict(blrmfit) ## turn DLT counts into DLT rates post_pred_rate <- sweep(post_pred, 2, hist_SA$num_patients, \"/\")  library(bayesplot) library(ggplot2)  ## compare posterior predictive of the model for the response rates ## with observed data with(   hist_SA,   ppc_intervals(num_toxicities / num_patients, post_pred_rate, x = drug_A, prob_outer = 0.95) ) +   xlab(\"Dose [mg]\")   ## Recover user set sampling defaults options(.user_mc_options)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/pp_data.html","id":null,"dir":"Reference","previous_headings":"","what":"Internal function to simulate from the posterior new parameter draws — pp_data","title":"Internal function to simulate from the posterior new parameter draws — pp_data","text":"Internal function simulate posterior new parameter draws","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/pp_data.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Internal function to simulate from the posterior new parameter draws — pp_data","text":"","code":"pp_data(object, newdata, draws, re.form)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/predictive_interval.blrmfit.html","id":null,"dir":"Reference","previous_headings":"","what":"Posterior predictive intervals — predictive_interval.blrmfit","title":"Posterior predictive intervals — predictive_interval.blrmfit","text":"Posterior predictive intervals model.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/predictive_interval.blrmfit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Posterior predictive intervals — predictive_interval.blrmfit","text":"","code":"# S3 method for class 'blrmfit' predictive_interval(object, prob = 0.95, newdata, ...)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/predictive_interval.blrmfit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Posterior predictive intervals — predictive_interval.blrmfit","text":"object fitted model object prob central probability mass report, .e. quantiles 0.5-prob/2 0.5+prob/2 displayed. Multiple central widths can specified. newdata optional data frame specifying predict; missing, data input model object used ... used function","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/predictive_interval.blrmfit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Posterior predictive intervals — predictive_interval.blrmfit","text":"Matrix many rows input data set two columns contain lower upper quantile corresponding central probability mass prob number responses predictive distribution.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/predictive_interval.blrmfit.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Posterior predictive intervals — predictive_interval.blrmfit","text":"Reports row input data set predictive interval according fitted model.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/predictive_interval.blrmfit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Posterior predictive intervals — predictive_interval.blrmfit","text":"","code":"## Setting up dummy sampling for fast execution of example ## Please use 4 chains and 100x more warmup & iter in practice .user_mc_options <- options(   OncoBayes2.MC.warmup = 10, OncoBayes2.MC.iter = 20, OncoBayes2.MC.chains = 1,   OncoBayes2.MC.save_warmup = FALSE )  example_model(\"single_agent\", silent = TRUE) #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess  predictive_interval(blrmfit) #>   2.5% 97.5% #> 1    0     1 #> 2    0     1 #> 3    0     2 #> 4    0     2 #> 5    0     2  ## Recover user set sampling defaults options(.user_mc_options)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/prior_summary.blrmfit.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarise model prior — prior_summary.blrmfit","title":"Summarise model prior — prior_summary.blrmfit","text":"Extracts summary prior structured data format.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/prior_summary.blrmfit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarise model prior — prior_summary.blrmfit","text":"","code":"# S3 method for class 'blrmfit' prior_summary(object, digits = 2, ...)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/prior_summary.blrmfit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarise model prior — prior_summary.blrmfit","text":"object blrmfit (blrm_trial) object returned blrm_exnex() (blrm_trial()) analysis digits number digits show ... ignored function","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/prior_summary.blrmfit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarise model prior — prior_summary.blrmfit","text":"Returns analysis specific list, print function. returned list contains arrays represent prior structured format.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/prior_summary.blrmfit.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Summarise model prior — prior_summary.blrmfit","text":"summary prior creates structured representation specified prior blrm_exnex() (blrm_trial()) analysis.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/prior_summary.blrmfit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarise model prior — prior_summary.blrmfit","text":"","code":"## Setting up dummy sampling for fast execution of example ## Please use 4 chains and 100x more warmup & iter in practice .user_mc_options <- options(   OncoBayes2.MC.warmup = 10, OncoBayes2.MC.iter = 20, OncoBayes2.MC.chains = 1,   OncoBayes2.MC.save_warmup = FALSE )  ## run combo2 analysis which defines blrmfit model object example_model(\"combo2\", silent = TRUE) #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess  prior_summary(blrmfit) #> Bayesian Logistic Regression Model with EXchangeability-NonEXchangeability #>  #> Mixture configuration #> --------------------- #> EXNEX components : 0  #> component #> I(log(drug_A/dref[1])) I(log(drug_B/dref[2]))  #>                      0                      0  #>  #> EXNEX interactions: 0  #> interaction #> I(drug_A/dref[1] * drug_B/dref[2])  #>                                  0  #>  #> Prior probability for exchangeability per group #>           component #> group      I(log(drug_A/dref[1])) I(log(drug_B/dref[2])) #>   trial_A                       1                      1 #>   trial_B                       1                      1 #>   IIT                           1                      1 #>   trial_AB                      1                      1 #>  #>           interaction #> group      I(drug_A/dref[1] * drug_B/dref[2]) #>   trial_A                                   1 #>   trial_B                                   1 #>   IIT                                       1 #>   trial_AB                                  1 #>  #> EXchangable hyperparameter priors #> --------------------------------- #> Component parameters #> Mean mu_log_beta #>                               prior weight m_intercept m_log_slope s_intercept s_log_slope  rho #> component              mix                                                                      #> I(log(drug_A/dref[1])) comp_1          1.0        -1.4         0.0         2.0         1.0  0.0 #> I(log(drug_B/dref[2])) comp_1          1.0        -1.4         0.0         2.0         1.0  0.0 #>  #> Heterogeneity tau_log_beta (log-normal) #>                                         prior weight m_tau_intercept m_tau_log_slope s_tau_intercept s_tau_log_slope   rho #> stratum   component              mix                                                                                       #> stratum_1 I(log(drug_A/dref[1])) comp_1         1.00           -1.39           -2.08            0.71            0.71  0.00 #>           I(log(drug_B/dref[2])) comp_1         1.00           -1.39           -2.08            0.71            0.71  0.00 #>  #> Correlation LKJ #> component #> I(log(drug_A/dref[1])) I(log(drug_B/dref[2]))  #>                      1                      1  #>  #> Interaction parameters #> Mean mu_eta #>       prior   w m[1] s[1] #> mix                       #> comp1       1.0  0.0  1.1 #>  #> Heterogeneity tau_eta (log-normal) #>                 prior     w  m[1]  s[1] #> stratum   mix                           #> stratum_1 comp1        1.00 -2.08  0.71 #>  #> Correlation LKJ #> interaction  #>           1  #>  #> NonEXchangable priors #> --------------------- #> Component parameters #> Mean mu_log_beta #>                               prior weight m_intercept m_log_slope s_intercept s_log_slope  rho #> component              mix                                                                      #> I(log(drug_A/dref[1])) comp_1          1.0        -1.4         0.0         2.0         1.0  0.0 #> I(log(drug_B/dref[2])) comp_1          1.0        -1.4         0.0         2.0         1.0  0.0 #>  #> Interaction parameters #> Mean mu_eta #>       prior   w m[1] s[1] #> mix                       #> comp1       1.0  0.0  1.1  prior_sum <- prior_summary(blrmfit) names(prior_sum) #>  [1] \"has_inter\"         \"is_EXNEX_comp\"     \"EX_prob_comp\"      #>  [4] \"EX_mu_log_beta\"    \"NEX_mu_log_beta\"   \"EX_tau_log_beta\"   #>  [7] \"EX_corr_eta_comp\"  \"tau_dist\"          \"is_EXNEX_inter\"    #> [10] \"EX_prob_inter\"     \"EX_mu_eta\"         \"NEX_mu_eta\"        #> [13] \"EX_tau_eta\"        \"EX_corr_eta_inter\" \"num_strata\"        #> [16] \"num_groups\"         ## the entries of the prior list are labelled arrays dimnames(prior_sum$EX_mu_log_beta) #> $prior #> [1] \"weight\"      \"m_intercept\" \"m_log_slope\" \"s_intercept\" \"s_log_slope\" #> [6] \"rho\"         #>  #> $component #> [1] \"I(log(drug_A/dref[1]))\" \"I(log(drug_B/dref[2]))\" #>  #> $mix #> [1] \"comp_1\" #>   ## Recover user set sampling defaults options(.user_mc_options)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/summary.blrm_trial.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarise trial — summary.blrm_trial","title":"Summarise trial — summary.blrm_trial","text":"Provides model summaries blrm_trial() analyses.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/summary.blrm_trial.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarise trial — summary.blrm_trial","text":"","code":"# S3 method for class 'blrm_trial' summary(   object,   summarize = c(\"blrmfit\", \"blrm_exnex_call\", \"data\", \"drug_info\", \"dose_info\",     \"dose_prediction\", \"data_prediction\", \"newdata_prediction\", \"dimensionality\",     \"interval_prob\", \"interval_max_mass\", \"ewoc_check\"),   ... )"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/summary.blrm_trial.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarise trial — summary.blrm_trial","text":"object blrm_trial() object summarize one following options: blrmfit summary underlying blrmfit object arguments ... blrm_exnex_call blrm_exnex call used create blrmfit object drug_info drug_info trial, contains drugs, reference doses units dose_info dose_info defined dose_prediction prediction defined dose_info data data observed data_prediction prediction observed data newdata_prediction prediction data provided newdata argument dimensionality numeric vector entries \"num_components\", \"num_interaction_terms\", \"num_groups\", \"num_strata\" interval_prob interval probabilities reported standard outputs interval_max_mass named vector defining interval interval_prob vector maxmimal admissable probability mass given dose level ewoc_check MCMC diagnostic precision estimates ewoc defining metrics defined doses dose_info (default) doses provided newdata argument. Please refer details reported diagnostics. ... arguments summary.blrmfit()","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/summary.blrm_trial.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Summarise trial — summary.blrm_trial","text":"ewoc_check summary routine allows assess accuracy reliability ewoc criterion respect MCMC sampling noise. returned summary provides detailled MCMC convergence precision estimates criteria defined interval_prob interval_max_mass contribute EWOC metric. , interval probability maximal mass less unity routine return columns: est MCMC estimate defining critical value. intervals defined tail probability corresponds respective critical quantile interval probabilites equal interval probability. stat centered standardized test quantity. estimate centered critical value scaled Monte-Carlo standard error (MCSE) estimate. Hence, negative (positive) values correspond constraint () fulfilled. standardization MCSE allows compare values standard normal quantiles accordingly. mcse Monte-Carlo standard error estimate determined posterior::mcse_quantile() (tail probability) posterior::mcse_mean() (interval probability) functions. ess Monte-Carlo effective sample size estimate determined posterior::ess_quantile() (tail probability) posterior::ess_mean() (interval probability) functions. rhat Monte-Carlo non-convergence diagnostic Rhat determined [rhat][posterior::rhat] function. common case requiring 33% DLT probability exceeded 25% posterior probability mass, estimate column est contains 75% quantile \\(q_{75\\%}\\) standardized statistic stat defined : $$\\text{stat} = \\frac{q_{75\\%} - 33\\%}{\\text{mcse}_{q_{75\\%}}}$$ statistic approximately distributed standard normal variate. ewoc_check summary can used ensure MCMC estimation accuracy sufficient.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/summary.blrm_trial.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarise trial — summary.blrm_trial","text":"","code":"## Setting up dummy sampling for fast execution of example ## Please use 4 chains and 100x more warmup & iter in practice .user_mc_options <- options(   OncoBayes2.MC.warmup = 10, OncoBayes2.MC.iter = 20, OncoBayes2.MC.chains = 1,   OncoBayes2.MC.save_warmup = FALSE )  # construct initial blrm_trial object from built-in example datasets combo2_trial_setup <- blrm_trial(   data = hist_combo2,   dose_info = dose_info_combo2,   drug_info = drug_info_combo2,   simplified_prior = TRUE ) #> No stratum defined - assigning all groups to single stratum \"all\" #> Warning: Simplified prior CAN and WILL change with releases. NOT recommended to use in production. Instantiating a simplified prior - run summary(trial, \"blrm_exnex_call\") to inspect arguments.  #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess #> Warning: 12 out of 42 ewoc metrics have not converged (some Rhats are > 1.1). #> Be careful when analysing the results! It is recommended to run #> more iterations and/or setting stronger priors. #> You may call \"summary(trial, summarize='ewoc_check', ...)\" for more diagnostic details. #> Please call \"help('blrm_trial', help_type='summary')\" for further documentation. #> Warning: 32 out of 42 ewoc metrics are within the 95% MCMC error of the decision boundary. #> Be careful when using the imprecise ewoc estimates! It is recommended to run #> more iterations and review doses close to critical thresholds. #> You may call \"summary(trial, summarize='ewoc_check', ...)\" for more diagnostic details. #> Please call \"help('blrm_trial', help_type='summary')\" for further documentation.  # extract blrm_call to see setup of the prior as passed to blrm_exnex summary(combo2_trial_setup, \"blrm_exnex_call\") #> blrm_exnex(formula = cbind(num_toxicities, num_patients - num_toxicities) ~  #>     1 + I(log(drug_A/6)) | 1 + I(log(drug_B/1500)) | 0 + I(2 *  #>         (drug_A/6 * drug_B/1500)/(1 + drug_A/6 * drug_B/1500)) |  #>         stratum_id/group_id, data = data, prior_EX_mu_comp = list(mixmvnorm(c(1,  #>     logit(0.2), 0, diag(c(2, 0.7)^2))), mixmvnorm(c(1, logit(0.2),  #>     0, diag(c(2, 0.7)^2)))), prior_EX_tau_comp = replicate(2L,  #>     mixmvnorm(c(1, log(0.25), log(0.125), diag((c(4, 2)/1.96)^2))),  #>     FALSE), prior_EX_mu_inter = mixmvnorm(c(1, 0, diag(1.5^2,  #>     1, 1))), prior_EX_tau_inter = mixmvnorm(c(1, c(log(0.5)),  #>     diag(c(log(2)/1.96)^2, 1, 1))), prior_is_EXNEX_inter = FALSE,  #>     prior_is_EXNEX_comp = c(FALSE, FALSE), prior_EX_prob_comp = c(1,  #>     1, 1, 1, 1, 1, 1, 1), prior_EX_prob_inter = c(1, 1, 1, 1),  #>     prior_tau_dist = 1)  # extract ewoc precision accuracy ec <- summary(combo2_trial_setup, \"ewoc_check\") #> Warning: 12 out of 42 ewoc metrics have not converged (some Rhats are > 1.1). #> Be careful when analysing the results! It is recommended to run #> more iterations and/or setting stronger priors. #> You may call \"summary(trial, summarize='ewoc_check', ...)\" for more diagnostic details. #> Please call \"help('blrm_trial', help_type='summary')\" for further documentation. #> Warning: 32 out of 42 ewoc metrics are within the 95% MCMC error of the decision boundary. #> Be careful when using the imprecise ewoc estimates! It is recommended to run #> more iterations and review doses close to critical thresholds. #> You may call \"summary(trial, summarize='ewoc_check', ...)\" for more diagnostic details. #> Please call \"help('blrm_trial', help_type='summary')\" for further documentation.  # find any ewoc metrics which are within 95% MCMC error of the threshold # these are counted as \"imprecise\" when printing blrm_trial objects subset(ec, abs(prob_overdose_stat) < qnorm(0.975)) #> # A tibble: 32 × 10 #>    group_id drug_A drug_B dose_id stratum_id prob_overdose_est #>    <fct>     <dbl>  <dbl>   <int> <fct>                  <dbl> #>  1 trial_A     6        0       3 all                    0.272 #>  2 trial_A     8        0       4 all                    0.381 #>  3 IIT         3        0       8 all                    0.133 #>  4 IIT         3      400       9 all                    0.201 #>  5 IIT         3      600      10 all                    0.248 #>  6 IIT         3      800      11 all                    0.311 #>  7 IIT         4.5      0      12 all                    0.173 #>  8 IIT         4.5    400      13 all                    0.256 #>  9 IIT         4.5    600      14 all                    0.310 #> 10 IIT         4.5    800      15 all                    0.366 #> # ℹ 22 more rows #> # ℹ 4 more variables: prob_overdose_stat <dbl>, prob_overdose_mcse <dbl>, #> #   prob_overdose_ess <dbl>, prob_overdose_rhat <dbl>  # ensure that the ewoc metric only flags \"ok\" whenever the MCMC error # is with 95% below the threshold ewoc_ok <- ec$prob_overdose_stat < qnorm(0.025)  ## Recover user set sampling defaults options(.user_mc_options)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/summary.blrmfit.html","id":null,"dir":"Reference","previous_headings":"","what":"Summarise model results — summary.blrmfit","title":"Summarise model results — summary.blrmfit","text":"Provides model summaries blrm_exnex() blrm_trial() analyses.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/summary.blrmfit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Summarise model results — summary.blrmfit","text":"","code":"# S3 method for class 'blrmfit' summary(   object,   newdata,   transform = !predictive,   prob = 0.95,   interval_prob,   predictive = FALSE,   ... )"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/summary.blrmfit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Summarise model results — summary.blrmfit","text":"object fitted model object newdata optional data frame specifying predict; missing, data input model object used transform logical (defaults FALSE) indicating linear predictor logit link scale transformed inv_logit 0-1 response scale. prob central probability mass report, .e. quantiles 0.5-prob/2 0.5+prob/2 displayed. Multiple central widths can specified. interval_prob optional vector sorted quantiles interval probabilities calculated predictive logical indicates posterior predictive summarized. Defaults FALSE. ... used function","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/summary.blrmfit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Summarise model results — summary.blrmfit","text":"Returns data.frame key summaries posterior mean, standard deviation, central probability interval, median optional interval probabilities. row data.frame corresponds respective input data default data set used blrm_exnex() analysis data specified newdata argument.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/summary.blrmfit.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Summarise model results — summary.blrmfit","text":"calculated posterior summaries returned data.frame contain optional interval probabilites specified vector sorted quantiles. summaries calculated response scale default can obtained link scale setting transform=FALSE. results requested predictive distribution predictive=TRUE, link scale refers total counts transformed scale divides (predictive) counts number trials results 0-1 scale.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/summary.blrmfit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Summarise model results — summary.blrmfit","text":"","code":"## Setting up dummy sampling for fast execution of example ## Please use 4 chains and 100x more warmup & iter in practice .user_mc_options <- options(   OncoBayes2.MC.warmup = 10, OncoBayes2.MC.iter = 20, OncoBayes2.MC.chains = 1,   OncoBayes2.MC.save_warmup = FALSE )  example_model(\"single_agent\", silent = TRUE) #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess  ## obtain underdosing (0-0.16], target dosing (0.16-0.33] and ## overdosing (0.33-1] probabilities summary(blrmfit, interval_prob = c(0, 0.16, 0.33, 1)) #>          mean          sd         2.5%          50%      97.5% [0,0.16] #> 1 0.002175423 0.004455258 2.102056e-06 5.600326e-05 0.01109878      1.0 #> 2 0.008724355 0.016941761 7.153526e-05 7.739391e-04 0.04382645      1.0 #> 3 0.026667152 0.043294240 1.074384e-03 6.356063e-03 0.11731116      1.0 #> 4 0.100945832 0.099841064 1.588602e-02 5.984106e-02 0.27934022      0.7 #> 5 0.500049422 0.257584238 1.649624e-01 4.445401e-01 0.85698480      0.0 #>   (0.16,0.33] (0.33,1] #> 1         0.0      0.0 #> 2         0.0      0.0 #> 3         0.0      0.0 #> 4         0.3      0.0 #> 5         0.3      0.7  ## obtain predictive distribution for respective cohorts and ## calculate probability for no event, 1 event or >1 event ## note that this does the calculation for the cohort sizes ## as put into the data-set summary(blrmfit, interval_prob = c(-1, 0, 1, 10), predictive = TRUE) #>         mean         sd 2.5% 50% 97.5%    (-1,0]       (0,1]       (1,10] #> 1 0.00652627 0.08135883    0   0     0 0.9935413 0.006391417 6.730507e-05 #> 2 0.03489742 0.19414638    0   0     1 0.9670534 0.031050985 1.895623e-03 #> 3 0.13333576 0.40437497    0   0     1 0.8881358 0.092754269 1.910991e-02 #> 4 0.40378333 0.68606126    0   0     2 0.6942718 0.223424873 8.230338e-02 #> 5 1.00009884 0.78703834    0   1     2 0.3096653 0.380570644 3.097641e-01  ## to obtain the predictive for a cohort-size of 6 for all patients ## in the data-set one would need to use the newdata argument, e.g. summary(blrmfit,   newdata = transform(hist_SA, num_patients = 6),   interval_prob = c(-1, 0, 1, 10), predictive = TRUE ) #>         mean        sd 2.5% 50% 97.5%    (-1,0]      (0,1]       (1,10] #> 1 0.01305254 0.1164477    0   0     0 0.9872816 0.01238904 0.0003293602 #> 2 0.05234613 0.2442111    0   0     1 0.9523973 0.04312347 0.0044792015 #> 3 0.16000291 0.4542517    0   0     2 0.8710905 0.10227207 0.0266374558 #> 4 0.60567499 0.9020405    0   0     3 0.6070046 0.24112848 0.1518668865 #> 5 3.00029653 1.8142327    0   3     6 0.0889746 0.16092126 0.7501041392  ## Recover user set sampling defaults options(.user_mc_options)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/update.blrm_trial.html","id":null,"dir":"Reference","previous_headings":"","what":"Update data and/or prior of a BLRM trial — update.blrm_trial","title":"Update data and/or prior of a BLRM trial — update.blrm_trial","text":"Adds data rows blrm_trial() object (add_data argument) Replaces data blrm_trial() object (data argument) Sets prior blrm_trial() object (... argument passed blrm_exnex)","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/update.blrm_trial.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update data and/or prior of a BLRM trial — update.blrm_trial","text":"","code":"# S3 method for class 'blrm_trial' update(object, ...)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/update.blrm_trial.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Update data and/or prior of a BLRM trial — update.blrm_trial","text":"object blrm_trial object ... passed default update command blrm_exnex","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/update.blrm_trial.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Update data and/or prior of a BLRM trial — update.blrm_trial","text":"","code":"## Setting up dummy sampling for fast execution of example ## Please use 4 chains and 100x more warmup & iter in practice .user_mc_options <- options(   OncoBayes2.MC.warmup = 10, OncoBayes2.MC.iter = 20, OncoBayes2.MC.chains = 1,   OncoBayes2.MC.save_warmup = FALSE )   # the combo2_trial example demonstrates the use of add_data of # update.blrmfit example_model(\"combo2_trial\") #> Running combo2_trial example: #>  library(tibble) #>  library(dplyr) #>  library(tidyr) #>  #>  # Combo2 example using blrm_trial functionality #>  #>  # construct initial blrm_trial object from built-in example datasets #>  combo2_trial_setup <- blrm_trial( #>    data = hist_combo2, #>    dose_info = dose_info_combo2, #>    drug_info = drug_info_combo2, #>    simplified_prior = FALSE #>  ) #>   #>  # summary of dimensionality of data structures #>  dims <- summary(combo2_trial_setup, \"dimensionality\") #>  #>  # Fit the initial model with the historical data and fully specified prior #>  #>  #>  combo2_trial_start <- update( #>     combo2_trial_setup, #>     ## bivariate normal prior for drug A and drug B of intercept and #>     ## log-slope #>     prior_EX_mu_comp = #>       replicate(2, #>                 mixmvnorm(c(1, #>                             logit(0.2), 0, #>                             diag(c(2^2, 1)))) #>               , FALSE), #>     prior_EX_tau_comp = #>       replicate(2, #>                 mixmvnorm(c(1, #>                             log(0.25), log(0.125), #>                             diag(c(log(4)/1.96, log(4)/1.96)^2))) #>               , FALSE), #>     prior_EX_mu_inter = mixmvnorm(c(1, 0, 1.121^2)), #>     prior_EX_tau_inter = mixmvnorm(c(1, log(0.125), (log(4) / 1.96)^2)), #>     prior_is_EXNEX_comp = c(FALSE, FALSE), #>     prior_is_EXNEX_inter = FALSE, #>     prior_EX_prob_comp = matrix(1, #>       nrow = dims$num_groups, #>       ncol = 2 #>     ), #>     prior_EX_prob_inter = matrix(1, #>       nrow = nlevels(dose_info_combo2$group_id), #>       ncol = 1 #>     ), #>     prior_tau_dist = 1 #>   ) #>  #>  # print summary of prior specification #>  prior_summary(combo2_trial_start) #>  #>  # summarize inference at observed dose levels #>  summary(combo2_trial_start, \"data_prediction\") #>  #>  # summarize inference at specified dose levels #>  summary(combo2_trial_start, \"dose_prediction\") #>  #>  #>  # Update again with new data #>  #>  # using update() with data argument supplied #>  # dem <- update(combo2_trial_start, data = codata_combo2) #>  #>  # alternate way using update() with add_data argument for #>  # new observations only (those collected after the trial #>  # design stage). #>  new_data <- filter(codata_combo2, cohort_time > 0) #>  #>  combo2_trial <- update(combo2_trial_start, add_data = new_data) #>  #>  summary(combo2_trial, \"data\") # cohort_time is tracked #>  summary(combo2_trial, \"data_prediction\") #>  summary(combo2_trial, \"dose_prediction\") #>  #>  rm(dims, new_data) #>  #> No stratum defined - assigning all groups to single stratum \"all\" #> Please configure blrm_exnex using the update() function. #> Warning: There were 10 transitions after warmup that exceeded the maximum treedepth. Increase max_treedepth above 10. See #> https://mc-stan.org/misc/warnings.html#maximum-treedepth-exceeded #> Warning: Examine the pairs() plot to diagnose sampling problems #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess #> Warning: 11 out of 42 ewoc metrics have not converged (some Rhats are > 1.1). #> Be careful when analysing the results! It is recommended to run #> more iterations and/or setting stronger priors. #> You may call \"summary(trial, summarize='ewoc_check', ...)\" for more diagnostic details. #> Please call \"help('blrm_trial', help_type='summary')\" for further documentation. #> Warning: 22 out of 42 ewoc metrics are within the 95% MCMC error of the decision boundary. #> Be careful when using the imprecise ewoc estimates! It is recommended to run #> more iterations and review doses close to critical thresholds. #> You may call \"summary(trial, summarize='ewoc_check', ...)\" for more diagnostic details. #> Please call \"help('blrm_trial', help_type='summary')\" for further documentation. #> stratum_id not given, but only one stratum defined. Assigning first stratum. #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess #> Warning: 16 out of 42 ewoc metrics have not converged (some Rhats are > 1.1). #> Be careful when analysing the results! It is recommended to run #> more iterations and/or setting stronger priors. #> You may call \"summary(trial, summarize='ewoc_check', ...)\" for more diagnostic details. #> Please call \"help('blrm_trial', help_type='summary')\" for further documentation. #> Warning: 7 out of 42 ewoc metrics are within the 95% MCMC error of the decision boundary. #> Be careful when using the imprecise ewoc estimates! It is recommended to run #> more iterations and review doses close to critical thresholds. #> You may call \"summary(trial, summarize='ewoc_check', ...)\" for more diagnostic details. #> Please call \"help('blrm_trial', help_type='summary')\" for further documentation.  ## Recover user set sampling defaults options(.user_mc_options)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/update.blrmfit.html","id":null,"dir":"Reference","previous_headings":"","what":"Update data of a BLRM analysis — update.blrmfit","title":"Update data of a BLRM analysis — update.blrmfit","text":"Adds data rows blrm_exnex() blrm_trial() analysis object.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/update.blrmfit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Update data of a BLRM analysis — update.blrmfit","text":"","code":"# S3 method for class 'blrmfit' update(object, ..., add_data)"},{"path":"http://opensource.nibr.com/OncoBayes2/reference/update.blrmfit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Update data of a BLRM analysis — update.blrmfit","text":"object blrmfit analysis object ... passed default update command data add_data combined data object using bind_rows. indices groups stratums (defined) matched add_data data analysis object. Note add_data argument must named explicitly demonstrated example. add_data additional data added analysis data object","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/reference/update.blrmfit.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Update data of a BLRM analysis — update.blrmfit","text":"","code":"## Setting up dummy sampling for fast execution of example ## Please use 4 chains and 100x more warmup & iter in practice .user_mc_options <- options(   OncoBayes2.MC.warmup = 10, OncoBayes2.MC.iter = 20, OncoBayes2.MC.chains = 1,   OncoBayes2.MC.save_warmup = FALSE )  example_model(\"single_agent\", silent = TRUE) #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess  library(tibble) new_cohort <- tibble(group_id = \"trial_A\", drug_A = 50, num_patients = 4, num_toxicities = 1)  ## this would fail, since add_data argument must be named ## new_blrmfit <- update(blrmfit, new_cohort) new_blrmfit <- update(blrmfit, add_data = new_cohort) #> Warning: The largest R-hat is NA, indicating chains have not mixed. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#r-hat #> Warning: Bulk Effective Samples Size (ESS) is too low, indicating posterior means and medians may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#bulk-ess #> Warning: Tail Effective Samples Size (ESS) is too low, indicating posterior variances and tail quantiles may be unreliable. #> Running the chains for more iterations may help. See #> https://mc-stan.org/misc/warnings.html#tail-ess  ## Recover user set sampling defaults options(.user_mc_options)"},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-09-3---april-25th-2025","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.9-3 - April 25th, 2025","title":"OncoBayes2 0.9-3 - April 25th, 2025","text":"CRAN release: 2025-04-25","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"bug-fixes-0-9-3","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"OncoBayes2 0.9-3 - April 25th, 2025","text":"Fix issue using multiple strata new argument prior_tau_dist=NULL blrm_exnex. Fix issues draws extraction functions ignored inc_warmup argument.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-09-2---april-7th-2025","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.9-2 - April 7th, 2025","title":"OncoBayes2 0.9-2 - April 7th, 2025","text":"CRAN release: 2025-04-07","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"enhancements-0-9-2","dir":"Changelog","previous_headings":"","what":"Enhancements","title":"OncoBayes2 0.9-2 - April 7th, 2025","text":"Extend as_draws_* functions blrm_trial inputs.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"bug-fixes-0-9-2","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"OncoBayes2 0.9-2 - April 7th, 2025","text":"Ensure new option prior_tau_dist=NULL forwarded used via blrm_trial blrm_exnex. Make sure rvars exported arrays underyling parameter structured.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-09-1---march-17th-2025","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.9-1 - March 17th, 2025","title":"OncoBayes2 0.9-1 - March 17th, 2025","text":"CRAN release: 2025-03-17","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"enhancements-0-9-1","dir":"Changelog","previous_headings":"","what":"Enhancements","title":"OncoBayes2 0.9-1 - March 17th, 2025","text":"Adding new vignette derive MAP priors historical data. New sample_map argument blrm_exnex function allows sample MAP prior defined strata model. set TRUE posterior draws contain map_log_beta map_eta correspond respective MAP priors per stratum new trials. Allow argument prior_tau_dist blrm_exnex set NULL. disable hierarchical model structure entirely simplifies specifying models without hierarchical structure (data pooled across groups).","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"bug-fixes-0-9-1","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"OncoBayes2 0.9-1 - March 17th, 2025","text":"Fix issue whenever different number mixture components used prios drug components. Ensure extracted posterior samples draws objects labeled array dimensions. Small efficiency improvement Stan model.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-09-0---february-28th-2025","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.9-0 - February 28th, 2025","title":"OncoBayes2 0.9-0 - February 28th, 2025","text":"CRAN release: 2025-03-01","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"enhancements-0-9-0","dir":"Changelog","previous_headings":"","what":"Enhancements","title":"OncoBayes2 0.9-0 - February 28th, 2025","text":"Introduce mixture prior arguments blrm_exnex. replace existing arguments prior specification, now deprecated removed next main version increase package. Add experimental as_draws* functions allowing extract samples posterior draws format blrmfit objects. Improve error messages Stan fails sample.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"bug-fixes-0-9-0","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"OncoBayes2 0.9-0 - February 28th, 2025","text":"Added several plot improvements bug fixes. Fixed issue leading jagged curves plot_toxicity_intervals_stacked(), another leading wrongly ordered facets plot_toxicity_intervals(). Ensured consistent bayesplot themeing across plots. Fixed sampling model prior whenever EXNEX used. Simulation-based calibration performance increased roughly order magnitude. Fixed issues BLRMs without interaction term cmdstan 2.36.0 Results model runs cmdstanr backend now loaded using brms package instead rstan. fixes issues loading results cmdstan 2.36.0 intervals reported summary() function using interval_prob argument default now include lower end closed interval calls predictive = FALSE. default underdosing interval, includes probability exactly 0 now. Fixed issue relating incompatibility upcoming R 4.5.0 macOS using C23 rstan.","code":""},{"path":[]},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"enhancements-0-8-10","dir":"Changelog","previous_headings":"","what":"Enhancements","title":"OncoBayes2 0.8-10 - November 4th, 2024","text":"Updated Stan model file syntax use new array syntax required Stan >=2.33. upgrades minimal Stan version 2.26. Start compressing plots vignette slim file size.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-08-9---july-20th-2023","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.8-9 - July 20th, 2023","title":"OncoBayes2 0.8-9 - July 20th, 2023","text":"CRAN release: 2023-07-20","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"bug-fixes-0-8-9","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"OncoBayes2 0.8-9 - July 20th, 2023","text":"resolve compilation source issues platforms triggered changes rstantools","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-08-8---march-3rd-2023","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.8-8 - March 3rd, 2023","title":"OncoBayes2 0.8-8 - March 3rd, 2023","text":"CRAN release: 2023-03-03","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"enhancements-0-8-8","dir":"Changelog","previous_headings":"","what":"Enhancements","title":"OncoBayes2 0.8-8 - March 3rd, 2023","text":"upon package load OncoBayes2 now report date release respective git commit hash used create sources package.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"bug-fixes-0-8-8","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"OncoBayes2 0.8-8 - March 3rd, 2023","text":"ensure compatibility posterior 1.4.0 (posterior returns num() formatted columns, OncoBayes2 supporting) ensure C++17 compatiblity per CRAN (triggers issue clang 16)","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-08-7---august-24th-2022","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.8-7 - August 24th, 2022","title":"OncoBayes2 0.8-7 - August 24th, 2022","text":"CRAN release: 2022-08-25","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"enhancements-0-8-7","dir":"Changelog","previous_headings":"","what":"Enhancements","title":"OncoBayes2 0.8-7 - August 24th, 2022","text":"add warning messages printing blrmfit objects divergent transitions non-convergence parameters add diagnostic extraction functions nuts_params, rhat, log_posterior neff_ratio blrmfit objects defined bayesplot speedup pp_data 25% used posterior summary functions add ewoc_check summary routine blrm_trial objects. returned summary contains MCMC diagnostics accuracy estimates EWOC metric defined trial. allows assess MCMC estimation error EWOC. added warning imprecise estimates EWOC metric whenever blrm_trial objects printed.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"bug-fixes-0-8-7","dir":"Changelog","previous_headings":"","what":"Bug fixes","title":"OncoBayes2 0.8-7 - August 24th, 2022","text":"fix broken exclusion unnecessary random variables whenever save_warmup=FALSE.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-08-6---may-2nd-2022","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.8-6 - May 2nd, 2022","title":"OncoBayes2 0.8-6 - May 2nd, 2022","text":"CRAN release: 2022-05-02 allow cmdstanr new backend blrm_exnex. Stan model file written function cmdstanr::write_stan_file disk model binaries can cached user defines global option cmdstanr_write_stan_file_dir. See ?cmdstanr::write_stan_file (requires cmdstanr >= 0.5.0)","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-08-5---february-28th-2022","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.8-5 - February 28th, 2022","title":"OncoBayes2 0.8-5 - February 28th, 2022","text":"CRAN release: 2022-03-01 fix issue example_model exposing properly objects running silent=TRUE","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-08-4---february-18th-2022","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.8-4 - February 18th, 2022","title":"OncoBayes2 0.8-4 - February 18th, 2022","text":"CRAN release: 2022-02-18 Switch SBC runs use clustermq lieu batchtools. Also now use L’Ecuyer CMG rng engine SBC runs. add critical_quantile function allowing calculate critical doses fulfill conditions like EWOC.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-08-3---october-7th-2021","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.8-3 - October 7th, 2021","title":"OncoBayes2 0.8-3 - October 7th, 2021","text":"Make Stan model compile 2.27+ (lupmf postfix variables allowed)","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-08-2---september-13th-2021","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.8-2 - September 13th, 2021","title":"OncoBayes2 0.8-2 - September 13th, 2021","text":"CRAN release: 2021-09-14 Drop unneccessary random variables posterior whenever save_warmup=FALSE. decreases size posterior memory ~60% combo2 example.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-08-1---september-1st-2021","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.8-1 - September 1st, 2021","title":"OncoBayes2 0.8-1 - September 1st, 2021","text":"CRAN release: 2021-09-02 Address CRAN comments","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-08-0---august-31st-2021","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.8-0 - August 31st, 2021","title":"OncoBayes2 0.8-0 - August 31st, 2021","text":"Significantly speedup Stan model dropping normalization binomial default interaction model blrm_trial now saturating (blrm_formula_saturating) logit space, improving behavior combinations antagonistic toxicity. blrm_trial simplified prior now defaults ENXEX , prior parameter defaults updated. New save_warmup argument blrm_exnex can used disable saving warmup samples, defaults OncoBayes2.MC.save_warmup option, defaults TRUE line previous versions. NOTE: Starting next version 0.9.0 new default FALSE! crash summary(trial, “data_prediction”) blrm_trial NULL 0-row data Spurious warning dose_id NA blrm_trial instantiation removed Spurious warning dose prespecified summary(…, newdata=…) removed New plot function plot_toxicity_intervals_stacked(), visualizes model posterior predictive probabilities discrete intervals, continuous range doses Automated visual regression testing implemented using vdiffr package Fix plot_toxicity_curve avoid overplotting newdata contains columns grouping variables doses (e.g. dose_id) Avoid re-parsing model formula whenever newdata used respective functions. prevents changes global variables (like dref) effect whenever fitted data used.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-07-0---may-7th-2021","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.7-0 - May 7th, 2021","title":"OncoBayes2 0.7-0 - May 7th, 2021","text":"CRAN release: 2021-05-07 Catch data specification errors wrongly nested groups/strata BLRM trials now also print toxicity probability intervals EWOC setting blrm_formula_linear blrm_formula_saturating interaction model formula generators can now customized generate specific interactions using specific_interaction_terms argument. Add predictive summaries summary method. Switch predictive outputs based averaging sampling density. avoids need additional sampling predictive summaries. Add plotting methods blrmfit blrm_trial objects.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-06-5---may-7th-2020","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.6-5 - May 7th, 2020","title":"OncoBayes2 0.6-5 - May 7th, 2020","text":"CRAN release: 2020-05-07 Drop RBesT dependency Avoid setting ggplot2 theme upon package load Enhance SBC runs monitor report sampler diagnostics","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-06-4---april-7th-2020","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.6-4 - April 7th, 2020","title":"OncoBayes2 0.6-4 - April 7th, 2020","text":"CRAN release: 2020-04-07 Add Operation Qualification script (run-oq.R inst/extra) Add saturating interaction model (blrm_formula_saturating) associated tests","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-06-3---march-18th-2020","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.6-3 - March 18th, 2020","title":"OncoBayes2 0.6-3 - March 18th, 2020","text":"CRAN release: 2020-03-19 2nd attempt work around issues found clang sanitizer Stan model.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-06-2---march-9th-2020","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.6-2 - March 9th, 2020","title":"OncoBayes2 0.6-2 - March 9th, 2020","text":"Work around issues found clang sanitizer Stan model.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-06-1---march-4th-2020","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.6-1 - March 4th, 2020","title":"OncoBayes2 0.6-1 - March 4th, 2020","text":"Fix issue upcoming R 4.0 changes stringsAsFactors default FALSE Fix upcoming tibble 3.0 upgrade changes conventions growing factors within tibbles","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-06-0---february-11th-2020","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.6-0 - February 11th, 2020","title":"OncoBayes2 0.6-0 - February 11th, 2020","text":"CRAN release: 2020-02-11 Fix issue model outputs EXNEX used. recommend users upgrade version. SBC runs now include checks per-group estimates avoid regression bug. Correct printing prior information wrt. summaries number strata groups.","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-05-8---december-12th-2019","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.5-8 - December 12th, 2019","title":"OncoBayes2 0.5-8 - December 12th, 2019","text":"CRAN release: 2019-12-12 Merge data group dosing blrm_trial passing blrm_exnex improved performance Ensure consistent sorting data improve reproducibility output respect input data permutations speedup Stan model now skips data rows cases correct blrm_exnex documentation reflect correctly exchangability model used interaction model","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-05-7---december-9th-2019","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.5-7 - December 9th, 2019","title":"OncoBayes2 0.5-7 - December 9th, 2019","text":"Improve numerical stability log_inv_logit function, preventing NaNs output pp_data resulting errors summary()","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-05-6---november-29th-2019","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.5-6 - November 29th, 2019","title":"OncoBayes2 0.5-6 - November 29th, 2019","text":"Support summary.blrm_trial(…) syntax passing summary.blrmfit()","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-05-5---november-22nd-2019","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.5-5 - November 22nd, 2019","title":"OncoBayes2 0.5-5 - November 22nd, 2019","text":"Fixed Roxygen posterior_predict","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-05-4---november-18th-2019","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.5-4 - November 18th, 2019","title":"OncoBayes2 0.5-4 - November 18th, 2019","text":"CRAN release: 2019-11-19 fix vignette documentation correct blrm trial co-data example fix test issues per CRAN checks macosx-old-r run","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-05-3---november-15th-2019","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.5-3 - November 15th, 2019","title":"OncoBayes2 0.5-3 - November 15th, 2019","text":"CRAN release: 2019-11-15 new blrm_trial function facilitates dose-escalation trial conduct combining key trial design features new add_data argument update function adds data existing model objects class blrmfit blrm_trial various smaller bug fixes","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-04-4---august-28th-2019","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.4-4 - August 28th, 2019","title":"OncoBayes2 0.4-4 - August 28th, 2019","text":"CRAN release: 2019-08-29 run examples example code (remove dontrun sections)","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-04-3---august-27th-2019","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.4-3 - August 27th, 2019","title":"OncoBayes2 0.4-3 - August 27th, 2019","text":"use message instead cat functions using printing except summary print suppress default messages Stan, can enable verbose=TRUE make examples run short sampling","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-04-2---august-27th-2019","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.4-2 - August 27th, 2019","title":"OncoBayes2 0.4-2 - August 27th, 2019","text":"Correct loading exporting methods Add tidybayes example continuous use visutalization model Allow multiple central probability widths prob argument summary method","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-03-0---july-31st-2019","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.3-0 - July 31st, 2019","title":"OncoBayes2 0.3-0 - July 31st, 2019","text":"Correct external package loading examples","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-02-0---july-27th-2019","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.2-0 - July 27th, 2019","title":"OncoBayes2 0.2-0 - July 27th, 2019","text":"Added function prior_summary Restructured print output Added examples single-agent, combo2 combo3 along example data sets lot documentation reference pages New vignette standard use case blrm_exnex Oncology Qualified blrm_exnex model Simulation Based Calibration","code":""},{"path":"http://opensource.nibr.com/OncoBayes2/news/index.html","id":"oncobayes2-01-0---may-15th-2018","dir":"Changelog","previous_headings":"","what":"OncoBayes2 0.1-0 - May 15th, 2018","title":"OncoBayes2 0.1-0 - May 15th, 2018","text":"Initial release","code":""}]
